(() => {
let $1aae169a1a51f082$export$3d7865934588d77e;
(function(EventType) {
    EventType["CLICK"] = "click";
    EventType["CHANGE"] = "change";
    EventType["DBLCLICK"] = "dblclick";
    EventType["KEYDOWN"] = "keydown";
    EventType["SUBMIT"] = "submit";
    EventType["CONTEXTMENU"] = "contextmenu";
    EventType["DRAGSTART"] = "dragstart";
    EventType["DROP"] = "drop";
})($1aae169a1a51f082$export$3d7865934588d77e || ($1aae169a1a51f082$export$3d7865934588d77e = {}));
let $1aae169a1a51f082$export$75972070afd93869;
(function(KeydownType) {
    KeydownType["ESCAPE"] = "Escape";
    KeydownType["F1"] = "F1";
    KeydownType["F2"] = "F2";
    KeydownType["F3"] = "F3";
    KeydownType["F7"] = "F7";
    KeydownType["TAB"] = "Tab";
})($1aae169a1a51f082$export$75972070afd93869 || ($1aae169a1a51f082$export$75972070afd93869 = {}));
let $1aae169a1a51f082$export$19ad8633adf38a6d;
(function(ControlAction) {
    ControlAction[ControlAction["START"] = 0] = "START";
    ControlAction[ControlAction["STOP"] = 1] = "STOP";
    ControlAction[ControlAction["RESET"] = 2] = "RESET";
    ControlAction[ControlAction["DELETE"] = 3] = "DELETE";
    ControlAction[ControlAction["MOVE"] = 4] = "MOVE";
    ControlAction[ControlAction["PUSH"] = 5] = "PUSH";
    ControlAction[ControlAction["EDIT"] = 6] = "EDIT";
    ControlAction[ControlAction["LOAD"] = 7] = "LOAD";
})($1aae169a1a51f082$export$19ad8633adf38a6d || ($1aae169a1a51f082$export$19ad8633adf38a6d = {}));
let $1aae169a1a51f082$export$a82430915e8eaf8e;
(function(RecState) {
    RecState[RecState["ON"] = 0] = "ON";
    RecState[RecState["OFF"] = 1] = "OFF";
    RecState[RecState["PAUSED"] = 2] = "PAUSED";
})($1aae169a1a51f082$export$a82430915e8eaf8e || ($1aae169a1a51f082$export$a82430915e8eaf8e = {}));


class $a47815ae80a06a17$export$2e2bcd8739ae039 {
    constructor(options){
        var _a, _b, _c, _d, _e, _f, _g, _h, _j;
        this.overlay = document.createElement("div");
        this.overlay.className = options.className || "_ext-element-overlay";
        this.overlay.style.background = ((_a = options.style) === null || _a === void 0 ? void 0 : _a.background) || "rgba(250, 240, 202, 0.2)";
        this.overlay.style.borderColor = ((_b = options.style) === null || _b === void 0 ? void 0 : _b.borderColor) || "#F95738";
        this.overlay.style.borderStyle = ((_c = options.style) === null || _c === void 0 ? void 0 : _c.borderStyle) || "solid";
        this.overlay.style.borderRadius = ((_d = options.style) === null || _d === void 0 ? void 0 : _d.borderRadius) || "1px";
        this.overlay.style.borderWidth = ((_e = options.style) === null || _e === void 0 ? void 0 : _e.borderWidth) || "1px";
        this.overlay.style.boxSizing = ((_f = options.style) === null || _f === void 0 ? void 0 : _f.boxSizing) || "border-box";
        this.overlay.style.cursor = ((_g = options.style) === null || _g === void 0 ? void 0 : _g.cursor) || "crosshair";
        this.overlay.style.position = ((_h = options.style) === null || _h === void 0 ? void 0 : _h.position) || "absolute";
        this.overlay.style.zIndex = ((_j = options.style) === null || _j === void 0 ? void 0 : _j.zIndex) || "2147483647";
        this.shadowContainer = document.createElement("div");
        this.shadowContainer.className = "_ext-element-overlay-container";
        this.shadowContainer.style.position = "absolute";
        this.shadowContainer.style.top = "0px";
        this.shadowContainer.style.left = "0px";
        this.shadowRoot = this.shadowContainer.attachShadow({
            mode: "open"
        });
    }
    addToDOM(parent, useShadowDOM) {
        this.usingShadowDOM = useShadowDOM;
        if (useShadowDOM) {
            parent.insertBefore(this.shadowContainer, parent.firstChild);
            this.shadowRoot.appendChild(this.overlay);
        } else parent.appendChild(this.overlay);
    }
    removeFromDOM() {
        this.setBounds({
            x: 0,
            y: 0,
            width: 0,
            height: 0
        });
        this.overlay.remove();
        if (this.usingShadowDOM) this.shadowContainer.remove();
    }
    captureCursor() {
        this.overlay.style.pointerEvents = "auto";
    }
    ignoreCursor() {
        this.overlay.style.pointerEvents = "none";
    }
    setBounds({ x: x , y: y , width: width , height: height  }) {
        this.overlay.style.left = x + "px";
        this.overlay.style.top = y + "px";
        this.overlay.style.width = width + "px";
        this.overlay.style.height = height + "px";
    }
}


const $0d2e1d696ad9a5e9$export$abe5643cba19555f = (el)=>{
    const rect = el.getBoundingClientRect();
    return {
        x: window.pageXOffset + rect.left,
        y: window.pageYOffset + rect.top,
        width: el.offsetWidth,
        height: el.offsetHeight
    };
};


class $7c5d4ec7fb1c475d$export$2e2bcd8739ae039 {
    constructor(overlayOptions){
        this.handleMouseMove = (event)=>{
            this.mouseX = event.clientX;
            this.mouseY = event.clientY;
        };
        this.handleClick = (event)=>{
            var _a;
            if (this.target && ((_a = this.options) === null || _a === void 0 ? void 0 : _a.onClick)) this.options.onClick(this.target);
            event.preventDefault();
        };
        this.tick = ()=>{
            this.updateTarget();
            this.tickReq = window.requestAnimationFrame(this.tick);
        };
        this.active = false;
        this.overlay = new (0, $a47815ae80a06a17$export$2e2bcd8739ae039)(overlayOptions !== null && overlayOptions !== void 0 ? overlayOptions : {});
    }
    start(options) {
        var _a, _b;
        if (this.active) return false;
        this.active = true;
        this.options = options;
        document.addEventListener("mousemove", this.handleMouseMove, true);
        document.addEventListener("click", this.handleClick, true);
        this.overlay.addToDOM((_a = options.parentElement) !== null && _a !== void 0 ? _a : document.body, (_b = options.useShadowDOM) !== null && _b !== void 0 ? _b : true);
        this.tick();
        return true;
    }
    stop() {
        this.active = false;
        this.options = undefined;
        document.removeEventListener("mousemove", this.handleMouseMove, true);
        document.removeEventListener("click", this.handleClick, true);
        this.overlay.removeFromDOM();
        this.target = undefined;
        this.mouseX = undefined;
        this.mouseY = undefined;
        if (this.tickReq) window.cancelAnimationFrame(this.tickReq);
    }
    updateTarget() {
        var _a, _b;
        if (this.mouseX === undefined || this.mouseY === undefined) return;
        // Peek through the overlay to find the new target
        this.overlay.ignoreCursor();
        const elAtCursor = document.elementFromPoint(this.mouseX, this.mouseY);
        const newTarget = elAtCursor;
        this.overlay.captureCursor();
        // If the target hasn't changed, there's nothing to do
        if (!newTarget || newTarget === this.target) return;
        // If we have an element filter and the new target doesn't match,
        // clear out the target
        if ((_a = this.options) === null || _a === void 0 ? void 0 : _a.elementFilter) {
            if (!this.options.elementFilter(newTarget)) {
                this.target = undefined;
                this.overlay.setBounds({
                    x: 0,
                    y: 0,
                    width: 0,
                    height: 0
                });
                return;
            }
        }
        this.target = newTarget;
        const bounds = (0, $0d2e1d696ad9a5e9$export$abe5643cba19555f)(newTarget);
        this.overlay.setBounds(bounds);
        if ((_b = this.options) === null || _b === void 0 ? void 0 : _b.onHover) this.options.onHover(newTarget);
    }
}





const $8ee96a0c35d6f15f$var$defaultOptions = {
    escapeEverything: false,
    isIdentifier: false,
    quotes: "backtick",
    wrap: false
};
const $8ee96a0c35d6f15f$var$regexAnySingleEscape = /[ -,\.\/:-@\[-\^`\{-~]/;
const $8ee96a0c35d6f15f$var$regexSingleEscape = /[ -,\.\/:-@\[\]\^`\{-~]/;
const $8ee96a0c35d6f15f$var$regexExcessiveSpaces = /(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g;
function $8ee96a0c35d6f15f$export$4d8ccb164339c234(string, opt = {}) {
    const options = {
        ...$8ee96a0c35d6f15f$var$defaultOptions,
        ...opt
    };
    if (options.quotes != "single" && options.quotes != "double") options.quotes = "backtick";
    const quote = options.quotes == "backtick" ? "`" : '"';
    const isIdentifier = options.isIdentifier;
    const firstChar = string.charAt(0);
    let output = "";
    let counter = 0;
    const length = string.length;
    while(counter < length){
        const character = string.charAt(counter++);
        let codePoint = character.charCodeAt(0);
        let value = void 0;
        // If it’s not a printable ASCII character…
        if (codePoint < 0x20 || codePoint > 0x7e) {
            if (codePoint >= 0xd800 && codePoint <= 0xdbff && counter < length) {
                // It’s a high surrogate, and there is a next character.
                const extra = string.charCodeAt(counter++);
                if ((extra & 0xfc00) == 0xdc00) // next character is low surrogate
                codePoint = ((codePoint & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000;
                else // It’s an unmatched surrogate; only append this code unit, in case
                // the next code unit is the high surrogate of a surrogate pair.
                counter--;
            }
            value = "\\" + codePoint.toString(16).toUpperCase() + " ";
        } else {
            if (options.escapeEverything) {
                if ($8ee96a0c35d6f15f$var$regexAnySingleEscape.test(character)) value = "\\" + character;
                else value = "\\" + codePoint.toString(16).toUpperCase() + " ";
            } else if (/[\t\n\f\r\x0B]/.test(character)) value = "\\" + codePoint.toString(16).toUpperCase() + " ";
            else if (character == "\\" || !isIdentifier && (character == '"' && quote == character || character == "'" && quote == character) || isIdentifier && $8ee96a0c35d6f15f$var$regexSingleEscape.test(character)) value = "\\" + character;
            else value = character;
        }
        output += value;
    }
    if (isIdentifier) {
        if (/^-[-\d]/.test(output)) output = "\\-" + output.slice(1);
        else if (/\d/.test(firstChar)) output = "\\3" + firstChar + " " + output.slice(1);
    }
    // Remove spaces after `\HEX` escapes that are not followed by a hex digit,
    // since they’re redundant. Note that this is only possible if the escape
    // sequence isn’t preceded by an odd number of backslashes.
    output = output.replace($8ee96a0c35d6f15f$var$regexExcessiveSpaces, function($0, $1, $2) {
        if ($1 && $1.length % 2) // It’s not safe to remove the space, so don’t.
        return $0;
        // Strip the space.
        return ($1 || "") + $2;
    });
    if (!isIdentifier && options.wrap) return quote + output + quote;
    return output;
}


const $eca5f0a74b1f1765$export$b81b7dbe03f7c121 = (el)=>!!$eca5f0a74b1f1765$export$c8a20044beb8a172(el);
const $eca5f0a74b1f1765$export$c8a20044beb8a172 = (el)=>$eca5f0a74b1f1765$export$e1f445cd6eeea85e(`.tabber-content>kendo-tabstrip>[role='tabpanel'][aria-hidden='false']`)(el);
const $eca5f0a74b1f1765$export$1391212d75b2ee65 = (ms)=>new Promise((res)=>setTimeout(()=>res(0), ms));
const $eca5f0a74b1f1765$export$218c8c3169c024d2 = (el)=>{
    let id;
    if (id = el?.getAttribute("data-test")) return `[data-test='${id}']`;
    if (id = el?.getAttribute("parent-data-test")) return `[parent-data-test='${id}']`;
    if (id = el?.getAttribute("cmpid")) return `[cmpid='${id}']`;
    if (id = el?.getAttribute("data-cy")) return `[data-cy='${id}']`;
    return null;
};
const $eca5f0a74b1f1765$export$4a647155031ece = (el)=>{
    let settings;
    if (settings = el?.getAttribute("data-settings")) return JSON.parse(settings);
    return null;
};
const $eca5f0a74b1f1765$export$e1f445cd6eeea85e = (to)=>(from, stopOn, count)=>{
        const upSelectorToPred = (s)=>s ? typeof s === "object" ? (el)=>el === s : typeof s === "string" ? (el)=>el.matches(s) : s : (_)=>false;
        const targetPred = upSelectorToPred(to);
        const untilPred = upSelectorToPred(stopOn);
        while(from && !untilPred(from) && (!count || count > 0)){
            if (targetPred(from)) return from;
            if (typeof stopOn === "string" && from.matches(stopOn)) return null;
            from = from.parentElement;
            if (count) count--;
        }
        return null;
    };
const $eca5f0a74b1f1765$export$917fd6776815e690 = (el)=>el.tagName.toLowerCase().startsWith("tb-") || el.tagName.toLowerCase().startsWith("kendo-");
const $eca5f0a74b1f1765$export$f831dd079c3be771 = (el)=>$eca5f0a74b1f1765$export$218c8c3169c024d2(el) !== null;
const $eca5f0a74b1f1765$export$494b4b5b7c25b002 = $eca5f0a74b1f1765$export$e1f445cd6eeea85e($eca5f0a74b1f1765$export$917fd6776815e690);
const $eca5f0a74b1f1765$export$9813b7426bbdbcc3 = $eca5f0a74b1f1765$export$e1f445cd6eeea85e($eca5f0a74b1f1765$export$f831dd079c3be771);
const $eca5f0a74b1f1765$export$8733e2af6851723d = $eca5f0a74b1f1765$export$e1f445cd6eeea85e((el)=>$eca5f0a74b1f1765$export$f831dd079c3be771(el) || $eca5f0a74b1f1765$export$917fd6776815e690(el));
const $eca5f0a74b1f1765$export$8e1077bc36a840e3 = $eca5f0a74b1f1765$export$e1f445cd6eeea85e((el)=>$eca5f0a74b1f1765$export$f831dd079c3be771(el) && $eca5f0a74b1f1765$export$917fd6776815e690(el));
const $eca5f0a74b1f1765$export$3bf645f08efe3292 = (el, ...tags)=>tags.some((t)=>el?.tagName.toLowerCase() === t.toLowerCase());
function $eca5f0a74b1f1765$export$aeca4cd84e0bb2a4(input, pred) {
    const names = Array.from(input.classList).filter(pred);
    return names.map((name)=>"." + (0, $8ee96a0c35d6f15f$export$4d8ccb164339c234)(name, {
            isIdentifier: true
        }));
}
function $eca5f0a74b1f1765$export$a1a11b095f88289a(css) {
    return css.trim();
}


const $2ed861787b256cca$export$4659b591c19bdf3d = (map)=>(selector)=>selector in map ? map[selector] : "_" in map ? map["_"] : null;
$2ed861787b256cca$export$4659b591c19bdf3d({
    bear: "roar",
    bird: "cip",
    cat: "miao",
    dog: "bau",
    horse: "boh"
})("dog");
$2ed861787b256cca$export$4659b591c19bdf3d({
    bear: "roar",
    bird: "cip",
    cat: "miao",
    _: "boh"
})("dog");




const $108fceddea91583c$var$kendoGridRowIndexAttr = "data-kendo-grid-item-index";
const $108fceddea91583c$var$kendoGridColIndexAttr = "data-kendo-grid-column-index";
const $108fceddea91583c$var$kendoTreelistRowIndexAttr = "data-treelist-view-index";
const $108fceddea91583c$var$kendoTreelistColIndexAttr = "aria-colindex";
class $108fceddea91583c$export$518e6c43c5b1c30e {
    static isComponent(target, tagName) {
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        return (0, $eca5f0a74b1f1765$export$3bf645f08efe3292)(anc, tagName);
    }
    static capture(target, parsedEvent, tag, command, selector, attribute) {
        console.log("GenericCommandComponent capture");
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        const value = this.getValue(target, selector, attribute);
        return (0, $100b2cdf1a1e5933$export$98d55a3b08386cd3)(command, parsedEvent)(id, target, {
            tag: tag,
            eventValue: value
        });
    }
    static getValue(target, selector, attribute) {
        if (selector) return target.querySelector(selector)?.getAttribute(attribute);
        else return target.getAttribute(attribute);
    }
}
class $108fceddea91583c$export$3047b0dd9385f89 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-item-source")(target) || (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)(".tb-popup-item-source-content")(target);
    }
    static async capture(target, parsedEvent, isPicker) {
        console.log("ItemSourceComponent capture");
        var ancParent = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        if (ancParent.getAttribute("data-test")?.startsWith("itemSourceDropDownButton")) return Promise.resolve(null);
        if (ancParent.getAttribute("data-test")?.startsWith("itemSourceAddOnFly")) return Promise.resolve(null);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(ancParent);
        const valueDataTest = document.querySelector(id).getAttribute("parent-data-test");
        if (valueDataTest) {
            await (0, $eca5f0a74b1f1765$export$1391212d75b2ee65)(100);
            var itemSource = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-item-source")(document.querySelector(`[data-test='${valueDataTest}']`));
            const value = this.getValueFromSelector(valueDataTest);
            return (0, $100b2cdf1a1e5933$export$98d55a3b08386cd3)("select", parsedEvent)((0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(itemSource), target, {
                tag: "ItemSource",
                eventValue: value
            });
        }
        if (isPicker) {
            var itemSourceInput = target.querySelector("[selected-id]") || target;
            var value1 = this.getValue(itemSourceInput);
            var itemSource = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-item-source")(itemSourceInput);
            return (0, $100b2cdf1a1e5933$export$98d55a3b08386cd3)("select", parsedEvent)(`${(0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(itemSource)} ${(0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(itemSourceInput)}`, itemSourceInput, {
                tag: "ItemSource",
                eventValue: value1
            });
        }
    }
    static getValueFromSelector(value) {
        var target = document.querySelector(`[data-test='${value}']`);
        return target?.getAttribute("selected-id");
    }
    static getValue(target) {
        return target?.getAttribute("selected-id");
    }
}
class $108fceddea91583c$export$40073d408f029a0b {
    static isComponent(target) {
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        return (0, $eca5f0a74b1f1765$export$3bf645f08efe3292)(anc, "tb-panel");
    }
    static capture(target, command, parsedEvent) {
        console.log("PanelComponent capture");
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        return command(id, target, {
            tag: "TbPanel",
            display: "expand/collapse",
            other: anc.classList.contains("collapsed") ? "expand" : "collapse"
        });
    }
}
class $108fceddea91583c$export$d9f24a445e3fa038 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-dynamic-checkbox-list")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("DynamicCheckboxComponent capture");
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        if (target.tagName == "LABEL" || target.tagName == "SPAN") return null;
        return command(id, target, {
            tag: "DynamicCheckbox",
            eventValue: target.parentElement.querySelector("label").innerText,
            eventKey: parsedEvent?.key
        });
    }
}
class $108fceddea91583c$export$ecaa49d2dbf56de5 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-treelist")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("KendoTreeListComponent capture");
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        let id = undefined;
        if (target.tagName == "TD") id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(target.querySelector("[data-test]"));
        else id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        if ((0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-treelist-toolbar")(target) && anc.attributes["data-test"]) return command(id, anc);
        //if (target.attributes["data-test"]) return cmd.click(id, target);
        const row = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tr[" + $108fceddea91583c$var$kendoTreelistRowIndexAttr + "]")(target);
        if (row === null) {
            console.error("[MCR] no row index found.", target);
            return null;
        }
        const idx = row.getAttribute($108fceddea91583c$var$kendoTreelistRowIndexAttr); //ng-reflect-data-row-index (indice totale) - data-treelist-view-index (indice paginato) - ng-reflect-logical-row-index (indice logico totale)
        const td = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("td")(target); //kendotreelistlogicalcell
        if ((target.tagName === "SPAN" || target.tagName === "DIV") && target.classList.contains("k-icon")) return command(id, target, {
            tag: target.classList.contains("k-i-caret-alt-right") || target.classList.contains("k-i-expand") ? "KendoTreelistExpand" : "KendoTreelistCollapse",
            idx: idx,
            nth: +td.getAttribute($108fceddea91583c$var$kendoTreelistColIndexAttr),
            eventValue: td.querySelector("span[data-test],div[data-test]") ? td.querySelector("span[data-test],div[data-test]")?.getAttribute("data-test") : ""
        });
        if (td.querySelectorAll("[data-test]").length === 0) return command(id, target, {
            tag: "KendoTreelistNativeCell",
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            idx: idx,
            nth: +td.getAttribute($108fceddea91583c$var$kendoTreelistColIndexAttr)
        });
        var settings = (0, $eca5f0a74b1f1765$export$4a647155031ece)(this.isComponent(target));
        return command(id, target, {
            tag: settings?.rowIndex ? "KendoTreelistRowIndex" : "KendoTreelist",
            idx: idx,
            nth: +td.getAttribute($108fceddea91583c$var$kendoGridColIndexAttr),
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            eventValue: td.querySelector("span[data-test]") ? td.querySelector("span[data-test]")?.getAttribute("data-test") : ""
        });
    }
}
class $108fceddea91583c$export$97fb74d06163c4cd {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-grid")(target);
    }
    static capture(target, command, parsedEvent) {
        let vv = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e);
        console.log("KendoGridComponent capture");
        if ((0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-grid-toolbar")(target)) return null;
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        if (id === (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target))) return null;
        let idx = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[" + $108fceddea91583c$var$kendoGridRowIndexAttr + "]")(target)?.getAttribute($108fceddea91583c$var$kendoGridRowIndexAttr);
        let nth = +(0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[" + $108fceddea91583c$var$kendoGridColIndexAttr + "]")(target)?.getAttribute($108fceddea91583c$var$kendoGridColIndexAttr);
        if (!idx) return command(id, target, {
            tag: `KendoGrid`,
            idx: idx,
            nth: nth,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "click kendo grid"
        });
        if ((0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-grid")(target)) return command(id, target, {
            tag: `KendoGridRowIndex`,
            idx: idx,
            nth: nth,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "click grid index"
        });
    }
}
class $108fceddea91583c$export$1d82713ecf271015 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-be")(target);
    }
    static capture(target, command, parsedEvent) {
        let vv = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e);
        console.log("BodyEditComponent capture");
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        let idx = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[" + $108fceddea91583c$var$kendoGridRowIndexAttr + "]")(target)?.getAttribute($108fceddea91583c$var$kendoGridRowIndexAttr);
        let nth = +(0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[" + $108fceddea91583c$var$kendoGridColIndexAttr + "]")(target)?.getAttribute($108fceddea91583c$var$kendoGridColIndexAttr);
        if (id == (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)) && (!idx || target.classList.contains("k-grid-content"))) return command("[data-test='bodyEditPagerNumberDismissFocus']", target, {
            tag: "BodyEdit",
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target))
        });
        if (id && !idx && target.closest("kendo-grid thead tr > th")) return command(id, target, {
            tag: `BodyEdit`,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "click body edit header"
        });
        if (id && !idx && target.closest("tb-ev")) return command(id, target, {
            tag: `BEditView`,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "body edit view"
        });
        if (target.classList.contains("dummyRow")) return command(id, target, {
            tag: `BodyEditDummyRow`,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "add row"
        });
        if ((0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-grid")(target)) return command(id, target, {
            tag: `BodyEditRow`,
            idx: idx,
            nth: nth,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "click body grid"
        });
        else return command(id, target, {
            tag: `BodyEdit`,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "click body edit"
        });
    }
}
class $108fceddea91583c$export$94c9456df3c9d7b1 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-window")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("WindowComponent capture");
        const el = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(el);
        if (target.tagName == "SPAN" && target.parentElement?.hasAttribute("kendowindowcloseaction") || target.tagName == "BUTTON" && target.hasAttribute("kendowindowcloseaction")) return command("Kendo-Window", target, {
            tag: "WindowClose",
            display: "close window"
        });
        return command(id, target, {
            tag: "Window" /*, scope: 'All'*/ 
        });
    }
}
class $108fceddea91583c$export$24ec15341293d56f {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-dialog")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("DialogComponent capture");
        const el = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(el);
        if ((0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-dialog-actions")(target)) {
            if (target.closest("mc-scheduler-app")) return command("text=" + target.closest("button").querySelector(".k-button-text").innerText, target.closest("button"), {
                tag: "DialogActionsScheduler",
                display: "dialog actions"
            });
            return command(id ? id : "kendo-dialog", target, {
                tag: "DialogActions",
                display: "dialog actions"
            });
        }
        if (!el && (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-dialog-titlebar")(target) && target.tagName == "SPAN" && target.parentElement?.hasAttribute("title") && target.parentElement.getAttribute("aria-label") == "Close" || target.tagName == "BUTTON" && target.hasAttribute("title") && target.getAttribute("aria-label") == "Close") return command("Kendo-Dialog", target, {
            tag: "DialogClose",
            display: "close dialog"
        });
        if (!id) return null;
        return command(id, target, {
            tag: "Dialog" /*, scope: 'All'*/ 
        });
    }
}
class $108fceddea91583c$export$9cca54ee596bd686 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-dockpane-container")(target);
    }
    static isDesignState(target) {
        return !!(0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-dockpane-container.tb-design-state")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("DockerComponent capture");
        //const wrap = { up, upToId, upToCtrlWithId, getId };
        var tabberSelectorTarget = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)(".dockpane-tabber-selector")(target);
        if (tabberSelectorTarget == null) {
            var container = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-dockpane-container")(target);
            var tabberSelector = container.querySelector(".dockpane-tabber-selector ul li.active");
            const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(tabberSelector);
            return command(id, tabberSelector, {
                tag: "DockPane"
            });
        }
        return null;
    }
}
class $108fceddea91583c$export$5dab2a3f827061f6 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-upload")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("KendoUploadComponent capture");
        if (target.tagName == "INPUT" && target.parentElement.classList.contains("k-upload-button")) return command("kendo-upload div.k-upload-button input", target, {
            tag: "KendoUpload",
            display: "select file"
        });
        if (target.tagName == "BUTTON" && target.classList.contains("k-upload-selected")) return command("kendo-upload-action-buttons button.k-upload-selected", target, {
            tag: "KendoUpload",
            display: "upload file"
        });
        if (target.tagName == "BUTTON" && target.classList.contains("k-clear-selected")) return command("kendo-upload-action-buttons button.k-clear-selected", target, {
            tag: "KendoUpload",
            display: "clear file selected"
        });
        return null;
    }
}
class $108fceddea91583c$export$9ea6347596840518 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-radar-customisable-grid")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("RadarComponent capture");
        let vv = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e);
        const ownerDoc = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)((el)=>el.tagName.startsWith("TB-IDD"))(target);
        const row = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tr[" + $108fceddea91583c$var$kendoGridRowIndexAttr + "]")(target);
        if (row === null) {
            console.error("[MCR] no row index found.", target);
            return null;
        }
        const idx = row.getAttribute($108fceddea91583c$var$kendoGridRowIndexAttr);
        const el = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(el);
        const isWebStyle = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-grid")(target)?.classList?.contains("mode1");
        return command(id, target, {
            tag: isWebStyle ? "TbRadarWebStyle" : "TbRadarTableStyle",
            parent: ownerDoc?.tagName,
            idx: idx,
            display: "radar: click row " + idx
        });
    }
}


const $100b2cdf1a1e5933$var$capturingControls = [
    "tb-date-edit",
    "tb-application-date",
    "tb-enum-combo",
    "kendo-dropdownlist",
    "kendo-combobox",
    "kendo-multicolumncombobox",
    "kendo-multiselect"
]; // TS 3.4
const $100b2cdf1a1e5933$var$ctrl = {
    needsCapture: (el)=>(0, $eca5f0a74b1f1765$export$3bf645f08efe3292)(el, ...$100b2cdf1a1e5933$var$capturingControls),
    capturedValue: (capturedBy)=>(0, $2ed861787b256cca$export$4659b591c19bdf3d)({
            "tb-enum-combo": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, "[selected-code]", "selected-code"),
            "kendo-dropdownlist": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, undefined, "selected-code"),
            "kendo-multiselect": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, undefined, "selected-code"),
            "kendo-combobox": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, undefined, "selected-code"),
            "kendo-multicolumncombobox": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, undefined, "selected-code"),
            "tb-date-edit": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, "textarea, input", "selected-date"),
            "tb-application-date": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, "textarea, input", "selected-date"),
            _: ()=>capturedBy.querySelector("textarea, input")?.value
        })(capturedBy.tagName.toLowerCase())()
};
const $100b2cdf1a1e5933$var$handleCapturingControls = (()=>{
    let capturedBy = null;
    let oldValue = "";
    return async (target, parsedEvent)=>{
        console.log("handleCapturingControls capturedBy", capturedBy?.tagName);
        let vv = $100b2cdf1a1e5933$var$ctrl;
        const capture = ()=>{
            oldValue = "";
            capturedBy = $100b2cdf1a1e5933$var$ctrl.needsCapture(tmp) ? tmp : null;
            oldValue = capturedBy ? $100b2cdf1a1e5933$var$ctrl.capturedValue(capturedBy) : "";
            return capturedBy;
        };
        const tmp = (0, $eca5f0a74b1f1765$export$8e1077bc36a840e3)(target);
        if (capturedBy === null) return [
            [],
            capture()
        ];
        if (capturedBy && (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("cdk-virtual-scroll-viewport, kendo-calendar, kendo-list")(target)) return [
            [],
            capturedBy
        ];
        const outsideOfActiveCtrl = tmp === null && capturedBy !== null && !capturedBy.contains(target);
        const activeCtrlChanged = outsideOfActiveCtrl || tmp !== capturedBy || parsedEvent.action === (0, $1aae169a1a51f082$export$3d7865934588d77e).KEYDOWN && parsedEvent.key === "Tab";
        if (!activeCtrlChanged) return [
            [],
            capturedBy
        ];
        //await delay(100);
        const value = $100b2cdf1a1e5933$var$ctrl.capturedValue(capturedBy);
        console.log("handleCapturingControls control value", value, oldValue, capturedBy?.tagName);
        if (value === oldValue) return [
            [],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "tb-enum-combo")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, "EnumCombo", "select", "[selected-code]", "selected-code")
            ],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "kendo-dropdownlist")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, "KendoDropdownlist", "select", undefined, "selected-code")
            ],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "kendo-multiselect")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, "KendoDropdownlist", "select", undefined, "selected-code")
            ],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "kendo-combobox")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, "KendoDropdownlist", "select", undefined, "selected-code")
            ],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "kendo-multicolumncombobox")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, "KendoDropdownlist", "select", undefined, "selected-code")
            ],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "tb-date-edit")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, undefined, "write", "textarea, input", "selected-date")
            ],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "tb-application-date")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, undefined, "write", "textarea, input", "selected-date")
            ],
            capture()
        ];
        return [
            [],
            capture()
        ];
    };
})();
const $100b2cdf1a1e5933$var$toopt = (selector, el, options, parsedEvent)=>{
    options = options ?? {};
    if (parsedEvent?.value !== null && parsedEvent?.value !== undefined && parsedEvent?.value.length >= 0 && !options.eventValue) options.eventValue = parsedEvent?.value.toString().replace(/'/g, "\\'");
    if (parsedEvent?.key && !options.eventKey) options.eventKey = parsedEvent?.key.toString().replace(/'/g, "\\'");
    if (parsedEvent?.modifiers?.length > 0) options.keyboardModifier = parsedEvent.modifiers;
    if (parsedEvent?.pageIndex !== undefined) options.pageIndex = parsedEvent.pageIndex;
    options.force = !!(el?.hasAttribute("disabled") || el?.getAttribute("disabled"));
    options.retry = false;
    if (!options?.scope && !(0, $eca5f0a74b1f1765$export$b81b7dbe03f7c121)(el)) return {
        ...options,
        scope: "all"
    };
    if (options) return options;
    return {};
};
const $100b2cdf1a1e5933$export$98d55a3b08386cd3 = (cmd, parsedEvent)=>(selector, target, options)=>{
        return {
            Type: cmd,
            Selector: (0, $8ee96a0c35d6f15f$export$4d8ccb164339c234)(selector) + $100b2cdf1a1e5933$var$getTagName(target),
            Options: $100b2cdf1a1e5933$var$toopt(selector, target, options, parsedEvent)
        };
    };
// export const cmd = {
//   write: tocmd("write"),
//   select: tocmd("select"),
//   click: tocmd("click"),
//   keydown: tocmd("keydown"),
//   pick: tocmd("pick"),
// };
let $100b2cdf1a1e5933$var$pendingDrag = undefined;
let $100b2cdf1a1e5933$var$skipFind = false;
function $100b2cdf1a1e5933$var$getTagName(target) {
    if (target.attributes["data-test"] || target.attributes["data-cy"] || target.attributes["cmpId"]) return "";
    var element = (0, $eca5f0a74b1f1765$export$8e1077bc36a840e3)(target);
    if (!element) return "";
    if (element.tagName.startsWith("TB-")) {
        var e = target.tagName.toLowerCase();
        if ([
            "input",
            "select",
            "textarea"
        ].includes(e)) return " " + e;
        else if ((0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(target.closest("button")) == null && element.contains(target.closest("button"))) return " button";
    }
    return "";
}
function $100b2cdf1a1e5933$var$evaluatePostWaitCommand(target, res, parsedEvent) {
    if (parsedEvent?.modifiers?.includes("Control")) return $100b2cdf1a1e5933$export$98d55a3b08386cd3("wait", parsedEvent)("", target, {
        value: "5000"
    });
    return null;
}
function $100b2cdf1a1e5933$var$evaluatePreWaitCommand(target, res, parsedEvent) {
    var selectors, attr;
    return res; // disabilitato per il momento
}
async function $100b2cdf1a1e5933$export$e580b1cbf68957c3(target, command, parsedEvent, res = [], picker = false) {
    try {
        var firstClosestId = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        //if (firstClosestId?.hasAttribute("disabled")) return res; //hyperlink ora lo registro
        if ((0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-checkbox")(target) && !target.matches(`input[type='checkbox']`)) return res;
        res = $100b2cdf1a1e5933$var$evaluatePreWaitCommand(target, res, parsedEvent);
        let com = undefined;
        let dockPanecCom = undefined;
        if (!(0, $108fceddea91583c$export$9cca54ee596bd686).isDesignState(target) && (0, $108fceddea91583c$export$9cca54ee596bd686).isComponent(target) && !com && picker === false) dockPanecCom = (0, $108fceddea91583c$export$9cca54ee596bd686).capture(target, command, parsedEvent);
        if ((0, $108fceddea91583c$export$3047b0dd9385f89).isComponent(target)) com = await (0, $108fceddea91583c$export$3047b0dd9385f89).capture(target, parsedEvent, picker);
        if ((0, $108fceddea91583c$export$5dab2a3f827061f6).isComponent(target) && !com) com = (0, $108fceddea91583c$export$5dab2a3f827061f6).capture(target, command, parsedEvent);
        if ((0, $108fceddea91583c$export$9ea6347596840518).isComponent(target) && !com) com = (0, $108fceddea91583c$export$9ea6347596840518).capture(target, command, parsedEvent);
        if (((0, $108fceddea91583c$export$97fb74d06163c4cd).isComponent(target) || (0, $108fceddea91583c$export$1d82713ecf271015).isComponent(target)) && !com) {
            if ((0, $108fceddea91583c$export$1d82713ecf271015).isComponent(target) && !com) com = (0, $108fceddea91583c$export$1d82713ecf271015).capture(target, command, parsedEvent); //tb-be
            else com = (0, $108fceddea91583c$export$97fb74d06163c4cd).capture(target, command, parsedEvent); //kendo-grid semplice
        }
        if ((0, $108fceddea91583c$export$ecaa49d2dbf56de5).isComponent(target) && !com) com = (0, $108fceddea91583c$export$ecaa49d2dbf56de5).capture(target, command, parsedEvent);
        if ((0, $108fceddea91583c$export$d9f24a445e3fa038).isComponent(target) && !com) com = (0, $108fceddea91583c$export$d9f24a445e3fa038).capture(target, command, parsedEvent);
        if ((0, $108fceddea91583c$export$40073d408f029a0b).isComponent(target) && !com) com = (0, $108fceddea91583c$export$40073d408f029a0b).capture(target, command, parsedEvent);
        if ((0, $108fceddea91583c$export$24ec15341293d56f).isComponent(target) && !com) com = (0, $108fceddea91583c$export$24ec15341293d56f).capture(target, command, parsedEvent);
        if ((0, $108fceddea91583c$export$94c9456df3c9d7b1).isComponent(target) && !com) com = (0, $108fceddea91583c$export$94c9456df3c9d7b1).capture(target, command, parsedEvent);
        if (com) return [
            ...res,
            dockPanecCom,
            com
        ];
        console.log("generic selector for target: ", target, firstClosestId, (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(firstClosestId));
        if (!firstClosestId && parsedEvent.action !== "keydown") {
            console.log("firstClosestId not found");
            return res;
        }
        return [
            ...res,
            dockPanecCom,
            command(firstClosestId ? (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(firstClosestId) : "[data-test-app-root]", target, {
                force: false
            })
        ];
    } catch (error) {
        console.error(error);
    }
}
async function $100b2cdf1a1e5933$export$dc1aaf6398cf38a9(fromElement, toElement, parsedEvent) {
    try {
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(fromElement.target);
        const fromId = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(toElement.target);
        const toId = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        return [
            $100b2cdf1a1e5933$export$98d55a3b08386cd3("dragdrop", parsedEvent)(toId, toElement.target, {
                tag: "DragDrop",
                fromSelector: fromId
            })
        ];
    } catch (error) {
        console.error(error);
    }
    return [];
}
async function $100b2cdf1a1e5933$var$magofind(event, parsedEvent) {
    if ($100b2cdf1a1e5933$var$skipFind) {
        console.log("[MCR] find skipped.", event, parsedEvent);
        return [];
    }
    let target = event.target;
    if ($100b2cdf1a1e5933$var$skip(event, parsedEvent)) return [];
    $100b2cdf1a1e5933$var$skipFind = true;
    const [res, capturedBy] = await $100b2cdf1a1e5933$var$handleCapturingControls(target, parsedEvent);
    $100b2cdf1a1e5933$var$skipFind = false;
    if (capturedBy !== null) return res;
    let command = undefined;
    switch(parsedEvent.action){
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).DRAGSTART:
            $100b2cdf1a1e5933$var$pendingDrag = event;
            return [];
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).DROP:
            if (!$100b2cdf1a1e5933$var$pendingDrag) return [];
            return $100b2cdf1a1e5933$export$dc1aaf6398cf38a9($100b2cdf1a1e5933$var$pendingDrag, event, parsedEvent);
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).CHANGE:
            command = $100b2cdf1a1e5933$export$98d55a3b08386cd3("write", parsedEvent);
            return $100b2cdf1a1e5933$export$e580b1cbf68957c3(target, command, parsedEvent, res);
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).KEYDOWN:
            {
                command = $100b2cdf1a1e5933$export$98d55a3b08386cd3("keydown", parsedEvent);
                const keyTypesAccepted = [
                    (0, $1aae169a1a51f082$export$75972070afd93869).ESCAPE,
                    (0, $1aae169a1a51f082$export$75972070afd93869).F1,
                    (0, $1aae169a1a51f082$export$75972070afd93869).F2,
                    (0, $1aae169a1a51f082$export$75972070afd93869).F3,
                    (0, $1aae169a1a51f082$export$75972070afd93869).F7
                ]; //tab da gestire
                if (!keyTypesAccepted.map((x)=>x.toString()).includes(parsedEvent.key)) return res;
                return $100b2cdf1a1e5933$export$e580b1cbf68957c3(document.activeElement, command, parsedEvent, res);
            }
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).DBLCLICK:
            command = $100b2cdf1a1e5933$export$98d55a3b08386cd3("dblclick", parsedEvent);
            return $100b2cdf1a1e5933$export$e580b1cbf68957c3(target, command, parsedEvent, res);
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).CONTEXTMENU:
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).CLICK:
            command = $100b2cdf1a1e5933$export$98d55a3b08386cd3("click", parsedEvent);
            return $100b2cdf1a1e5933$export$e580b1cbf68957c3(target, command, parsedEvent, res);
    }
    return res;
}
const $100b2cdf1a1e5933$var$skip = (_, parsedEvent)=>(parsedEvent.action === (0, $1aae169a1a51f082$export$3d7865934588d77e).CHANGE || parsedEvent.action === (0, $1aae169a1a51f082$export$3d7865934588d77e).KEYDOWN) && (parsedEvent.inputType === "checkbox" || parsedEvent.inputType === "radio");
async function $100b2cdf1a1e5933$export$2e2bcd8739ae039(event) {
    //console.log('parseEvent', event);
    const parsedEvent = {
        action: event.type,
        tag: event.target.tagName,
        value: [
            "checkbox",
            "radio"
        ].includes(event.target.type) ? event.target.checked + "" : event.target.value,
        pageIndex: window["___mcr___pageIndex"] !== undefined ? window["___mcr___pageIndex"] : 0
    };
    if (event.target.hasAttribute("href")) parsedEvent.href = event.target.href;
    if (event.target.hasAttribute("id")) parsedEvent.id = event.target.id;
    if (parsedEvent.tag === "INPUT") parsedEvent.inputType = event.target.type;
    if (event.type === "keydown") parsedEvent.key = event.key;
    var modifiers = [
        "Alt",
        "Control",
        "Meta",
        "Shift"
    ];
    parsedEvent.modifiers = [];
    modifiers.forEach((mod)=>{
        if ((event instanceof KeyboardEvent || event instanceof PointerEvent) && event.getModifierState(mod)) parsedEvent.modifiers.push(mod);
    });
    let res = await $100b2cdf1a1e5933$var$magofind(event, parsedEvent);
    res = res.filter((x)=>!!x); //tolgo i nulli
    console.log("res: ", res);
    return res.map((x)=>({
            ...x,
            EventType: parsedEvent.action
        })).map((command)=>({
            ...parsedEvent,
            command: command
        }));
}



function $4068186cacd1ad2c$var$handleEvent(event) {
    if (!event.isTrusted) return;
    (0, $100b2cdf1a1e5933$export$2e2bcd8739ae039)(event).then((e)=>{
        if (window["___mcr___send"]) window["___mcr___send"](JSON.stringify({
            type: "commands",
            content: JSON.stringify(e.map((x)=>x.command))
        }));
    });
}
function $4068186cacd1ad2c$var$addDOMListeners() {
    if (window["___mcr___isListening"]) {
        console.error("[mcr] addDOMListeners: already listening");
        return;
    }
    window["___mcr___isListening"] = true;
    Object.values((0, $1aae169a1a51f082$export$3d7865934588d77e)).forEach((event)=>{
        document.addEventListener(event, $4068186cacd1ad2c$var$handleEvent, {
            capture: true,
            passive: true
        });
    });
    console.log("[mcr] addDOMListeners: done");
}
function $4068186cacd1ad2c$var$removeDOMListeners() {
    if (!window["___mcr___isListening"]) {
        console.log("[mcr] removeDOMListeners: already not listening");
        return;
    }
    delete window["___mcr___isListening"];
    Object.values((0, $1aae169a1a51f082$export$3d7865934588d77e)).forEach((event)=>{
        document.removeEventListener(event, $4068186cacd1ad2c$var$handleEvent, {
            capture: true
        });
    });
    console.log("[mcr] removeDOMListeners: done");
}
async function $4068186cacd1ad2c$var$pick(uid) {
    const picker = new (0, $7c5d4ec7fb1c475d$export$2e2bcd8739ae039)();
    picker.start({
        elementFilter: (el)=>{
            return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[cmpid]")(el) || (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[data-test]")(el) || (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[data-cy]")(el);
        },
        onHover: (el)=>console.log(el),
        onClick: async (el)=>{
            picker.stop();
            console.log(`Picked: ${el}`);
            const ctrl = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[cmpid]")(el) || (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[data-test]")(el) || (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[data-cy]")(el);
            if (!ctrl) return;
            const parsedEvent = {
                action: "pick",
                tag: el.tagName,
                value: el.value,
                pageIndex: window["___mcr___pageIndex"]
            };
            var res = await (0, $100b2cdf1a1e5933$export$e580b1cbf68957c3)(el, (0, $100b2cdf1a1e5933$export$98d55a3b08386cd3)("pick", parsedEvent), parsedEvent, [], true);
            res = res.filter((x)=>!!x); //tolgo i nulli
            res.map((x)=>{
                if (x.Options) {
                    var el = document.querySelectorAll(x.Selector);
                    for(var i = 0; i < el.length; i++){
                        var xx = el[i].closest(".tabber-content>kendo-tabstrip>[role='tabpanel'][aria-hidden='false']");
                        if (!xx) continue;
                        x.Options.scope = "Document";
                    }
                    if (!x.Options.scope) x.Options.scope = "All";
                }
            });
            let value = "";
            if (res.length === 1) {
                var sel = document.querySelector(res[0].Selector);
                if (sel instanceof HTMLInputElement) value = sel.value;
                else value = sel.querySelector("input,textarea")?.value;
                res[0].Options.value = value;
            }
            console.log("Element picker", res, value);
            if (window["___mcr___send"]) window["___mcr___send"](JSON.stringify({
                type: "pick",
                content: JSON.stringify(res),
                uid: uid,
                value: value
            }));
        }
    });
}
async function $4068186cacd1ad2c$var$setPageIndex(index) {
    window["___mcr___pageIndex"] = index;
}
function $4068186cacd1ad2c$var$initialize() {
    window["___mcr___injected"] = true;
    window["___mcr___startListening"] = $4068186cacd1ad2c$var$addDOMListeners;
    window["___mcr___stopListening"] = $4068186cacd1ad2c$var$removeDOMListeners;
    window["___mcr___page"] = $4068186cacd1ad2c$var$setPageIndex;
    window["___mcr___pick"] = $4068186cacd1ad2c$var$pick;
}
$4068186cacd1ad2c$var$initialize();

})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJtYXBwaW5ncyI6IjtBQ0FBLElBQU87VUFBSyxTQUFTO0lBQVQsVUFDVixXQUFRO0lBREUsVUFFVixZQUFTO0lBRkMsVUFHVixjQUFXO0lBSEQsVUFJVixhQUFVO0lBSkEsVUFLVixZQUFTO0lBTEMsVUFNVixpQkFBYztJQU5KLFVBT1YsZUFBWTtJQVBGLFVBUVYsVUFBTztHQVJHLDhDQUFBO0lBV0w7VUFBSyxXQUFXO0lBQVgsWUFBYyxZQUFTO0lBQXZCLFlBQWlDLFFBQUE7SUFBakMsWUFBNEMsUUFBQTtJQUE1QyxZQUF1RCxRQUFBO0lBQXZELFlBQWtFLFFBQUE7SUFBbEUsWUFBNkUsU0FBTTtHQUFuRiw4Q0FBQTtJQUVMO1VBQUssYUFBYTtJQUFiLGNBQUEsY0FDVixXQUFBLEtBQUE7SUFEVSxjQUFBLGNBRVYsVUFBQSxLQUFBO0lBRlUsY0FBQSxjQUdWLFdBQUEsS0FBQTtJQUhVLGNBQUEsY0FJVixZQUFBLEtBQUE7SUFKVSxjQUFBLGNBS1YsVUFBQSxLQUFBO0lBTFUsY0FBQSxjQU1WLFVBQUEsS0FBQTtJQU5VLGNBQUEsY0FPVixVQUFBLEtBQUE7SUFQVSxjQUFBLGNBUVYsVUFBQSxLQUFBO0dBUlUsOENBQUE7SUFXTDtVQUFLLFFBQVE7SUFBUixTQUFBLFNBQ1YsUUFBQSxLQUFBO0lBRFUsU0FBQSxTQUVWLFNBQUEsS0FBQTtJQUZVLFNBQUEsU0FHVixZQUFBLEtBQUE7R0FIVSw4Q0FBQTs7QUR4Qlo7QUlBZTtJQUNYLFlBQVksT0FBTyxDQUFFO1FBQ2pCLElBQUksSUFBSSxJQUFJLElBQUksSUFBSSxJQUFJLElBQUksSUFBSSxJQUFJO1FBQ3BDLElBQUksQ0FBQyxPQUFPLEdBQUcsU0FBUyxhQUFhLENBQUM7UUFDdEMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEdBQUcsUUFBUSxTQUFTLElBQUk7UUFDOUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsVUFBVSxHQUFHLEFBQUMsQ0FBQSxBQUFDLENBQUEsS0FBSyxRQUFRLEtBQUssQUFBRCxNQUFPLElBQUksSUFBSSxPQUFPLEtBQUssSUFBSSxLQUFLLElBQUksR0FBRyxVQUFVLEFBQUQsS0FBTTtRQUM3RyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxXQUFXLEdBQUcsQUFBQyxDQUFBLEFBQUMsQ0FBQSxLQUFLLFFBQVEsS0FBSyxBQUFELE1BQU8sSUFBSSxJQUFJLE9BQU8sS0FBSyxJQUFJLEtBQUssSUFBSSxHQUFHLFdBQVcsQUFBRCxLQUFNO1FBQy9HLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFdBQVcsR0FBRyxBQUFDLENBQUEsQUFBQyxDQUFBLEtBQUssUUFBUSxLQUFLLEFBQUQsTUFBTyxJQUFJLElBQUksT0FBTyxLQUFLLElBQUksS0FBSyxJQUFJLEdBQUcsV0FBVyxBQUFELEtBQU07UUFDL0csSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxHQUFHLEFBQUMsQ0FBQSxBQUFDLENBQUEsS0FBSyxRQUFRLEtBQUssQUFBRCxNQUFPLElBQUksSUFBSSxPQUFPLEtBQUssSUFBSSxLQUFLLElBQUksR0FBRyxZQUFZLEFBQUQsS0FBTTtRQUNqSCxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxXQUFXLEdBQUcsQUFBQyxDQUFBLEFBQUMsQ0FBQSxLQUFLLFFBQVEsS0FBSyxBQUFELE1BQU8sSUFBSSxJQUFJLE9BQU8sS0FBSyxJQUFJLEtBQUssSUFBSSxHQUFHLFdBQVcsQUFBRCxLQUFNO1FBQy9HLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFNBQVMsR0FBRyxBQUFDLENBQUEsQUFBQyxDQUFBLEtBQUssUUFBUSxLQUFLLEFBQUQsTUFBTyxJQUFJLElBQUksT0FBTyxLQUFLLElBQUksS0FBSyxJQUFJLEdBQUcsU0FBUyxBQUFELEtBQU07UUFDM0csSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLEFBQUMsQ0FBQSxBQUFDLENBQUEsS0FBSyxRQUFRLEtBQUssQUFBRCxNQUFPLElBQUksSUFBSSxPQUFPLEtBQUssSUFBSSxLQUFLLElBQUksR0FB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Q0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLFFBQVE7Z0JBQ2hELElBQUksZUFBZSxrQkFDZixRQUFRLElBQUksS0FBSztxQkFDaEIsUUFBUyxJQUFJLGFBQWEsQ0FBQyxtQkFBd0M7Z0JBQ3hFLEdBQUcsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEtBQUssR0FBRztZQUMzQixDQUFDO1lBQ0QsUUFBUSxHQUFHLENBQUMsa0JBQWtCLEtBQUs7WUFFbkMsSUFBSSxNQUFNLENBQUMsZ0JBQWdCLEVBQ3ZCLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLFNBQVMsQ0FBQztnQkFBRSxNQUFNO2dCQUFRLFNBQVMsS0FBSyxTQUFTLENBQUM7cUJBQU07dUJBQUs7WUFBTTtRQUN4RztJQUNKO0FBQ0o7QUFFQSxlQUFlLG1DQUFhLEtBQWEsRUFBRTtJQUN2QyxNQUFNLENBQUMscUJBQXFCLEdBQUc7QUFDbkM7QUFFQSxTQUFTLG1DQUFtQjtJQUN4QixNQUFNLENBQUMsb0JBQW9CLEdBQUcsSUFBSTtJQUNsQyxNQUFNLENBQUMsMEJBQTBCLEdBQUc7SUFDcEMsTUFBTSxDQUFDLHlCQUF5QixHQUFHO0lBQ25DLE1BQU0sQ0FBQyxnQkFBZ0IsR0FBRztJQUMxQixNQUFNLENBQUMsZ0JBQWdCLEdBQUc7QUFDOUI7QUFFQSIsInNvdXJjZXMiOlsiaW50ZXJjZXB0b3IudHMiLCJ0eXBlcy50cyIsIm5vZGVfbW9kdWxlcy9waWNrLWRvbS1lbGVtZW50L2Rpc3QvaW5kZXguanMiLCJub2RlX21vZHVsZXMvcGljay1kb20tZWxlbWVudC9kaXN0L2VsZW1lbnQtcGlja2VyLmpzIiwibm9kZV9tb2R1bGVzL3BpY2stZG9tLWVsZW1lbnQvZGlzdC9lbGVtZW50LW92ZXJsYXkuanMiLCJub2RlX21vZHVsZXMvcGljay1kb20tZWxlbWVudC9kaXN0L3V0aWxzLmpzIiwiZXZlbnRQYXJzZXIudHMiLCJ1LnRzIiwiY3NzZXNjLnRzIiwibWF0Y2hlci50cyIsImNhcHRvcnMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tbWFuZCwgRXZlbnRUeXBlLCBQYXJzZWRFdmVudCB9IGZyb20gXCIuL3R5cGVzXCI7XHJcbmltcG9ydCB7IEVsZW1lbnRQaWNrZXIgfSBmcm9tIFwicGljay1kb20tZWxlbWVudFwiO1xyXG5pbXBvcnQgcGFyc2VFdmVudCwgeyBjYXB0dXJlRXZlbnRBdHRyaWJ1dGVzLCB0b2NtZCB9IGZyb20gXCIuL2V2ZW50UGFyc2VyXCI7XHJcbmltcG9ydCB7IHVwIH0gZnJvbSBcIi4vdVwiO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlRXZlbnQoZXZlbnQ6IEV2ZW50KTogdm9pZCB7XHJcbiAgICBpZiAoIWV2ZW50LmlzVHJ1c3RlZCkgcmV0dXJuO1xyXG4gICAgcGFyc2VFdmVudChldmVudCkudGhlbigoZSkgPT4ge1xyXG4gICAgICAgIGlmICh3aW5kb3dbXCJfX19tY3JfX19zZW5kXCJdKVxyXG4gICAgICAgICAgICB3aW5kb3dbXCJfX19tY3JfX19zZW5kXCJdKFxyXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiY29tbWFuZHNcIixcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBKU09OLnN0cmluZ2lmeShlLm1hcCgoeCkgPT4geC5jb21tYW5kKSksXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZERPTUxpc3RlbmVycygpOiB2b2lkIHtcclxuICAgIGlmICh3aW5kb3dbXCJfX19tY3JfX19pc0xpc3RlbmluZ1wiXSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJbbWNyXSBhZGRET01MaXN0ZW5lcnM6IGFscmVhZHkgbGlzdGVuaW5nXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHdpbmRvd1tcIl9fX21jcl9fX2lzTGlzdGVuaW5nXCJdID0gdHJ1ZTtcclxuICAgIE9iamVjdC52YWx1ZXMoRXZlbnRUeXBlKS5mb3JFYWNoKChldmVudCkgPT4ge1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZUV2ZW50LCB7XHJcbiAgICAgICAgICAgIGNhcHR1cmU6IHRydWUsXHJcbiAgICAgICAgICAgIHBhc3NpdmU6IHRydWUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIGNvbnNvbGUubG9nKFwiW21jcl0gYWRkRE9NTGlzdGVuZXJzOiBkb25lXCIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVET01MaXN0ZW5lcnMoKTogdm9pZCB7XHJcbiAgICBpZiAoIXdpbmRvd1tcIl9fX21jcl9fX2lzTGlzdGVuaW5nXCJdKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJbbWNyXSByZW1vdmVET01MaXN0ZW5lcnM6IGFscmVhZHkgbm90IGxpc3RlbmluZ1wiKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBkZWxldGUgd2luZG93W1wiX19fbWNyX19faXNMaXN0ZW5pbmdcIl07XHJcbiAgICBPYmplY3QudmFsdWVzKEV2ZW50VHlwZSkuZm9yRWFjaCgoZXZlbnQpID0+IHtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVFdmVudCwgeyBjYXB0dXJlOiB0cnVlIH0pO1xyXG4gICAgfSk7XHJcbiAgICBjb25zb2xlLmxvZyhcIlttY3JdIHJlbW92ZURPTUxpc3RlbmVyczogZG9uZVwiKTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gcGljayh1aWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3QgcGlja2VyID0gbmV3IEVsZW1lbnRQaWNrZXIoKTtcclxuICAgIHBpY2tlci5zdGFydCh7XHJcbiAgICAgICAgZWxlbWVudEZpbHRlcjogKGVsKSA9PiB7IHJldHVybiB1cChcIltjbXBpZF1cIikoZWwpIHx8IHVwKFwiW2RhdGEtdGVzdF1cIikoZWwpIHx8IHVwKFwiW2RhdGEtY3ldXCIpKGVsKSB9LFxyXG4gICAgICAgIG9uSG92ZXI6IChlbCkgPT4gY29uc29sZS5sb2coZWwpLC8vIGNvbnNvbGUubG9nKGBIb3ZlcjogJHtlbH1gKSxcclxuICAgICAgICBvbkNsaWNrOiBhc3luYyAoZWwpID0+IHtcclxuICAgICAgICAgICAgcGlja2VyLnN0b3AoKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYFBpY2tlZDogJHtlbH1gKTtcclxuICAgICAgICAgICAgY29uc3QgY3RybCA9IHVwKFwiW2NtcGlkXVwiKShlbCkgfHwgdXAoXCJbZGF0YS10ZXN0XVwiKShlbCkgfHwgdXAoXCJbZGF0YS1jeV1cIikoZWwpO1xyXG4gICAgICAgICAgICBpZiAoIWN0cmwpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCA9IHtcclxuICAgICAgICAgICAgICAgIGFjdGlvbjogJ3BpY2snLFxyXG4gICAgICAgICAgICAgICAgdGFnOiAoZWwgYXMgRWxlbWVudCkudGFnTmFtZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiAoZWwgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUsXHJcbiAgICAgICAgICAgICAgICBwYWdlSW5kZXg6IHdpbmRvd1snX19fbWNyX19fcGFnZUluZGV4J11cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHZhciByZXM6IEFycmF5PENvbW1hbmQ+ID0gYXdhaXQgY2FwdHVyZUV2ZW50QXR0cmlidXRlcyhlbCwgdG9jbWQoJ3BpY2snLCBwYXJzZWRFdmVudCksIHBhcnNlZEV2ZW50LCBbXSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHJlcyA9IHJlcy5maWx0ZXIoeCA9PiAhIXgpOyAvL3RvbGdvIGkgbnVsbGlcclxuICAgICAgICAgICAgcmVzLm1hcCh4ID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh4Lk9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHguU2VsZWN0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWwubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHh4ID0gZWxbaV0uY2xvc2VzdChcIi50YWJiZXItY29udGVudD5rZW5kby10YWJzdHJpcD5bcm9sZT0ndGFicGFuZWwnXVthcmlhLWhpZGRlbj0nZmFsc2UnXVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF4eCkgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHguT3B0aW9ucy5zY29wZSA9ICdEb2N1bWVudCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgheC5PcHRpb25zLnNjb3BlKSB4Lk9wdGlvbnMuc2NvcGUgPSAnQWxsJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9ICcnO1xyXG4gICAgICAgICAgICBpZiAocmVzLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocmVzWzBdLlNlbGVjdG9yKTtcclxuICAgICAgICAgICAgICAgIGlmIChzZWwgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gc2VsLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB2YWx1ZSA9IChzZWwucXVlcnlTZWxlY3RvcignaW5wdXQsdGV4dGFyZWEnKSBhcyBIVE1MSW5wdXRFbGVtZW50KT8udmFsdWU7XHJcbiAgICAgICAgICAgICAgICByZXNbMF0uT3B0aW9ucy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFbGVtZW50IHBpY2tlcicsIHJlcywgdmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHdpbmRvd1tcIl9fX21jcl9fX3NlbmRcIl0pXHJcbiAgICAgICAgICAgICAgICB3aW5kb3dbXCJfX19tY3JfX19zZW5kXCJdKEpTT04uc3RyaW5naWZ5KHsgdHlwZTogXCJwaWNrXCIsIGNvbnRlbnQ6IEpTT04uc3RyaW5naWZ5KHJlcyksIHVpZCwgdmFsdWUgfSkpO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gc2V0UGFnZUluZGV4KGluZGV4OiBudW1iZXIpIHtcclxuICAgIHdpbmRvd1tcIl9fX21jcl9fX3BhZ2VJbmRleFwiXSA9IGluZGV4O1xyXG59XHJcblxyXG5mdW5jdGlvbiBpbml0aWFsaXplKCk6IHZvaWQge1xyXG4gICAgd2luZG93W1wiX19fbWNyX19faW5qZWN0ZWRcIl0gPSB0cnVlO1xyXG4gICAgd2luZG93W1wiX19fbWNyX19fc3RhcnRMaXN0ZW5pbmdcIl0gPSBhZGRET01MaXN0ZW5lcnM7XHJcbiAgICB3aW5kb3dbXCJfX19tY3JfX19zdG9wTGlzdGVuaW5nXCJdID0gcmVtb3ZlRE9NTGlzdGVuZXJzO1xyXG4gICAgd2luZG93W1wiX19fbWNyX19fcGFnZVwiXSA9IHNldFBhZ2VJbmRleDtcclxuICAgIHdpbmRvd1tcIl9fX21jcl9fX3BpY2tcIl0gPSBwaWNrO1xyXG59XHJcblxyXG5pbml0aWFsaXplKCk7XHJcbiIsImV4cG9ydCBlbnVtIEV2ZW50VHlwZSB7XHJcbiAgQ0xJQ0sgPSAnY2xpY2snLFxyXG4gIENIQU5HRSA9ICdjaGFuZ2UnLFxyXG4gIERCTENMSUNLID0gJ2RibGNsaWNrJyxcclxuICBLRVlET1dOID0gJ2tleWRvd24nLFxyXG4gIFNVQk1JVCA9ICdzdWJtaXQnLFxyXG4gIENPTlRFWFRNRU5VID0gJ2NvbnRleHRtZW51JyxcclxuICBEUkFHU1RBUlQgPSAnZHJhZ3N0YXJ0JyxcclxuICBEUk9QID0gJ2Ryb3AnXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEtleWRvd25UeXBlIHsgRVNDQVBFID0gJ0VzY2FwZScsIEYxID0gJ0YxJywgRjIgPSAnRjInLCBGMyA9ICdGMycsIEY3ID0gJ0Y3JywgVEFCID0gJ1RhYicgfVxyXG5cclxuZXhwb3J0IGVudW0gQ29udHJvbEFjdGlvbiB7XHJcbiAgU1RBUlQsXHJcbiAgU1RPUCxcclxuICBSRVNFVCxcclxuICBERUxFVEUsXHJcbiAgTU9WRSxcclxuICBQVVNILFxyXG4gIEVESVQsXHJcbiAgTE9BRCxcclxufVxyXG5cclxuZXhwb3J0IGVudW0gUmVjU3RhdGUge1xyXG4gIE9OLFxyXG4gIE9GRixcclxuICBQQVVTRUQsXHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIFRhZ3MgPVxyXG4gIHwgJ0RvY2tQYW5lJ1xyXG4gIHwgJ0RpYWxvZydcclxuICB8ICdEaWFsb2dBY3Rpb25zJ1xyXG4gIHwgJ0RpYWxvZ0FjdGlvbnNTY2hlZHVsZXInXHJcbiAgfCAnRGlhbG9nQ2xvc2UnXHJcbiAgfCAnV2luZG93J1xyXG4gIHwgJ1dpbmRvd0FjdGlvbnMnXHJcbiAgfCAnV2luZG93Q2xvc2UnXHJcbiAgfCAnVGJSYWRhcldlYlN0eWxlJ1xyXG4gIHwgJ1RiUmFkYXJUYWJsZVN0eWxlJ1xyXG4gIHwgJ0tlbmRvR3JpZCdcclxuICB8ICdCb2R5RWRpdCdcclxuICB8ICdCb2R5RWRpdFJvdydcclxuICB8ICdCb2R5RWRpdENoZWNrYm94J1xyXG4gIHwgJ0JvZHlFZGl0RHVtbXlSb3cnXHJcbiAgfCAnSXRlbVNvdXJjZSdcclxuICB8ICdFbnVtQ29tYm8nXHJcbiAgfCAnVGJQYW5lbCdcclxuICB8ICdLZW5kb1VwbG9hZCdcclxuICB8ICdLZW5kb0Ryb3Bkb3dubGlzdCdcclxuICB8ICdLZW5kb1RyZWVsaXN0J1xyXG4gIHwgJ0tlbmRvVHJlZWxpc3RSb3dJbmRleCdcclxuICB8ICdLZW5kb1RyZWVsaXN0TmF0aXZlQ2VsbCdcclxuICB8ICdLZW5kb1RyZWVsaXN0RXhwYW5kJ1xyXG4gIHwgJ0tlbmRvVHJlZWxpc3RDb2xsYXBzZSdcclxuICB8ICdEeW5hbWljQ2hlY2tib3gnXHJcbiAgfCAnRHJhZ0Ryb3AnXHJcbiAgfCAnS2VuZG9HcmlkUm93SW5kZXgnXHJcbiAgfCAnQkVkaXRWaWV3JztcclxuXHJcbmV4cG9ydCB0eXBlIE9wdGlvbnMgPSB7XHJcbiAgbWFpbkNvbXBvbmVudD86IHN0cmluZzsvL3RiLWJlW2RhdGEtdGVzdD0uLi5dXHJcbiAgZGlzcGxheT86IHN0cmluZztcclxuICB0YWc/OiBUYWdzO1xyXG4gIGZyb21TZWxlY3Rvcj86c3RyaW5nO1xyXG4gIC8vY2hhbmNlPzogc3RyaW5nO1xyXG4gIGlkeD86IHN0cmluZztcclxuICBvdGhlcj86IHN0cmluZztcclxuICBzY29wZT86IHN0cmluZztcclxuICBmb3JjZT86IGJvb2xlYW47XHJcbiAgbnRoPzogbnVtYmVyO1xyXG4gIC8vb3B0aW9uYWw/OiB0cnVlO1xyXG4gIHBhcmVudD86IHN0cmluZzsvL3RiLWlkZC0uLi5cclxuICB6aW5kZXg/OiBudW1iZXI7XHJcbiAgZXZlbnRLZXk/OiBzdHJpbmc7XHJcbiAgZXZlbnRWYWx1ZT86IHN0cmluZztcclxuICB2YWx1ZT86IHN0cmluZztcclxuICBrZXlib2FyZE1vZGlmaWVyPzogQXJyYXk8c3RyaW5nPjtcclxuICBwYWdlSW5kZXg/OiBudW1iZXI7XHJcbiAgcmV0cnk/OiBib29sZWFuO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgQ29tbWFuZFR5cGUgPSAnY2xpY2snIHwgJ2RibGNsaWNrJyB8ICd3cml0ZScgfCAnc2VsZWN0JyB8ICdnb3RvJyB8ICdrZXlkb3duJyB8ICdwaWNrJyB8ICd3YWl0JyB8ICdkcmFnZHJvcCc7XHJcblxyXG5leHBvcnQgdHlwZSBDb21tYW5kID0ge1xyXG4gIFR5cGU6IENvbW1hbmRUeXBlO1xyXG4gIFNlbGVjdG9yOiBzdHJpbmc7XHJcbiAgT3B0aW9ucz86IE9wdGlvbnM7XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBQYXJzZWRFdmVudCA9IHtcclxuICBzZWxlY3Rvcj86IHN0cmluZztcclxuICBhY3Rpb246IHN0cmluZztcclxuICB0YWc6IHN0cmluZztcclxuICB2YWx1ZTogc3RyaW5nO1xyXG4gIGlkPzogc3RyaW5nO1xyXG4gIGtleT86IHN0cmluZztcclxuICBocmVmPzogc3RyaW5nO1xyXG4gIGlucHV0VHlwZT86IHN0cmluZztcclxuICBjb21tYW5kPzogQ29tbWFuZDtcclxuICBtb2RpZmllcnM/OiBBcnJheTxzdHJpbmc+O1xyXG4gIHBhZ2VJbmRleD86IG51bWJlcjtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIFNlc3Npb24gPSB7XHJcbiAgaXNQZW5kaW5nOiBib29sZWFuO1xyXG4gIGxhc3RVUkw6IHN0cmluZztcclxuICBvcmlnaW5hbEhvc3Q6IHN0cmluZztcclxuICBhY3RpdmVQb3J0OiBjaHJvbWUucnVudGltZS5Qb3J0IHwgbnVsbDtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIEFjdGlvbldpdGhQYXlsb2FkID0ge1xyXG4gIHR5cGU6IENvbnRyb2xBY3Rpb247XHJcbiAgcGF5bG9hZD86IGFueTtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIEJsb2NrID0ge1xyXG4gIGNvbW1hbmQ6IENvbW1hbmQ7XHJcbiAgaWQ6IHN0cmluZztcclxufTtcclxuIiwiaW1wb3J0IEVsZW1lbnRQaWNrZXIgZnJvbSBcIi4vZWxlbWVudC1waWNrZXJcIjtcbmV4cG9ydCB7IEVsZW1lbnRQaWNrZXIgfTtcbiIsImltcG9ydCBFbGVtZW50T3ZlcmxheSBmcm9tIFwiLi9lbGVtZW50LW92ZXJsYXlcIjtcbmltcG9ydCB7IGdldEVsZW1lbnRCb3VuZHMgfSBmcm9tIFwiLi91dGlsc1wiO1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRWxlbWVudFBpY2tlciB7XG4gICAgY29uc3RydWN0b3Iob3ZlcmxheU9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVNb3VzZU1vdmUgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMubW91c2VYID0gZXZlbnQuY2xpZW50WDtcbiAgICAgICAgICAgIHRoaXMubW91c2VZID0gZXZlbnQuY2xpZW50WTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5oYW5kbGVDbGljayA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgaWYgKHRoaXMudGFyZ2V0ICYmICgoX2EgPSB0aGlzLm9wdGlvbnMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5vbkNsaWNrKSkge1xuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5vbkNsaWNrKHRoaXMudGFyZ2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KCk7XG4gICAgICAgICAgICB0aGlzLnRpY2tSZXEgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMudGljayk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMub3ZlcmxheSA9IG5ldyBFbGVtZW50T3ZlcmxheShvdmVybGF5T3B0aW9ucyAhPT0gbnVsbCAmJiBvdmVybGF5T3B0aW9ucyAhPT0gdm9pZCAwID8gb3ZlcmxheU9wdGlvbnMgOiB7fSk7XG4gICAgfVxuICAgIHN0YXJ0KG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIHRoaXMuaGFuZGxlTW91c2VNb3ZlLCB0cnVlKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuaGFuZGxlQ2xpY2ssIHRydWUpO1xuICAgICAgICB0aGlzLm92ZXJsYXkuYWRkVG9ET00oKF9hID0gb3B0aW9ucy5wYXJlbnRFbGVtZW50KSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBkb2N1bWVudC5ib2R5LCAoX2IgPSBvcHRpb25zLnVzZVNoYWRvd0RPTSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogdHJ1ZSk7XG4gICAgICAgIHRoaXMudGljaygpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gdW5kZWZpbmVkO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIHRoaXMuaGFuZGxlTW91c2VNb3ZlLCB0cnVlKTtcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuaGFuZGxlQ2xpY2ssIHRydWUpO1xuICAgICAgICB0aGlzLm92ZXJsYXkucmVtb3ZlRnJvbURPTSgpO1xuICAgICAgICB0aGlzLnRhcmdldCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5tb3VzZVggPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubW91c2VZID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAodGhpcy50aWNrUmVxKSB7XG4gICAgICAgICAgICB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy50aWNrUmVxKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB1cGRhdGVUYXJnZXQoKSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIGlmICh0aGlzLm1vdXNlWCA9PT0gdW5kZWZpbmVkIHx8IHRoaXMubW91c2VZID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBQZWVrIHRocm91Z2ggdGhlIG92ZXJsYXkgdG8gZmluZCB0aGUgbmV3IHRhcmdldFxuICAgICAgICB0aGlzLm92ZXJsYXkuaWdub3JlQ3Vyc29yKCk7XG4gICAgICAgIGNvbnN0IGVsQXRDdXJzb3IgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHRoaXMubW91c2VYLCB0aGlzLm1vdXNlWSk7XG4gICAgICAgIGNvbnN0IG5ld1RhcmdldCA9IGVsQXRDdXJzb3I7XG4gICAgICAgIHRoaXMub3ZlcmxheS5jYXB0dXJlQ3Vyc29yKCk7XG4gICAgICAgIC8vIElmIHRoZSB0YXJnZXQgaGFzbid0IGNoYW5nZWQsIHRoZXJlJ3Mgbm90aGluZyB0byBkb1xuICAgICAgICBpZiAoIW5ld1RhcmdldCB8fCBuZXdUYXJnZXQgPT09IHRoaXMudGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBhbiBlbGVtZW50IGZpbHRlciBhbmQgdGhlIG5ldyB0YXJnZXQgZG9lc24ndCBtYXRjaCxcbiAgICAgICAgLy8gY2xlYXIgb3V0IHRoZSB0YXJnZXRcbiAgICAgICAgaWYgKChfYSA9IHRoaXMub3B0aW9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmVsZW1lbnRGaWx0ZXIpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5vcHRpb25zLmVsZW1lbnRGaWx0ZXIobmV3VGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIHRoaXMub3ZlcmxheS5zZXRCb3VuZHMoeyB4OiAwLCB5OiAwLCB3aWR0aDogMCwgaGVpZ2h0OiAwIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRhcmdldCA9IG5ld1RhcmdldDtcbiAgICAgICAgY29uc3QgYm91bmRzID0gZ2V0RWxlbWVudEJvdW5kcyhuZXdUYXJnZXQpO1xuICAgICAgICB0aGlzLm92ZXJsYXkuc2V0Qm91bmRzKGJvdW5kcyk7XG4gICAgICAgIGlmICgoX2IgPSB0aGlzLm9wdGlvbnMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5vbkhvdmVyKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnMub25Ib3ZlcihuZXdUYXJnZXQpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRWxlbWVudE92ZXJsYXkge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2YsIF9nLCBfaCwgX2o7XG4gICAgICAgIHRoaXMub3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHRoaXMub3ZlcmxheS5jbGFzc05hbWUgPSBvcHRpb25zLmNsYXNzTmFtZSB8fCBcIl9leHQtZWxlbWVudC1vdmVybGF5XCI7XG4gICAgICAgIHRoaXMub3ZlcmxheS5zdHlsZS5iYWNrZ3JvdW5kID0gKChfYSA9IG9wdGlvbnMuc3R5bGUpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5iYWNrZ3JvdW5kKSB8fCBcInJnYmEoMjUwLCAyNDAsIDIwMiwgMC4yKVwiO1xuICAgICAgICB0aGlzLm92ZXJsYXkuc3R5bGUuYm9yZGVyQ29sb3IgPSAoKF9iID0gb3B0aW9ucy5zdHlsZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmJvcmRlckNvbG9yKSB8fCBcIiNGOTU3MzhcIjtcbiAgICAgICAgdGhpcy5vdmVybGF5LnN0eWxlLmJvcmRlclN0eWxlID0gKChfYyA9IG9wdGlvbnMuc3R5bGUpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5ib3JkZXJTdHlsZSkgfHwgXCJzb2xpZFwiO1xuICAgICAgICB0aGlzLm92ZXJsYXkuc3R5bGUuYm9yZGVyUmFkaXVzID0gKChfZCA9IG9wdGlvbnMuc3R5bGUpID09PSBudWxsIHx8IF9kID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZC5ib3JkZXJSYWRpdXMpIHx8IFwiMXB4XCI7XG4gICAgICAgIHRoaXMub3ZlcmxheS5zdHlsZS5ib3JkZXJXaWR0aCA9ICgoX2UgPSBvcHRpb25zLnN0eWxlKSA9PT0gbnVsbCB8fCBfZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2UuYm9yZGVyV2lkdGgpIHx8IFwiMXB4XCI7XG4gICAgICAgIHRoaXMub3ZlcmxheS5zdHlsZS5ib3hTaXppbmcgPSAoKF9mID0gb3B0aW9ucy5zdHlsZSkgPT09IG51bGwgfHwgX2YgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9mLmJveFNpemluZykgfHwgXCJib3JkZXItYm94XCI7XG4gICAgICAgIHRoaXMub3ZlcmxheS5zdHlsZS5jdXJzb3IgPSAoKF9nID0gb3B0aW9ucy5zdHlsZSkgPT09IG51bGwgfHwgX2cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9nLmN1cnNvcikgfHwgXCJjcm9zc2hhaXJcIjtcbiAgICAgICAgdGhpcy5vdmVybGF5LnN0eWxlLnBvc2l0aW9uID0gKChfaCA9IG9wdGlvbnMuc3R5bGUpID09PSBudWxsIHx8IF9oID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaC5wb3NpdGlvbikgfHwgXCJhYnNvbHV0ZVwiO1xuICAgICAgICB0aGlzLm92ZXJsYXkuc3R5bGUuekluZGV4ID0gKChfaiA9IG9wdGlvbnMuc3R5bGUpID09PSBudWxsIHx8IF9qID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfai56SW5kZXgpIHx8IFwiMjE0NzQ4MzY0N1wiO1xuICAgICAgICB0aGlzLnNoYWRvd0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHRoaXMuc2hhZG93Q29udGFpbmVyLmNsYXNzTmFtZSA9IFwiX2V4dC1lbGVtZW50LW92ZXJsYXktY29udGFpbmVyXCI7XG4gICAgICAgIHRoaXMuc2hhZG93Q29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuICAgICAgICB0aGlzLnNoYWRvd0NvbnRhaW5lci5zdHlsZS50b3AgPSBcIjBweFwiO1xuICAgICAgICB0aGlzLnNoYWRvd0NvbnRhaW5lci5zdHlsZS5sZWZ0ID0gXCIwcHhcIjtcbiAgICAgICAgdGhpcy5zaGFkb3dSb290ID0gdGhpcy5zaGFkb3dDb250YWluZXIuYXR0YWNoU2hhZG93KHsgbW9kZTogXCJvcGVuXCIgfSk7XG4gICAgfVxuICAgIGFkZFRvRE9NKHBhcmVudCwgdXNlU2hhZG93RE9NKSB7XG4gICAgICAgIHRoaXMudXNpbmdTaGFkb3dET00gPSB1c2VTaGFkb3dET007XG4gICAgICAgIGlmICh1c2VTaGFkb3dET00pIHtcbiAgICAgICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUodGhpcy5zaGFkb3dDb250YWluZXIsIHBhcmVudC5maXJzdENoaWxkKTtcbiAgICAgICAgICAgIHRoaXMuc2hhZG93Um9vdC5hcHBlbmRDaGlsZCh0aGlzLm92ZXJsYXkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKHRoaXMub3ZlcmxheSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVtb3ZlRnJvbURPTSgpIHtcbiAgICAgICAgdGhpcy5zZXRCb3VuZHMoeyB4OiAwLCB5OiAwLCB3aWR0aDogMCwgaGVpZ2h0OiAwIH0pO1xuICAgICAgICB0aGlzLm92ZXJsYXkucmVtb3ZlKCk7XG4gICAgICAgIGlmICh0aGlzLnVzaW5nU2hhZG93RE9NKSB7XG4gICAgICAgICAgICB0aGlzLnNoYWRvd0NvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXB0dXJlQ3Vyc29yKCkge1xuICAgICAgICB0aGlzLm92ZXJsYXkuc3R5bGUucG9pbnRlckV2ZW50cyA9IFwiYXV0b1wiO1xuICAgIH1cbiAgICBpZ25vcmVDdXJzb3IoKSB7XG4gICAgICAgIHRoaXMub3ZlcmxheS5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7XG4gICAgfVxuICAgIHNldEJvdW5kcyh7IHgsIHksIHdpZHRoLCBoZWlnaHQgfSkge1xuICAgICAgICB0aGlzLm92ZXJsYXkuc3R5bGUubGVmdCA9IHggKyBcInB4XCI7XG4gICAgICAgIHRoaXMub3ZlcmxheS5zdHlsZS50b3AgPSB5ICsgXCJweFwiO1xuICAgICAgICB0aGlzLm92ZXJsYXkuc3R5bGUud2lkdGggPSB3aWR0aCArIFwicHhcIjtcbiAgICAgICAgdGhpcy5vdmVybGF5LnN0eWxlLmhlaWdodCA9IGhlaWdodCArIFwicHhcIjtcbiAgICB9XG59XG4iLCI7XG5leHBvcnQgY29uc3QgZ2V0RWxlbWVudEJvdW5kcyA9IChlbCkgPT4ge1xuICAgIGNvbnN0IHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICByZXR1cm4ge1xuICAgICAgICB4OiB3aW5kb3cucGFnZVhPZmZzZXQgKyByZWN0LmxlZnQsXG4gICAgICAgIHk6IHdpbmRvdy5wYWdlWU9mZnNldCArIHJlY3QudG9wLFxuICAgICAgICB3aWR0aDogZWwub2Zmc2V0V2lkdGgsXG4gICAgICAgIGhlaWdodDogZWwub2Zmc2V0SGVpZ2h0LFxuICAgIH07XG59O1xuIiwiaW1wb3J0IHtcclxuICAgIE9wdGlvbnMsXHJcbiAgICBQYXJzZWRFdmVudCxcclxuICAgIEV2ZW50VHlwZSxcclxuICAgIFRhZ3MsXHJcbiAgICBDb21tYW5kLFxyXG4gICAgQ29tbWFuZFR5cGUsXHJcbiAgICBLZXlkb3duVHlwZSxcclxufSBmcm9tIFwiLi90eXBlc1wiO1xyXG5pbXBvcnQge1xyXG4gICAgZ2V0SWQsXHJcbiAgICBjc3Nlc2MsXHJcbiAgICBpc0luQWN0aXZlRG9jLFxyXG4gICAgdXBUb0lkLFxyXG4gICAgdXBUb0N0cmxXaXRoSWQsXHJcbiAgICBkZWxheSxcclxuICAgIGFjdGl2ZURvYyxcclxuICAgIGlzVGFnLFxyXG4gICAgdXAsXHJcbn0gZnJvbSBcIi4vdVwiO1xyXG5pbXBvcnQgeyBtYXRjaCB9IGZyb20gXCIuL21hdGNoZXJcIjtcclxuaW1wb3J0IHtcclxuICAgIEJvZHlFZGl0Q29tcG9uZW50LFxyXG4gICAgRGlhbG9nQ29tcG9uZW50LFxyXG4gICAgRG9ja2VyQ29tcG9uZW50LFxyXG4gICAgRHluYW1pY0NoZWNrYm94Q29tcG9uZW50LFxyXG4gICAgR2VuZXJpY0NvbW1hbmRDb21wb25lbnQsXHJcbiAgICBJdGVtU291cmNlQ29tcG9uZW50LFxyXG4gICAgS2VuZG9HcmlkQ29tcG9uZW50LFxyXG4gICAgS2VuZG9UcmVlTGlzdENvbXBvbmVudCxcclxuICAgIEtlbmRvVXBsb2FkQ29tcG9uZW50LFxyXG4gICAgUGFuZWxDb21wb25lbnQsXHJcbiAgICBSYWRhckNvbXBvbmVudCxcclxuICAgIFdpbmRvd0NvbXBvbmVudCxcclxufSBmcm9tIFwiLi9jYXB0b3JzXCI7XHJcblxyXG5jb25zdCBjYXB0dXJpbmdDb250cm9scyA9IFtcclxuICAgIFwidGItZGF0ZS1lZGl0XCIsXHJcbiAgICBcInRiLWFwcGxpY2F0aW9uLWRhdGVcIixcclxuICAgIFwidGItZW51bS1jb21ib1wiLFxyXG4gICAgXCJrZW5kby1kcm9wZG93bmxpc3RcIixcclxuICAgIFwia2VuZG8tY29tYm9ib3hcIixcclxuICAgIFwia2VuZG8tbXVsdGljb2x1bW5jb21ib2JveFwiLFxyXG4gICAgXCJrZW5kby1tdWx0aXNlbGVjdFwiXHJcbl0gYXMgY29uc3Q7IC8vIFRTIDMuNFxyXG50eXBlIENhcHR1cmluZ0NvbnRyb2xzID0gdHlwZW9mIGNhcHR1cmluZ0NvbnRyb2xzW251bWJlcl07XHJcblxyXG5jb25zdCBjdHJsID0ge1xyXG4gICAgbmVlZHNDYXB0dXJlOiAoZWw6IEVsZW1lbnQpID0+IGlzVGFnKGVsLCAuLi5jYXB0dXJpbmdDb250cm9scyksXHJcblxyXG4gICAgY2FwdHVyZWRWYWx1ZTogKGNhcHR1cmVkQnkpID0+XHJcbiAgICAgICAgbWF0Y2g8Q2FwdHVyaW5nQ29udHJvbHMsICgpID0+IHN0cmluZz4oe1xyXG4gICAgICAgICAgICBcInRiLWVudW0tY29tYm9cIjogKCkgPT4gR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuZ2V0VmFsdWUoY2FwdHVyZWRCeSwgJ1tzZWxlY3RlZC1jb2RlXScsICdzZWxlY3RlZC1jb2RlJyksXHJcbiAgICAgICAgICAgIFwia2VuZG8tZHJvcGRvd25saXN0XCI6ICgpID0+IEdlbmVyaWNDb21tYW5kQ29tcG9uZW50LmdldFZhbHVlKGNhcHR1cmVkQnksIHVuZGVmaW5lZCwgJ3NlbGVjdGVkLWNvZGUnKSxcclxuICAgICAgICAgICAgXCJrZW5kby1tdWx0aXNlbGVjdFwiOiAoKSA9PiBHZW5lcmljQ29tbWFuZENvbXBvbmVudC5nZXRWYWx1ZShjYXB0dXJlZEJ5LCB1bmRlZmluZWQsICdzZWxlY3RlZC1jb2RlJyksXHJcbiAgICAgICAgICAgIFwia2VuZG8tY29tYm9ib3hcIjogKCkgPT4gR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuZ2V0VmFsdWUoY2FwdHVyZWRCeSwgdW5kZWZpbmVkLCAnc2VsZWN0ZWQtY29kZScpLFxyXG4gICAgICAgICAgICBcImtlbmRvLW11bHRpY29sdW1uY29tYm9ib3hcIjogKCkgPT4gR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuZ2V0VmFsdWUoY2FwdHVyZWRCeSwgdW5kZWZpbmVkLCAnc2VsZWN0ZWQtY29kZScpLFxyXG4gICAgICAgICAgICBcInRiLWRhdGUtZWRpdFwiOiAoKSA9PiBHZW5lcmljQ29tbWFuZENvbXBvbmVudC5nZXRWYWx1ZShjYXB0dXJlZEJ5LCAndGV4dGFyZWEsIGlucHV0JywgJ3NlbGVjdGVkLWRhdGUnKSxcclxuICAgICAgICAgICAgXCJ0Yi1hcHBsaWNhdGlvbi1kYXRlXCI6ICgpID0+IEdlbmVyaWNDb21tYW5kQ29tcG9uZW50LmdldFZhbHVlKGNhcHR1cmVkQnksICd0ZXh0YXJlYSwgaW5wdXQnLCAnc2VsZWN0ZWQtZGF0ZScpLFxyXG4gICAgICAgICAgICBfOiAoKSA9PiAoY2FwdHVyZWRCeS5xdWVyeVNlbGVjdG9yKFwidGV4dGFyZWEsIGlucHV0XCIpIGFzIGFueSk/LnZhbHVlLFxyXG4gICAgICAgIH0pKGNhcHR1cmVkQnkudGFnTmFtZS50b0xvd2VyQ2FzZSgpKSgpLFxyXG5cclxufTtcclxuXHJcbmNvbnN0IGhhbmRsZUNhcHR1cmluZ0NvbnRyb2xzID0gKCgpID0+IHsgLy9jYXB0dXJpbmcgb25WYWx1ZUNoYW5nZVxyXG4gICAgbGV0IGNhcHR1cmVkQnk6IEVsZW1lbnQgPSBudWxsO1xyXG4gICAgbGV0IG9sZFZhbHVlID0gXCJcIjtcclxuXHJcbiAgICByZXR1cm4gYXN5bmMgKFxyXG4gICAgICAgIHRhcmdldDogRWxlbWVudCxcclxuICAgICAgICBwYXJzZWRFdmVudDogUGFyc2VkRXZlbnRcclxuICAgICk6IFByb21pc2U8W3JlczogQ29tbWFuZFtdLCBjYXB0dXJlZEJ5OiBFbGVtZW50XT4gPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdoYW5kbGVDYXB0dXJpbmdDb250cm9scyBjYXB0dXJlZEJ5JywgY2FwdHVyZWRCeT8udGFnTmFtZSk7XHJcbiAgICAgICAgbGV0IHZ2ID0gY3RybDtcclxuICAgICAgICBjb25zdCBjYXB0dXJlID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBvbGRWYWx1ZSA9IFwiXCI7XHJcbiAgICAgICAgICAgIGNhcHR1cmVkQnkgPSBjdHJsLm5lZWRzQ2FwdHVyZSh0bXApID8gdG1wIDogbnVsbDtcclxuICAgICAgICAgICAgb2xkVmFsdWUgPSBjYXB0dXJlZEJ5ID8gY3RybC5jYXB0dXJlZFZhbHVlKGNhcHR1cmVkQnkpIDogXCJcIjtcclxuICAgICAgICAgICAgcmV0dXJuIGNhcHR1cmVkQnk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCB0bXAgPSB1cFRvQ3RybFdpdGhJZCh0YXJnZXQpO1xyXG5cclxuICAgICAgICBpZiAoY2FwdHVyZWRCeSA9PT0gbnVsbCkgcmV0dXJuIFtbXSwgY2FwdHVyZSgpXTtcclxuICAgICAgICBpZiAoY2FwdHVyZWRCeSAmJiB1cChcImNkay12aXJ0dWFsLXNjcm9sbC12aWV3cG9ydCwga2VuZG8tY2FsZW5kYXIsIGtlbmRvLWxpc3RcIikodGFyZ2V0KSkgLy9jbGljayBkZW50cm8gaWwgcG9wdXAgZGkgaGVscGVyXHJcbiAgICAgICAgICAgIHJldHVybiBbW10sIGNhcHR1cmVkQnldO1xyXG5cclxuICAgICAgICBjb25zdCBvdXRzaWRlT2ZBY3RpdmVDdHJsID0gdG1wID09PSBudWxsICYmIGNhcHR1cmVkQnkgIT09IG51bGwgJiYgIWNhcHR1cmVkQnkuY29udGFpbnModGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBhY3RpdmVDdHJsQ2hhbmdlZCA9IG91dHNpZGVPZkFjdGl2ZUN0cmwgfHwgdG1wICE9PSBjYXB0dXJlZEJ5IHx8IChwYXJzZWRFdmVudC5hY3Rpb24gPT09IEV2ZW50VHlwZS5LRVlET1dOICYmIHBhcnNlZEV2ZW50LmtleSA9PT0gXCJUYWJcIik7XHJcbiAgICAgICAgaWYgKCFhY3RpdmVDdHJsQ2hhbmdlZCkgcmV0dXJuIFtbXSwgY2FwdHVyZWRCeV07XHJcblxyXG4gICAgICAgIC8vYXdhaXQgZGVsYXkoMTAwKTtcclxuICAgICAgICBjb25zdCB2YWx1ZSA9IGN0cmwuY2FwdHVyZWRWYWx1ZShjYXB0dXJlZEJ5KTtcclxuICAgICAgICBjb25zb2xlLmxvZygnaGFuZGxlQ2FwdHVyaW5nQ29udHJvbHMgY29udHJvbCB2YWx1ZScsIHZhbHVlLCBvbGRWYWx1ZSwgY2FwdHVyZWRCeT8udGFnTmFtZSk7XHJcblxyXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gb2xkVmFsdWUpIHJldHVybiBbW10sIGNhcHR1cmUoKV07XHJcblxyXG4gICAgICAgIGlmIChHZW5lcmljQ29tbWFuZENvbXBvbmVudC5pc0NvbXBvbmVudChjYXB0dXJlZEJ5LCBcInRiLWVudW0tY29tYm9cIikpXHJcbiAgICAgICAgICAgIHJldHVybiBbW0dlbmVyaWNDb21tYW5kQ29tcG9uZW50LmNhcHR1cmUoY2FwdHVyZWRCeSwgcGFyc2VkRXZlbnQsICdFbnVtQ29tYm8nLCAnc2VsZWN0JywgJ1tzZWxlY3RlZC1jb2RlXScsICdzZWxlY3RlZC1jb2RlJyldLCBjYXB0dXJlKCldXHJcblxyXG4gICAgICAgIGlmIChHZW5lcmljQ29tbWFuZENvbXBvbmVudC5pc0NvbXBvbmVudChjYXB0dXJlZEJ5LCBcImtlbmRvLWRyb3Bkb3dubGlzdFwiKSlcclxuICAgICAgICAgICAgcmV0dXJuIFtbR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuY2FwdHVyZShjYXB0dXJlZEJ5LCBwYXJzZWRFdmVudCwgJ0tlbmRvRHJvcGRvd25saXN0JywgJ3NlbGVjdCcsIHVuZGVmaW5lZCwgJ3NlbGVjdGVkLWNvZGUnKV0sIGNhcHR1cmUoKV1cclxuICAgICAgICBpZiAoR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuaXNDb21wb25lbnQoY2FwdHVyZWRCeSwgXCJrZW5kby1tdWx0aXNlbGVjdFwiKSlcclxuICAgICAgICAgICAgcmV0dXJuIFtbR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuY2FwdHVyZShjYXB0dXJlZEJ5LCBwYXJzZWRFdmVudCwgJ0tlbmRvRHJvcGRvd25saXN0JywgJ3NlbGVjdCcsIHVuZGVmaW5lZCwgJ3NlbGVjdGVkLWNvZGUnKV0sIGNhcHR1cmUoKV1cclxuICAgICAgICBpZiAoR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuaXNDb21wb25lbnQoY2FwdHVyZWRCeSwgXCJrZW5kby1jb21ib2JveFwiKSlcclxuICAgICAgICAgICAgcmV0dXJuIFtbR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuY2FwdHVyZShjYXB0dXJlZEJ5LCBwYXJzZWRFdmVudCwgJ0tlbmRvRHJvcGRvd25saXN0JywgJ3NlbGVjdCcsIHVuZGVmaW5lZCwgJ3NlbGVjdGVkLWNvZGUnKV0sIGNhcHR1cmUoKV1cclxuICAgICAgICBpZiAoR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuaXNDb21wb25lbnQoY2FwdHVyZWRCeSwgXCJrZW5kby1tdWx0aWNvbHVtbmNvbWJvYm94XCIpKVxyXG4gICAgICAgICAgICByZXR1cm4gW1tHZW5lcmljQ29tbWFuZENvbXBvbmVudC5jYXB0dXJlKGNhcHR1cmVkQnksIHBhcnNlZEV2ZW50LCAnS2VuZG9Ecm9wZG93bmxpc3QnLCAnc2VsZWN0JywgdW5kZWZpbmVkLCAnc2VsZWN0ZWQtY29kZScpXSwgY2FwdHVyZSgpXVxyXG5cclxuICAgICAgICBpZiAoR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuaXNDb21wb25lbnQoY2FwdHVyZWRCeSwgXCJ0Yi1kYXRlLWVkaXRcIikpXHJcbiAgICAgICAgICAgIHJldHVybiBbW0dlbmVyaWNDb21tYW5kQ29tcG9uZW50LmNhcHR1cmUoY2FwdHVyZWRCeSwgcGFyc2VkRXZlbnQsIHVuZGVmaW5lZCwgJ3dyaXRlJywgJ3RleHRhcmVhLCBpbnB1dCcsICdzZWxlY3RlZC1kYXRlJyldLCBjYXB0dXJlKCldXHJcbiAgICAgICAgaWYgKEdlbmVyaWNDb21tYW5kQ29tcG9uZW50LmlzQ29tcG9uZW50KGNhcHR1cmVkQnksIFwidGItYXBwbGljYXRpb24tZGF0ZVwiKSlcclxuICAgICAgICAgICAgcmV0dXJuIFtbR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuY2FwdHVyZShjYXB0dXJlZEJ5LCBwYXJzZWRFdmVudCwgdW5kZWZpbmVkLCAnd3JpdGUnLCAndGV4dGFyZWEsIGlucHV0JywgJ3NlbGVjdGVkLWRhdGUnKV0sIGNhcHR1cmUoKV1cclxuXHJcbiAgICAgICAgcmV0dXJuIFtbXSwgY2FwdHVyZSgpXTtcclxuICAgIH07XHJcbn0pKCk7XHJcblxyXG5jb25zdCB0b29wdCA9IChzZWxlY3Rvcjogc3RyaW5nLCBlbD86IEVsZW1lbnQsIG9wdGlvbnM/OiBPcHRpb25zLCBwYXJzZWRFdmVudD86IFBhcnNlZEV2ZW50KTogT3B0aW9ucyA9PiB7XHJcbiAgICBvcHRpb25zID0gb3B0aW9ucyA/PyB7fTtcclxuICAgIGlmIChwYXJzZWRFdmVudD8udmFsdWUgIT09IG51bGwgJiYgcGFyc2VkRXZlbnQ/LnZhbHVlICE9PSB1bmRlZmluZWQgJiYgcGFyc2VkRXZlbnQ/LnZhbHVlLmxlbmd0aCA+PSAwICYmICFvcHRpb25zLmV2ZW50VmFsdWUpIG9wdGlvbnMuZXZlbnRWYWx1ZSA9IHBhcnNlZEV2ZW50Py52YWx1ZS50b1N0cmluZygpLnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKTtcclxuICAgIGlmIChwYXJzZWRFdmVudD8ua2V5ICYmICFvcHRpb25zLmV2ZW50S2V5KSBvcHRpb25zLmV2ZW50S2V5ID0gcGFyc2VkRXZlbnQ/LmtleS50b1N0cmluZygpLnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKTtcclxuICAgIGlmIChwYXJzZWRFdmVudD8ubW9kaWZpZXJzPy5sZW5ndGggPiAwKSBvcHRpb25zLmtleWJvYXJkTW9kaWZpZXIgPSBwYXJzZWRFdmVudC5tb2RpZmllcnM7XHJcbiAgICBpZiAocGFyc2VkRXZlbnQ/LnBhZ2VJbmRleCAhPT0gdW5kZWZpbmVkKSBvcHRpb25zLnBhZ2VJbmRleCA9IHBhcnNlZEV2ZW50LnBhZ2VJbmRleDtcclxuICAgIG9wdGlvbnMuZm9yY2UgPSAhIShlbD8uaGFzQXR0cmlidXRlKFwiZGlzYWJsZWRcIikgfHwgZWw/LmdldEF0dHJpYnV0ZShcImRpc2FibGVkXCIpKTtcclxuICAgIG9wdGlvbnMucmV0cnkgPSBmYWxzZTtcclxuICAgIGlmICghb3B0aW9ucz8uc2NvcGUgJiYgIWlzSW5BY3RpdmVEb2MoZWwpKSB7XHJcbiAgICAgICAgcmV0dXJuIHsgLi4ub3B0aW9ucywgc2NvcGU6IFwiYWxsXCIgfTtcclxuICAgIH1cclxuICAgIGlmIChvcHRpb25zKSByZXR1cm4gb3B0aW9ucztcclxuICAgIHJldHVybiB7fTtcclxufTtcclxuXHJcbi8vZXhwb3J0IHR5cGUgQ29tbWFuZFJlc3VsdCA9IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZDtcclxuXHJcbmV4cG9ydCBjb25zdCB0b2NtZCA9XHJcbiAgICAoY21kOiBDb21tYW5kVHlwZSwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KSA9PlxyXG4gICAgICAgIChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucyk6IENvbW1hbmQgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgVHlwZTogY21kLFxyXG4gICAgICAgICAgICAgICAgU2VsZWN0b3I6IGNzc2VzYyhzZWxlY3RvcikgKyBnZXRUYWdOYW1lKHRhcmdldCksXHJcbiAgICAgICAgICAgICAgICBPcHRpb25zOiB0b29wdChzZWxlY3RvciwgdGFyZ2V0LCBvcHRpb25zLCBwYXJzZWRFdmVudCksXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfTtcclxuXHJcbi8vIGV4cG9ydCBjb25zdCBjbWQgPSB7XHJcbi8vICAgd3JpdGU6IHRvY21kKFwid3JpdGVcIiksXHJcbi8vICAgc2VsZWN0OiB0b2NtZChcInNlbGVjdFwiKSxcclxuLy8gICBjbGljazogdG9jbWQoXCJjbGlja1wiKSxcclxuLy8gICBrZXlkb3duOiB0b2NtZChcImtleWRvd25cIiksXHJcbi8vICAgcGljazogdG9jbWQoXCJwaWNrXCIpLFxyXG4vLyB9O1xyXG5cclxubGV0IHBlbmRpbmdEcmFnOiBEcmFnRXZlbnQgPSB1bmRlZmluZWQ7XHJcbmxldCBza2lwRmluZCA9IGZhbHNlO1xyXG5cclxuZnVuY3Rpb24gZ2V0VGFnTmFtZSh0YXJnZXQ6IGFueSk6IHN0cmluZyB7XHJcbiAgICBpZiAodGFyZ2V0LmF0dHJpYnV0ZXNbJ2RhdGEtdGVzdCddIHx8IHRhcmdldC5hdHRyaWJ1dGVzWydkYXRhLWN5J10gfHwgdGFyZ2V0LmF0dHJpYnV0ZXNbJ2NtcElkJ10pXHJcbiAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgdmFyIGVsZW1lbnQgPSB1cFRvQ3RybFdpdGhJZCh0YXJnZXQpO1xyXG4gICAgaWYgKCFlbGVtZW50KSByZXR1cm4gJyc7XHJcbiAgICBpZiAoZWxlbWVudC50YWdOYW1lLnN0YXJ0c1dpdGgoJ1RCLScpKSB7XHJcbiAgICAgICAgdmFyIGUgPSB0YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIGlmIChbJ2lucHV0JywgJ3NlbGVjdCcsICd0ZXh0YXJlYSddLmluY2x1ZGVzKGUpKSByZXR1cm4gJyAnICsgZTtcclxuICAgICAgICBlbHNlIGlmIChnZXRJZCh0YXJnZXQuY2xvc2VzdChcImJ1dHRvblwiKSkgPT0gbnVsbCAmJiBlbGVtZW50LmNvbnRhaW5zKHRhcmdldC5jbG9zZXN0KFwiYnV0dG9uXCIpKSkgcmV0dXJuICcgYnV0dG9uJztcclxuICAgIH1cclxuICAgIHJldHVybiAnJztcclxufVxyXG5cclxuZnVuY3Rpb24gZXZhbHVhdGVQb3N0V2FpdENvbW1hbmQodGFyZ2V0OiBhbnksIHJlczogQXJyYXk8YW55PiwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KTogYW55IHtcclxuICAgIGlmIChwYXJzZWRFdmVudD8ubW9kaWZpZXJzPy5pbmNsdWRlcyhcIkNvbnRyb2xcIikpIC8vYXR0ZXNhIHBlciBhcGVydHVyYSBpbiBudW92byB0YWJcclxuICAgICAgICByZXR1cm4gdG9jbWQoXCJ3YWl0XCIsIHBhcnNlZEV2ZW50KSgnJywgdGFyZ2V0LCB7IHZhbHVlOiAnNTAwMCcgfSk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuZnVuY3Rpb24gZXZhbHVhdGVQcmVXYWl0Q29tbWFuZCh0YXJnZXQ6IGFueSwgcmVzOiBBcnJheTxhbnk+LCBwYXJzZWRFdmVudDogUGFyc2VkRXZlbnQpOiBhbnkge1xyXG4gICAgcmV0dXJuIHJlczsvLyBkaXNhYmlsaXRhdG8gcGVyIGlsIG1vbWVudG9cclxuICAgIHZhciBzZWxlY3RvcnMgPSBbJ3RhYmJlckNsb3NlRWxlbWVudCcsICdJRF9FWFRET0NfRVhJVCcsICd0YWJiZXJEaWFsb2dDbG9zZUVsZW1lbnQnXTtcclxuICAgIGxldCBlbGVtZW50ID0gdGFyZ2V0O1xyXG4gICAgdmFyIGF0dHIgPSB0YXJnZXQuYXR0cmlidXRlc1snZGF0YS10ZXN0J10gfHwgdGFyZ2V0LmF0dHJpYnV0ZXNbJ2RhdGEtY3knXSB8fCB0YXJnZXQuYXR0cmlidXRlc1snY21wSWQnXTtcclxuICAgIGlmICghYXR0cikge1xyXG4gICAgICAgIGVsZW1lbnQgPSB1cFRvSWQodGFyZ2V0KTtcclxuICAgICAgICBpZiAoIWVsZW1lbnQpIHJldHVybiByZXM7XHJcbiAgICAgICAgYXR0ciA9IGVsZW1lbnQuYXR0cmlidXRlc1snZGF0YS10ZXN0J10gfHwgZWxlbWVudC5hdHRyaWJ1dGVzWydkYXRhLWN5J10gfHwgZWxlbWVudC5hdHRyaWJ1dGVzWydjbXBJZCddO1xyXG4gICAgfVxyXG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHNlbGVjdG9ycy5sZW5ndGg7IGluZGV4KyspIHtcclxuICAgICAgICBjb25zdCBlbCA9IHNlbGVjdG9yc1tpbmRleF07XHJcbiAgICAgICAgaWYgKChhdHRyLnZhbHVlIGFzIHN0cmluZykuaW5kZXhPZihlbCkgPiAtMSlcclxuICAgICAgICAgICAgcmV0dXJuIFsuLi5yZXMsIHRvY21kKFwid2FpdFwiLCBwYXJzZWRFdmVudCkoJycsIHRhcmdldCwgeyB2YWx1ZTogJzUwMDAnIH0pXTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXM7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYXB0dXJlRXZlbnRBdHRyaWJ1dGVzKFxyXG4gICAgdGFyZ2V0OiBhbnksXHJcbiAgICBjb21tYW5kOiAoc2VsZWN0b3I6IHN0cmluZywgdGFyZ2V0PzogRWxlbWVudCwgb3B0aW9ucz86IE9wdGlvbnMpID0+IENvbW1hbmQsXHJcbiAgICBwYXJzZWRFdmVudDogUGFyc2VkRXZlbnQgPSB1bmRlZmluZWQsXHJcbiAgICByZXM6IGFueSA9IFtdLFxyXG4gICAgcGlja2VyID0gZmFsc2VcclxuKTogUHJvbWlzZTxDb21tYW5kW10+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIGZpcnN0Q2xvc2VzdElkID0gdXBUb0lkKHRhcmdldCk7XHJcbiAgICAgICAgLy9pZiAoZmlyc3RDbG9zZXN0SWQ/Lmhhc0F0dHJpYnV0ZShcImRpc2FibGVkXCIpKSByZXR1cm4gcmVzOyAvL2h5cGVybGluayBvcmEgbG8gcmVnaXN0cm9cclxuICAgICAgICBpZiAodXAoXCJ0Yi1jaGVja2JveFwiKSh0YXJnZXQpICYmICF0YXJnZXQubWF0Y2hlcyhgaW5wdXRbdHlwZT0nY2hlY2tib3gnXWApKSByZXR1cm4gcmVzO1xyXG5cclxuICAgICAgICByZXMgPSBldmFsdWF0ZVByZVdhaXRDb21tYW5kKHRhcmdldCwgcmVzLCBwYXJzZWRFdmVudCk7XHJcblxyXG4gICAgICAgIGxldCBjb20gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgbGV0IGRvY2tQYW5lY0NvbSA9IHVuZGVmaW5lZDtcclxuXHJcbiAgICAgICAgaWYgKCFEb2NrZXJDb21wb25lbnQuaXNEZXNpZ25TdGF0ZSh0YXJnZXQpICYmIERvY2tlckNvbXBvbmVudC5pc0NvbXBvbmVudCh0YXJnZXQpICYmICFjb20gJiYgcGlja2VyID09PSBmYWxzZSlcclxuICAgICAgICAgICAgZG9ja1BhbmVjQ29tID0gRG9ja2VyQ29tcG9uZW50LmNhcHR1cmUodGFyZ2V0LCBjb21tYW5kLCBwYXJzZWRFdmVudCk7XHJcblxyXG4gICAgICAgIGlmIChJdGVtU291cmNlQ29tcG9uZW50LmlzQ29tcG9uZW50KHRhcmdldCkpXHJcbiAgICAgICAgICAgIGNvbSA9IGF3YWl0IEl0ZW1Tb3VyY2VDb21wb25lbnQuY2FwdHVyZSh0YXJnZXQsIHBhcnNlZEV2ZW50LCBwaWNrZXIpO1xyXG4gICAgICAgIGlmIChLZW5kb1VwbG9hZENvbXBvbmVudC5pc0NvbXBvbmVudCh0YXJnZXQpICYmICFjb20pXHJcbiAgICAgICAgICAgIGNvbSA9IEtlbmRvVXBsb2FkQ29tcG9uZW50LmNhcHR1cmUodGFyZ2V0LCBjb21tYW5kLCBwYXJzZWRFdmVudCk7XHJcbiAgICAgICAgaWYgKFJhZGFyQ29tcG9uZW50LmlzQ29tcG9uZW50KHRhcmdldCkgJiYgIWNvbSlcclxuICAgICAgICAgICAgY29tID0gUmFkYXJDb21wb25lbnQuY2FwdHVyZSh0YXJnZXQsIGNvbW1hbmQsIHBhcnNlZEV2ZW50KTtcclxuICAgICAgICBpZiAoKEtlbmRvR3JpZENvbXBvbmVudC5pc0NvbXBvbmVudCh0YXJnZXQpIHx8IEJvZHlFZGl0Q29tcG9uZW50LmlzQ29tcG9uZW50KHRhcmdldCkpICYmICFjb20pIHtcclxuICAgICAgICAgICAgaWYgKEJvZHlFZGl0Q29tcG9uZW50LmlzQ29tcG9uZW50KHRhcmdldCkgJiYgIWNvbSlcclxuICAgICAgICAgICAgICAgIGNvbSA9IEJvZHlFZGl0Q29tcG9uZW50LmNhcHR1cmUodGFyZ2V0LCBjb21tYW5kLCBwYXJzZWRFdmVudCk7IC8vdGItYmVcclxuICAgICAgICAgICAgZWxzZSBjb20gPSBLZW5kb0dyaWRDb21wb25lbnQuY2FwdHVyZSh0YXJnZXQsIGNvbW1hbmQsIHBhcnNlZEV2ZW50KTsgLy9rZW5kby1ncmlkIHNlbXBsaWNlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChLZW5kb1RyZWVMaXN0Q29tcG9uZW50LmlzQ29tcG9uZW50KHRhcmdldCkgJiYgIWNvbSlcclxuICAgICAgICAgICAgY29tID0gS2VuZG9UcmVlTGlzdENvbXBvbmVudC5jYXB0dXJlKHRhcmdldCwgY29tbWFuZCwgcGFyc2VkRXZlbnQpO1xyXG4gICAgICAgIGlmIChEeW5hbWljQ2hlY2tib3hDb21wb25lbnQuaXNDb21wb25lbnQodGFyZ2V0KSAmJiAhY29tKVxyXG4gICAgICAgICAgICBjb20gPSBEeW5hbWljQ2hlY2tib3hDb21wb25lbnQuY2FwdHVyZSh0YXJnZXQsIGNvbW1hbmQsIHBhcnNlZEV2ZW50KTtcclxuICAgICAgICBpZiAoUGFuZWxDb21wb25lbnQuaXNDb21wb25lbnQodGFyZ2V0KSAmJiAhY29tKVxyXG4gICAgICAgICAgICBjb20gPSBQYW5lbENvbXBvbmVudC5jYXB0dXJlKHRhcmdldCwgY29tbWFuZCwgcGFyc2VkRXZlbnQpO1xyXG4gICAgICAgIGlmIChEaWFsb2dDb21wb25lbnQuaXNDb21wb25lbnQodGFyZ2V0KSAmJiAhY29tKVxyXG4gICAgICAgICAgICBjb20gPSBEaWFsb2dDb21wb25lbnQuY2FwdHVyZSh0YXJnZXQsIGNvbW1hbmQsIHBhcnNlZEV2ZW50KTtcclxuICAgICAgICBpZiAoV2luZG93Q29tcG9uZW50LmlzQ29tcG9uZW50KHRhcmdldCkgJiYgIWNvbSlcclxuICAgICAgICAgICAgY29tID0gV2luZG93Q29tcG9uZW50LmNhcHR1cmUodGFyZ2V0LCBjb21tYW5kLCBwYXJzZWRFdmVudCk7XHJcblxyXG4gICAgICAgIGlmIChjb20pIHJldHVybiBbLi4ucmVzLCBkb2NrUGFuZWNDb20sIGNvbV07XHJcblxyXG4gICAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgICAgICBcImdlbmVyaWMgc2VsZWN0b3IgZm9yIHRhcmdldDogXCIsXHJcbiAgICAgICAgICAgIHRhcmdldCxcclxuICAgICAgICAgICAgZmlyc3RDbG9zZXN0SWQsXHJcbiAgICAgICAgICAgIGdldElkKGZpcnN0Q2xvc2VzdElkKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGlmICghZmlyc3RDbG9zZXN0SWQgJiYgcGFyc2VkRXZlbnQuYWN0aW9uICE9PSAna2V5ZG93bicpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJmaXJzdENsb3Nlc3RJZCBub3QgZm91bmRcIik7XHJcbiAgICAgICAgICAgIHJldHVybiByZXM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAuLi5yZXMsXHJcbiAgICAgICAgICAgIGRvY2tQYW5lY0NvbSxcclxuICAgICAgICAgICAgY29tbWFuZChmaXJzdENsb3Nlc3RJZCA/IGdldElkKGZpcnN0Q2xvc2VzdElkKSA6ICdbZGF0YS10ZXN0LWFwcC1yb290XScsIHRhcmdldCwgeyBmb3JjZTogZmFsc2UgfSksXHJcbiAgICAgICAgICAgIC8vZXZhbHVhdGVQb3N0V2FpdENvbW1hbmQodGFyZ2V0LCByZXMsIHBhcnNlZEV2ZW50KVxyXG4gICAgICAgIF07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2FwdHVyZURyYWdEcm9wRXZlbnQoZnJvbUVsZW1lbnQ6IERyYWdFdmVudCwgdG9FbGVtZW50OiBEcmFnRXZlbnQsIHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCA9IHVuZGVmaW5lZCk6IFByb21pc2U8Q29tbWFuZFtdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHZhciBhbmMgPSB1cFRvSWQoZnJvbUVsZW1lbnQudGFyZ2V0IGFzIEVsZW1lbnQpO1xyXG4gICAgICAgIGNvbnN0IGZyb21JZCA9IGdldElkKGFuYyk7XHJcbiAgICAgICAgYW5jID0gdXBUb0lkKHRvRWxlbWVudC50YXJnZXQgYXMgRWxlbWVudCk7XHJcbiAgICAgICAgY29uc3QgdG9JZCA9IGdldElkKGFuYyk7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgdG9jbWQoXCJkcmFnZHJvcFwiLCBwYXJzZWRFdmVudCkodG9JZCwgdG9FbGVtZW50LnRhcmdldCBhcyBFbGVtZW50LCB7XHJcbiAgICAgICAgICAgICAgICB0YWc6IFwiRHJhZ0Ryb3BcIixcclxuICAgICAgICAgICAgICAgIGZyb21TZWxlY3RvcjogZnJvbUlkXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgXTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gW107XHJcbn1cclxuXHJcblxyXG5cclxuYXN5bmMgZnVuY3Rpb24gbWFnb2ZpbmQoXHJcbiAgICBldmVudDogRXZlbnQsXHJcbiAgICBwYXJzZWRFdmVudDogUGFyc2VkRXZlbnRcclxuKTogUHJvbWlzZTxDb21tYW5kW10+IHtcclxuICAgIGlmIChza2lwRmluZCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiW01DUl0gZmluZCBza2lwcGVkLlwiLCBldmVudCwgcGFyc2VkRXZlbnQpO1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuICAgIGxldCB0YXJnZXQgPSBldmVudC50YXJnZXQgYXMgRWxlbWVudDtcclxuXHJcbiAgICBpZiAoc2tpcChldmVudCwgcGFyc2VkRXZlbnQpKSByZXR1cm4gW107XHJcbiAgICBza2lwRmluZCA9IHRydWU7XHJcbiAgICBjb25zdCBbcmVzLCBjYXB0dXJlZEJ5XSA9IGF3YWl0IGhhbmRsZUNhcHR1cmluZ0NvbnRyb2xzKHRhcmdldCwgcGFyc2VkRXZlbnQpO1xyXG4gICAgc2tpcEZpbmQgPSBmYWxzZTtcclxuICAgIGlmIChjYXB0dXJlZEJ5ICE9PSBudWxsKSByZXR1cm4gcmVzO1xyXG5cclxuICAgIGxldCBjb21tYW5kID0gdW5kZWZpbmVkO1xyXG4gICAgc3dpdGNoIChwYXJzZWRFdmVudC5hY3Rpb24pIHtcclxuICAgICAgICBjYXNlIEV2ZW50VHlwZS5EUkFHU1RBUlQ6IHtcclxuICAgICAgICAgICAgcGVuZGluZ0RyYWcgPSBldmVudCBhcyBEcmFnRXZlbnQ7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FzZSBFdmVudFR5cGUuRFJPUDoge1xyXG4gICAgICAgICAgICBpZiAoIXBlbmRpbmdEcmFnKSByZXR1cm4gW107XHJcbiAgICAgICAgICAgIHJldHVybiBjYXB0dXJlRHJhZ0Ryb3BFdmVudChwZW5kaW5nRHJhZywgZXZlbnQgYXMgRHJhZ0V2ZW50LCBwYXJzZWRFdmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhc2UgRXZlbnRUeXBlLkNIQU5HRToge1xyXG4gICAgICAgICAgICBjb21tYW5kID0gdG9jbWQoXCJ3cml0ZVwiLCBwYXJzZWRFdmVudCk7XHJcbiAgICAgICAgICAgIHJldHVybiBjYXB0dXJlRXZlbnRBdHRyaWJ1dGVzKHRhcmdldCwgY29tbWFuZCwgcGFyc2VkRXZlbnQsIHJlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhc2UgRXZlbnRUeXBlLktFWURPV046IHtcclxuICAgICAgICAgICAgY29tbWFuZCA9IHRvY21kKFwia2V5ZG93blwiLCBwYXJzZWRFdmVudCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleVR5cGVzQWNjZXB0ZWQgPSBbS2V5ZG93blR5cGUuRVNDQVBFLCBLZXlkb3duVHlwZS5GMSwgS2V5ZG93blR5cGUuRjIsIEtleWRvd25UeXBlLkYzLCBLZXlkb3duVHlwZS5GNywgLypLZXlkb3duVHlwZS5UQUIqL107IC8vdGFiIGRhIGdlc3RpcmVcclxuICAgICAgICAgICAgaWYgKCFrZXlUeXBlc0FjY2VwdGVkLm1hcCh4ID0+IHgudG9TdHJpbmcoKSkuaW5jbHVkZXMocGFyc2VkRXZlbnQua2V5KSlcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXM7XHJcbiAgICAgICAgICAgIHJldHVybiBjYXB0dXJlRXZlbnRBdHRyaWJ1dGVzKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQsIGNvbW1hbmQsIHBhcnNlZEV2ZW50LCByZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlIEV2ZW50VHlwZS5EQkxDTElDSzpcclxuICAgICAgICAgICAgY29tbWFuZCA9IHRvY21kKFwiZGJsY2xpY2tcIiwgcGFyc2VkRXZlbnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gY2FwdHVyZUV2ZW50QXR0cmlidXRlcyh0YXJnZXQsIGNvbW1hbmQsIHBhcnNlZEV2ZW50LCByZXMpO1xyXG4gICAgICAgIGNhc2UgRXZlbnRUeXBlLkNPTlRFWFRNRU5VOlxyXG4gICAgICAgIGNhc2UgRXZlbnRUeXBlLkNMSUNLOiB7XHJcbiAgICAgICAgICAgIGNvbW1hbmQgPSB0b2NtZChcImNsaWNrXCIsIHBhcnNlZEV2ZW50KTtcclxuICAgICAgICAgICAgcmV0dXJuIGNhcHR1cmVFdmVudEF0dHJpYnV0ZXModGFyZ2V0LCBjb21tYW5kLCBwYXJzZWRFdmVudCwgcmVzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlcztcclxufVxyXG5cclxuXHJcblxyXG5jb25zdCBza2lwID0gKF86IEV2ZW50LCBwYXJzZWRFdmVudDogUGFyc2VkRXZlbnQpID0+XHJcbiAgICAocGFyc2VkRXZlbnQuYWN0aW9uID09PSBFdmVudFR5cGUuQ0hBTkdFIHx8XHJcbiAgICAgICAgcGFyc2VkRXZlbnQuYWN0aW9uID09PSBFdmVudFR5cGUuS0VZRE9XTikgJiZcclxuICAgIChwYXJzZWRFdmVudC5pbnB1dFR5cGUgPT09IFwiY2hlY2tib3hcIiB8fCBwYXJzZWRFdmVudC5pbnB1dFR5cGUgPT09IFwicmFkaW9cIik7XHJcblxyXG4vKipcclxuICogUGFyc2VzIERPTSBldmVudHMgaW50byBhbiBvYmplY3Qgd2l0aCB0aGUgbmVjZXNzYXJ5IGRhdGEuXHJcbiAqIEBwYXJhbSBldmVudFxyXG4gKiBAcmV0dXJucyB7UGFyc2VkRXZlbnRbXX1cclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIHBhcnNlRXZlbnQoZXZlbnQ6IEV2ZW50KTogUHJvbWlzZTxQYXJzZWRFdmVudFtdPiB7XHJcbiAgICAvL2NvbnNvbGUubG9nKCdwYXJzZUV2ZW50JywgZXZlbnQpO1xyXG4gICAgY29uc3QgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50ID0ge1xyXG4gICAgICAgIGFjdGlvbjogZXZlbnQudHlwZSxcclxuICAgICAgICB0YWc6IChldmVudC50YXJnZXQgYXMgRWxlbWVudCkudGFnTmFtZSxcclxuICAgICAgICB2YWx1ZTogWydjaGVja2JveCcsICdyYWRpbyddLmluY2x1ZGVzKChldmVudC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudHlwZSkgPyAoZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLmNoZWNrZWQgKyAnJyA6IChldmVudC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUsXHJcbiAgICAgICAgcGFnZUluZGV4OiB3aW5kb3dbJ19fX21jcl9fX3BhZ2VJbmRleCddICE9PSB1bmRlZmluZWQgPyB3aW5kb3dbJ19fX21jcl9fX3BhZ2VJbmRleCddIDogMFxyXG4gICAgfTtcclxuICAgIGlmICgoZXZlbnQudGFyZ2V0IGFzIEhUTUxBbmNob3JFbGVtZW50KS5oYXNBdHRyaWJ1dGUoXCJocmVmXCIpKVxyXG4gICAgICAgIHBhcnNlZEV2ZW50LmhyZWYgPSAoZXZlbnQudGFyZ2V0IGFzIEhUTUxBbmNob3JFbGVtZW50KS5ocmVmO1xyXG5cclxuICAgIGlmICgoZXZlbnQudGFyZ2V0IGFzIEVsZW1lbnQpLmhhc0F0dHJpYnV0ZShcImlkXCIpKVxyXG4gICAgICAgIHBhcnNlZEV2ZW50LmlkID0gKGV2ZW50LnRhcmdldCBhcyBFbGVtZW50KS5pZDtcclxuXHJcbiAgICBpZiAocGFyc2VkRXZlbnQudGFnID09PSBcIklOUFVUXCIpXHJcbiAgICAgICAgcGFyc2VkRXZlbnQuaW5wdXRUeXBlID0gKGV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS50eXBlO1xyXG5cclxuICAgIGlmIChldmVudC50eXBlID09PSBcImtleWRvd25cIilcclxuICAgICAgICBwYXJzZWRFdmVudC5rZXkgPSAoZXZlbnQgYXMgS2V5Ym9hcmRFdmVudCkua2V5O1xyXG5cclxuICAgIHZhciBtb2RpZmllcnMgPSBbXCJBbHRcIiwgXCJDb250cm9sXCIsIFwiTWV0YVwiLCBcIlNoaWZ0XCJdO1xyXG4gICAgcGFyc2VkRXZlbnQubW9kaWZpZXJzID0gW107XHJcbiAgICBtb2RpZmllcnMuZm9yRWFjaChtb2QgPT4ge1xyXG4gICAgICAgIGlmICgoZXZlbnQgaW5zdGFuY2VvZiBLZXlib2FyZEV2ZW50IHx8IGV2ZW50IGluc3RhbmNlb2YgUG9pbnRlckV2ZW50KSAmJiBldmVudC5nZXRNb2RpZmllclN0YXRlKG1vZCkpIHBhcnNlZEV2ZW50Lm1vZGlmaWVycy5wdXNoKG1vZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcmVzID0gYXdhaXQgbWFnb2ZpbmQoZXZlbnQsIHBhcnNlZEV2ZW50KTtcclxuICAgIHJlcyA9IHJlcy5maWx0ZXIoeCA9PiAhIXgpOyAvL3RvbGdvIGkgbnVsbGlcclxuICAgIGNvbnNvbGUubG9nKFwicmVzOiBcIiwgcmVzKTtcclxuICAgIHJldHVybiByZXMubWFwKHggPT4gKHsgLi4ueCwgRXZlbnRUeXBlOiBwYXJzZWRFdmVudC5hY3Rpb24gfSkpLm1hcCgoY29tbWFuZCkgPT4gKHsgLi4ucGFyc2VkRXZlbnQsIC4uLnsgY29tbWFuZCB9IH0pKTtcclxufVxyXG5cclxuIiwiaW1wb3J0IHsgY3NzZXNjIH0gZnJvbSAnLi9jc3Nlc2MnO1xyXG5leHBvcnQgeyBjc3Nlc2MgfTtcclxuXHJcbmV4cG9ydCBjb25zdCBpc0luQWN0aXZlRG9jID0gKGVsOiBFbGVtZW50KSA9PiAhIWFjdGl2ZURvYyhlbCk7XHJcbmV4cG9ydCBjb25zdCBhY3RpdmVEb2MgPSAoZWw6IEVsZW1lbnQpID0+XHJcbiAgdXAoYC50YWJiZXItY29udGVudD5rZW5kby10YWJzdHJpcD5bcm9sZT0ndGFicGFuZWwnXVthcmlhLWhpZGRlbj0nZmFsc2UnXWApKGVsKTtcclxuZXhwb3J0IGNvbnN0IGRlbGF5ID0gbXMgPT4gbmV3IFByb21pc2UocmVzID0+IHNldFRpbWVvdXQoKCkgPT4gcmVzKDApLCBtcykpO1xyXG5leHBvcnQgY29uc3QgZ2V0SWQgPSAoZWw/OiBFbGVtZW50KSA9PiB7XHJcbiAgbGV0IGlkO1xyXG4gIGlmICgoaWQgPSBlbD8uZ2V0QXR0cmlidXRlKCdkYXRhLXRlc3QnKSkpIHJldHVybiBgW2RhdGEtdGVzdD0nJHtpZH0nXWA7XHJcbiAgaWYgKChpZCA9IGVsPy5nZXRBdHRyaWJ1dGUoJ3BhcmVudC1kYXRhLXRlc3QnKSkpIHJldHVybiBgW3BhcmVudC1kYXRhLXRlc3Q9JyR7aWR9J11gO1xyXG4gIGlmICgoaWQgPSBlbD8uZ2V0QXR0cmlidXRlKCdjbXBpZCcpKSkgcmV0dXJuIGBbY21waWQ9JyR7aWR9J11gO1xyXG4gIGlmICgoaWQgPSBlbD8uZ2V0QXR0cmlidXRlKCdkYXRhLWN5JykpKSByZXR1cm4gYFtkYXRhLWN5PScke2lkfSddYDtcclxuICByZXR1cm4gbnVsbDtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRTZXR0aW5ncyA9IChlbD86IEVsZW1lbnQpOiB7IHJvd0luZGV4PzogYm9vbGVhbiB9ID0+IHtcclxuICAgIGxldCBzZXR0aW5ncztcclxuICAgIGlmICgoc2V0dGluZ3MgPSBlbD8uZ2V0QXR0cmlidXRlKCdkYXRhLXNldHRpbmdzJykpKSByZXR1cm4gSlNPTi5wYXJzZShzZXR0aW5ncyk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIFNlbGVjdG9yID0gKChlbDogRWxlbWVudCkgPT4gYm9vbGVhbikgfCBzdHJpbmcgfCBFbGVtZW50O1xyXG5cclxuZXhwb3J0IGNvbnN0IHVwID0gKHRvOiBTZWxlY3RvcikgPT4gKGZyb206IEVsZW1lbnQsIHN0b3BPbj86IFNlbGVjdG9yLCBjb3VudD86IG51bWJlcikgPT4ge1xyXG4gIGNvbnN0IHVwU2VsZWN0b3JUb1ByZWQgPSBzID0+XHJcbiAgICBzID8gKHR5cGVvZiBzID09PSAnb2JqZWN0JyA/IGVsID0+IGVsID09PSBzIDogdHlwZW9mIHMgPT09ICdzdHJpbmcnID8gZWwgPT4gZWwubWF0Y2hlcyhzKSA6IHMpIDogXyA9PiBmYWxzZTtcclxuICBjb25zdCB0YXJnZXRQcmVkID0gdXBTZWxlY3RvclRvUHJlZCh0byk7XHJcbiAgY29uc3QgdW50aWxQcmVkID0gdXBTZWxlY3RvclRvUHJlZChzdG9wT24pO1xyXG4gIHdoaWxlIChmcm9tICYmICF1bnRpbFByZWQoZnJvbSkgJiYgKCFjb3VudCB8fCBjb3VudCA+IDApKSB7XHJcbiAgICBpZiAodGFyZ2V0UHJlZChmcm9tKSkgcmV0dXJuIGZyb207XHJcbiAgICBpZiAodHlwZW9mIHN0b3BPbiA9PT0gJ3N0cmluZycgJiYgZnJvbS5tYXRjaGVzKHN0b3BPbikpIHJldHVybiBudWxsO1xyXG4gICAgZnJvbSA9IGZyb20ucGFyZW50RWxlbWVudDtcclxuICAgIGlmIChjb3VudCkgY291bnQtLTtcclxuICB9XHJcbiAgcmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgaXNDdHJsID0gZWwgPT4gZWwudGFnTmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJ3RiLScpIHx8IGVsLnRhZ05hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCdrZW5kby0nKTtcclxuZXhwb3J0IGNvbnN0IGhhc0lkID0gZWwgPT4gZ2V0SWQoZWwpICE9PSBudWxsO1xyXG5leHBvcnQgY29uc3QgdXBUb0N0cmwgPSB1cChpc0N0cmwpO1xyXG5leHBvcnQgY29uc3QgdXBUb0lkID0gdXAoaGFzSWQpO1xyXG5leHBvcnQgY29uc3QgdXBUb0N0cmxPcklkID0gdXAoZWwgPT4gaGFzSWQoZWwpIHx8IGlzQ3RybChlbCkpO1xyXG5leHBvcnQgY29uc3QgdXBUb0N0cmxXaXRoSWQgPSB1cChlbCA9PiBoYXNJZChlbCkgJiYgaXNDdHJsKGVsKSk7XHJcbmV4cG9ydCBjb25zdCBpc1RhZyA9IChlbD86IEVsZW1lbnQsIC4uLnRhZ3M6IHN0cmluZ1tdKSA9PiB0YWdzLnNvbWUodCA9PiBlbD8udGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSB0LnRvTG93ZXJDYXNlKCkpO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldENsYXNzZXMoaW5wdXQ6IEVsZW1lbnQsIHByZWQpOiBzdHJpbmdbXSB7XHJcbiAgY29uc3QgbmFtZXMgPSBBcnJheS5mcm9tKGlucHV0LmNsYXNzTGlzdCkuZmlsdGVyKHByZWQpO1xyXG4gIHJldHVybiBuYW1lcy5tYXAobmFtZSA9PiAnLicgKyBjc3Nlc2MobmFtZSwgeyBpc0lkZW50aWZpZXI6IHRydWUgfSkpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZXNjKGNzczogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gY3NzLnRyaW0oKTtcclxufVxyXG4iLCJjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcclxuICBlc2NhcGVFdmVyeXRoaW5nOiBmYWxzZSxcclxuICBpc0lkZW50aWZpZXI6IGZhbHNlLFxyXG4gIHF1b3RlczogJ2JhY2t0aWNrJyxcclxuICB3cmFwOiBmYWxzZSxcclxufTtcclxuY29uc3QgcmVnZXhBbnlTaW5nbGVFc2NhcGUgPSAvWyAtLFxcLlxcLzotQFxcWy1cXF5gXFx7LX5dLztcclxuY29uc3QgcmVnZXhTaW5nbGVFc2NhcGUgPSAvWyAtLFxcLlxcLzotQFxcW1xcXVxcXmBcXHstfl0vO1xyXG5jb25zdCByZWdleEV4Y2Vzc2l2ZVNwYWNlcyA9IC8oXnxcXFxcKyk/KFxcXFxbQS1GMC05XXsxLDZ9KVxceDIwKD8hW2EtZkEtRjAtOVxceDIwXSkvZztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjc3Nlc2Moc3RyaW5nOiBzdHJpbmcsIG9wdDogUGFydGlhbDx0eXBlb2YgZGVmYXVsdE9wdGlvbnM+ID0ge30pIHtcclxuICBjb25zdCBvcHRpb25zID0geyAuLi5kZWZhdWx0T3B0aW9ucywgLi4ub3B0IH07XHJcbiAgaWYgKG9wdGlvbnMucXVvdGVzICE9ICdzaW5nbGUnICYmIG9wdGlvbnMucXVvdGVzICE9ICdkb3VibGUnKSB7XHJcbiAgICBvcHRpb25zLnF1b3RlcyA9ICdiYWNrdGljayc7XHJcbiAgfVxyXG4gIGNvbnN0IHF1b3RlID0gb3B0aW9ucy5xdW90ZXMgPT0gJ2JhY2t0aWNrJyA/ICdgJyA6ICdkb3VibGUnID8gJ1wiJyA6IFwiJ1wiO1xyXG4gIGNvbnN0IGlzSWRlbnRpZmllciA9IG9wdGlvbnMuaXNJZGVudGlmaWVyO1xyXG5cclxuICBjb25zdCBmaXJzdENoYXIgPSBzdHJpbmcuY2hhckF0KDApO1xyXG4gIGxldCBvdXRwdXQgPSAnJztcclxuICBsZXQgY291bnRlciA9IDA7XHJcbiAgY29uc3QgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aDtcclxuICB3aGlsZSAoY291bnRlciA8IGxlbmd0aCkge1xyXG4gICAgY29uc3QgY2hhcmFjdGVyID0gc3RyaW5nLmNoYXJBdChjb3VudGVyKyspO1xyXG4gICAgbGV0IGNvZGVQb2ludCA9IGNoYXJhY3Rlci5jaGFyQ29kZUF0KDApO1xyXG4gICAgbGV0IHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB2b2lkIDA7XHJcbiAgICAvLyBJZiBpdOKAmXMgbm90IGEgcHJpbnRhYmxlIEFTQ0lJIGNoYXJhY3RlcuKAplxyXG4gICAgaWYgKGNvZGVQb2ludCA8IDB4MjAgfHwgY29kZVBvaW50ID4gMHg3ZSkge1xyXG4gICAgICBpZiAoY29kZVBvaW50ID49IDB4ZDgwMCAmJiBjb2RlUG9pbnQgPD0gMHhkYmZmICYmIGNvdW50ZXIgPCBsZW5ndGgpIHtcclxuICAgICAgICAvLyBJdOKAmXMgYSBoaWdoIHN1cnJvZ2F0ZSwgYW5kIHRoZXJlIGlzIGEgbmV4dCBjaGFyYWN0ZXIuXHJcbiAgICAgICAgY29uc3QgZXh0cmEgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspO1xyXG4gICAgICAgIGlmICgoZXh0cmEgJiAweGZjMDApID09IDB4ZGMwMCkge1xyXG4gICAgICAgICAgLy8gbmV4dCBjaGFyYWN0ZXIgaXMgbG93IHN1cnJvZ2F0ZVxyXG4gICAgICAgICAgY29kZVBvaW50ID0gKChjb2RlUG9pbnQgJiAweDNmZikgPDwgMTApICsgKGV4dHJhICYgMHgzZmYpICsgMHgxMDAwMDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gSXTigJlzIGFuIHVubWF0Y2hlZCBzdXJyb2dhdGU7IG9ubHkgYXBwZW5kIHRoaXMgY29kZSB1bml0LCBpbiBjYXNlXHJcbiAgICAgICAgICAvLyB0aGUgbmV4dCBjb2RlIHVuaXQgaXMgdGhlIGhpZ2ggc3Vycm9nYXRlIG9mIGEgc3Vycm9nYXRlIHBhaXIuXHJcbiAgICAgICAgICBjb3VudGVyLS07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHZhbHVlID0gJ1xcXFwnICsgY29kZVBvaW50LnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpICsgJyAnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKG9wdGlvbnMuZXNjYXBlRXZlcnl0aGluZykge1xyXG4gICAgICAgIGlmIChyZWdleEFueVNpbmdsZUVzY2FwZS50ZXN0KGNoYXJhY3RlcikpIHtcclxuICAgICAgICAgIHZhbHVlID0gJ1xcXFwnICsgY2hhcmFjdGVyO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB2YWx1ZSA9ICdcXFxcJyArIGNvZGVQb2ludC50b1N0cmluZygxNikudG9VcHBlckNhc2UoKSArICcgJztcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoL1tcXHRcXG5cXGZcXHJcXHgwQl0vLnRlc3QoY2hhcmFjdGVyKSkge1xyXG4gICAgICAgIHZhbHVlID0gJ1xcXFwnICsgY29kZVBvaW50LnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpICsgJyAnO1xyXG4gICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgIGNoYXJhY3RlciA9PSAnXFxcXCcgfHxcclxuICAgICAgICAoIWlzSWRlbnRpZmllciAmJiAoKGNoYXJhY3RlciA9PSAnXCInICYmIHF1b3RlID09IGNoYXJhY3RlcikgfHwgKGNoYXJhY3RlciA9PSBcIidcIiAmJiBxdW90ZSA9PSBjaGFyYWN0ZXIpKSkgfHxcclxuICAgICAgICAoaXNJZGVudGlmaWVyICYmIHJlZ2V4U2luZ2xlRXNjYXBlLnRlc3QoY2hhcmFjdGVyKSlcclxuICAgICAgKSB7XHJcbiAgICAgICAgdmFsdWUgPSAnXFxcXCcgKyBjaGFyYWN0ZXI7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdmFsdWUgPSBjaGFyYWN0ZXI7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIG91dHB1dCArPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIGlmIChpc0lkZW50aWZpZXIpIHtcclxuICAgIGlmICgvXi1bLVxcZF0vLnRlc3Qob3V0cHV0KSkge1xyXG4gICAgICBvdXRwdXQgPSAnXFxcXC0nICsgb3V0cHV0LnNsaWNlKDEpO1xyXG4gICAgfSBlbHNlIGlmICgvXFxkLy50ZXN0KGZpcnN0Q2hhcikpIHtcclxuICAgICAgb3V0cHV0ID0gJ1xcXFwzJyArIGZpcnN0Q2hhciArICcgJyArIG91dHB1dC5zbGljZSgxKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIFJlbW92ZSBzcGFjZXMgYWZ0ZXIgYFxcSEVYYCBlc2NhcGVzIHRoYXQgYXJlIG5vdCBmb2xsb3dlZCBieSBhIGhleCBkaWdpdCxcclxuICAvLyBzaW5jZSB0aGV54oCZcmUgcmVkdW5kYW50LiBOb3RlIHRoYXQgdGhpcyBpcyBvbmx5IHBvc3NpYmxlIGlmIHRoZSBlc2NhcGVcclxuICAvLyBzZXF1ZW5jZSBpc27igJl0IHByZWNlZGVkIGJ5IGFuIG9kZCBudW1iZXIgb2YgYmFja3NsYXNoZXMuXHJcbiAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UocmVnZXhFeGNlc3NpdmVTcGFjZXMsIGZ1bmN0aW9uICgkMCwgJDEsICQyKSB7XHJcbiAgICBpZiAoJDEgJiYgJDEubGVuZ3RoICUgMikge1xyXG4gICAgICAvLyBJdOKAmXMgbm90IHNhZmUgdG8gcmVtb3ZlIHRoZSBzcGFjZSwgc28gZG9u4oCZdC5cclxuICAgICAgcmV0dXJuICQwO1xyXG4gICAgfVxyXG4gICAgLy8gU3RyaXAgdGhlIHNwYWNlLlxyXG4gICAgcmV0dXJuICgkMSB8fCAnJykgKyAkMjtcclxuICB9KTtcclxuXHJcbiAgaWYgKCFpc0lkZW50aWZpZXIgJiYgb3B0aW9ucy53cmFwKSB7XHJcbiAgICByZXR1cm4gcXVvdGUgKyBvdXRwdXQgKyBxdW90ZTtcclxuICB9XHJcbiAgcmV0dXJuIG91dHB1dDtcclxufVxyXG4iLCJleHBvcnQgdHlwZSBFeGF1c3RpdmU8VCBleHRlbmRzIHN0cmluZyB8IG51bWJlciwgUj4gPSB7XHJcbiAgW2tleSBpbiBUXTogUjtcclxufTtcclxuZXhwb3J0IHR5cGUgTm90RXhhdXN0aXZlPFQgZXh0ZW5kcyBzdHJpbmcgfCBudW1iZXIsIFI+ID0ge1xyXG4gIFtrZXkgaW4gVF0/OiBSO1xyXG59ICYgeyBfOiBSIH07XHJcblxyXG5leHBvcnQgY29uc3QgbWF0Y2ggPVxyXG4gIDxUIGV4dGVuZHMgc3RyaW5nIHwgbnVtYmVyLCBSID0gYW55PihtYXA6IEV4YXVzdGl2ZTxULCBSPiB8IE5vdEV4YXVzdGl2ZTxULCBSPikgPT5cclxuICAoc2VsZWN0b3I6IFQpOiBSID0+XHJcbiAgICBzZWxlY3RvciBpbiBtYXAgPyBtYXBbc2VsZWN0b3JdIDogJ18nIGluIG1hcCA/IG1hcFsnXyddIDogbnVsbDtcclxuXHJcbi8vIEV4YW1wbGVzXHJcbmV4cG9ydCB0eXBlIEFuaW1hbHMgPSAnZG9nJyB8ICdjYXQnIHwgJ2JpcmQnIHwgJ2JlYXInIHwgJ2hvcnNlJztcclxuXHJcbm1hdGNoPEFuaW1hbHM+KHtcclxuICBiZWFyOiAncm9hcicsXHJcbiAgYmlyZDogJ2NpcCcsXHJcbiAgY2F0OiAnbWlhbycsXHJcbiAgZG9nOiAnYmF1JyxcclxuICBob3JzZTogJ2JvaCcsXHJcbn0pKCdkb2cnKTtcclxuXHJcbm1hdGNoPEFuaW1hbHM+KHtcclxuICBiZWFyOiAncm9hcicsXHJcbiAgYmlyZDogJ2NpcCcsXHJcbiAgY2F0OiAnbWlhbycsXHJcbiAgXzogJ2JvaCcsXHJcbn0pKCdkb2cnKTtcclxuIiwiXHJcbmltcG9ydCB7IHRvY21kIH0gZnJvbSBcIi4vZXZlbnRQYXJzZXJcIjtcclxuaW1wb3J0IHsgQ29tbWFuZCwgQ29tbWFuZFR5cGUsIE9wdGlvbnMsIFBhcnNlZEV2ZW50LCBUYWdzIH0gZnJvbSBcIi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgZGVsYXksIGdldElkLCBnZXRTZXR0aW5ncywgaXNUYWcsIHVwLCB1cFRvQ3RybFdpdGhJZCwgdXBUb0lkIH0gZnJvbSBcIi4vdVwiO1xyXG5cclxuY29uc3Qga2VuZG9HcmlkUm93SW5kZXhBdHRyID0gXCJkYXRhLWtlbmRvLWdyaWQtaXRlbS1pbmRleFwiO1xyXG5jb25zdCBrZW5kb0dyaWRDb2xJbmRleEF0dHIgPSBcImRhdGEta2VuZG8tZ3JpZC1jb2x1bW4taW5kZXhcIjtcclxuY29uc3Qga2VuZG9UcmVlbGlzdFJvd0luZGV4QXR0ciA9IFwiZGF0YS10cmVlbGlzdC12aWV3LWluZGV4XCI7XHJcbmNvbnN0IGtlbmRvVHJlZWxpc3RDb2xJbmRleEF0dHIgPSBcImFyaWEtY29saW5kZXhcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBHZW5lcmljQ29tbWFuZENvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgaXNDb21wb25lbnQodGFyZ2V0OiBFbGVtZW50LCB0YWdOYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICB2YXIgYW5jID0gdXBUb0lkKHRhcmdldCk7XHJcbiAgICAgICAgcmV0dXJuIGlzVGFnKGFuYywgdGFnTmFtZSk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCwgdGFnOiBUYWdzLCBjb21tYW5kOiBDb21tYW5kVHlwZSwgc2VsZWN0b3I6IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkdlbmVyaWNDb21tYW5kQ29tcG9uZW50IGNhcHR1cmVcIik7XHJcbiAgICAgICAgdmFyIGFuYyA9IHVwVG9JZCh0YXJnZXQpO1xyXG4gICAgICAgIGNvbnN0IGlkID0gZ2V0SWQoYW5jKTtcclxuICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZ2V0VmFsdWUodGFyZ2V0LCBzZWxlY3RvciwgYXR0cmlidXRlKTtcclxuICAgICAgICByZXR1cm4gdG9jbWQoY29tbWFuZCwgcGFyc2VkRXZlbnQpKGlkLCB0YXJnZXQsIHsgdGFnLCBldmVudFZhbHVlOiB2YWx1ZSB9KTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBnZXRWYWx1ZSh0YXJnZXQ6IEVsZW1lbnQsIHNlbGVjdG9yOiBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICBpZiAoc2VsZWN0b3IpXHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik/LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xyXG4gICAgICAgIGVsc2UgcmV0dXJuIHRhcmdldC5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKTtcclxuICAgIH1cclxufVxyXG5leHBvcnQgY2xhc3MgSXRlbVNvdXJjZUNvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgaXNDb21wb25lbnQodGFyZ2V0OiBFbGVtZW50KTogRWxlbWVudCB7XHJcbiAgICAgICAgcmV0dXJuIHVwKFwidGItaXRlbS1zb3VyY2VcIikodGFyZ2V0KSB8fCB1cChcIi50Yi1wb3B1cC1pdGVtLXNvdXJjZS1jb250ZW50XCIpKHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgYXN5bmMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCwgaXNQaWNrZXI6IGJvb2xlYW4pIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkl0ZW1Tb3VyY2VDb21wb25lbnQgY2FwdHVyZVwiKTtcclxuICAgICAgICB2YXIgYW5jUGFyZW50ID0gdXBUb0lkKHRhcmdldCk7XHJcbiAgICAgICAgaWYgKGFuY1BhcmVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGVzdCcpPy5zdGFydHNXaXRoKCdpdGVtU291cmNlRHJvcERvd25CdXR0b24nKSkgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKTtcclxuICAgICAgICBpZiAoYW5jUGFyZW50LmdldEF0dHJpYnV0ZSgnZGF0YS10ZXN0Jyk/LnN0YXJ0c1dpdGgoJ2l0ZW1Tb3VyY2VBZGRPbkZseScpKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xyXG4gICAgICAgIGNvbnN0IGlkID0gZ2V0SWQoYW5jUGFyZW50KTtcclxuICAgICAgICBjb25zdCB2YWx1ZURhdGFUZXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihpZCkuZ2V0QXR0cmlidXRlKFwicGFyZW50LWRhdGEtdGVzdFwiKTtcclxuICAgICAgICBpZiAodmFsdWVEYXRhVGVzdCkgeyAvL3Nvbm8gbmVsbGEgdGVuZGluYSBwZXJjaO+/vSBobyBwYXJlbnQtZGF0YS10ZXN0XHJcbiAgICAgICAgICAgIGF3YWl0IGRlbGF5KDEwMCk7XHJcbiAgICAgICAgICAgIHZhciBpdGVtU291cmNlID0gdXAoXCJ0Yi1pdGVtLXNvdXJjZVwiKShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS10ZXN0PScke3ZhbHVlRGF0YVRlc3R9J11gKSlcclxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmdldFZhbHVlRnJvbVNlbGVjdG9yKHZhbHVlRGF0YVRlc3QpO1xyXG4gICAgICAgICAgICByZXR1cm4gdG9jbWQoJ3NlbGVjdCcsIHBhcnNlZEV2ZW50KShnZXRJZChpdGVtU291cmNlKSwgdGFyZ2V0LCB7IHRhZzogXCJJdGVtU291cmNlXCIsIGV2ZW50VmFsdWU6IHZhbHVlIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNQaWNrZXIpIHtcclxuICAgICAgICAgICAgdmFyIGl0ZW1Tb3VyY2VJbnB1dCA9IHRhcmdldC5xdWVyeVNlbGVjdG9yKFwiW3NlbGVjdGVkLWlkXVwiKSB8fCB0YXJnZXQ7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuZ2V0VmFsdWUoaXRlbVNvdXJjZUlucHV0KTtcclxuICAgICAgICAgICAgdmFyIGl0ZW1Tb3VyY2UgPSB1cChcInRiLWl0ZW0tc291cmNlXCIpKGl0ZW1Tb3VyY2VJbnB1dCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0b2NtZCgnc2VsZWN0JywgcGFyc2VkRXZlbnQpKGAke2dldElkKGl0ZW1Tb3VyY2UpfSAke2dldElkKGl0ZW1Tb3VyY2VJbnB1dCl9YCwgaXRlbVNvdXJjZUlucHV0LCB7IHRhZzogXCJJdGVtU291cmNlXCIsIGV2ZW50VmFsdWU6IHZhbHVlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHN0YXRpYyBnZXRWYWx1ZUZyb21TZWxlY3Rvcih2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICB2YXIgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtdGVzdD0nJHt2YWx1ZX0nXWApO1xyXG4gICAgICAgIHJldHVybiB0YXJnZXQ/LmdldEF0dHJpYnV0ZShcInNlbGVjdGVkLWlkXCIpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGdldFZhbHVlKHRhcmdldCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldD8uZ2V0QXR0cmlidXRlKFwic2VsZWN0ZWQtaWRcIik7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBQYW5lbENvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgaXNDb21wb25lbnQodGFyZ2V0OiBFbGVtZW50KTogYm9vbGVhbiB7XHJcbiAgICAgICAgdmFyIGFuYyA9IHVwVG9JZCh0YXJnZXQpO1xyXG4gICAgICAgIHJldHVybiBpc1RhZyhhbmMsIFwidGItcGFuZWxcIik7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIGNvbW1hbmQ6IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZCwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJQYW5lbENvbXBvbmVudCBjYXB0dXJlXCIpO1xyXG4gICAgICAgIHZhciBhbmMgPSB1cFRvSWQodGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBpZCA9IGdldElkKGFuYyk7XHJcbiAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQsIHRhcmdldCwge1xyXG4gICAgICAgICAgICB0YWc6IFwiVGJQYW5lbFwiLFxyXG4gICAgICAgICAgICBkaXNwbGF5OiBcImV4cGFuZC9jb2xsYXBzZVwiLFxyXG4gICAgICAgICAgICBvdGhlcjogYW5jLmNsYXNzTGlzdC5jb250YWlucyhcImNvbGxhcHNlZFwiKSA/ICdleHBhbmQnIDogJ2NvbGxhcHNlJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRHluYW1pY0NoZWNrYm94Q29tcG9uZW50IHtcclxuICAgIHN0YXRpYyBpc0NvbXBvbmVudCh0YXJnZXQ6IEVsZW1lbnQpOiBFbGVtZW50IHtcclxuICAgICAgICByZXR1cm4gdXAoXCJ0Yi1keW5hbWljLWNoZWNrYm94LWxpc3RcIikodGFyZ2V0KTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBjYXB0dXJlKHRhcmdldDogRWxlbWVudCwgY29tbWFuZDogKHNlbGVjdG9yOiBzdHJpbmcsIHRhcmdldD86IEVsZW1lbnQsIG9wdGlvbnM/OiBPcHRpb25zKSA9PiBDb21tYW5kLCBwYXJzZWRFdmVudDogUGFyc2VkRXZlbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkR5bmFtaWNDaGVja2JveENvbXBvbmVudCBjYXB0dXJlXCIpO1xyXG4gICAgICAgIHZhciBhbmMgPSB1cFRvSWQodGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBpZCA9IGdldElkKGFuYyk7XHJcbiAgICAgICAgaWYgKHRhcmdldC50YWdOYW1lID09IFwiTEFCRUxcIiB8fCB0YXJnZXQudGFnTmFtZSA9PSBcIlNQQU5cIikgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQsIHRhcmdldCwge1xyXG4gICAgICAgICAgICB0YWc6IFwiRHluYW1pY0NoZWNrYm94XCIsXHJcbiAgICAgICAgICAgIGV2ZW50VmFsdWU6IHRhcmdldC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJsYWJlbFwiKS5pbm5lclRleHQsXHJcbiAgICAgICAgICAgIGV2ZW50S2V5OiBwYXJzZWRFdmVudD8ua2V5LFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgS2VuZG9UcmVlTGlzdENvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgaXNDb21wb25lbnQodGFyZ2V0OiBFbGVtZW50KTogRWxlbWVudCB7XHJcbiAgICAgICAgcmV0dXJuIHVwKFwia2VuZG8tdHJlZWxpc3RcIikodGFyZ2V0KTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBjYXB0dXJlKHRhcmdldDogRWxlbWVudCwgY29tbWFuZDogKHNlbGVjdG9yOiBzdHJpbmcsIHRhcmdldD86IEVsZW1lbnQsIG9wdGlvbnM/OiBPcHRpb25zKSA9PiBDb21tYW5kLCBwYXJzZWRFdmVudDogUGFyc2VkRXZlbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIktlbmRvVHJlZUxpc3RDb21wb25lbnQgY2FwdHVyZVwiKTtcclxuICAgICAgICB2YXIgYW5jID0gdXBUb0lkKHRhcmdldCk7XHJcbiAgICAgICAgbGV0IGlkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGlmICh0YXJnZXQudGFnTmFtZSA9PSAnVEQnKVxyXG4gICAgICAgICAgICBpZCA9IGdldElkKHRhcmdldC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10ZXN0XScpKTtcclxuICAgICAgICBlbHNlIGlkID0gZ2V0SWQoYW5jKTtcclxuICAgICAgICBpZiAodXAoXCJrZW5kby10cmVlbGlzdC10b29sYmFyXCIpKHRhcmdldCkgJiYgYW5jLmF0dHJpYnV0ZXNbXCJkYXRhLXRlc3RcIl0pXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKGlkLCBhbmMpO1xyXG4gICAgICAgIC8vaWYgKHRhcmdldC5hdHRyaWJ1dGVzW1wiZGF0YS10ZXN0XCJdKSByZXR1cm4gY21kLmNsaWNrKGlkLCB0YXJnZXQpO1xyXG4gICAgICAgIGNvbnN0IHJvdyA9IHVwKFwidHJbXCIgKyBrZW5kb1RyZWVsaXN0Um93SW5kZXhBdHRyICsgJ10nKSh0YXJnZXQpO1xyXG4gICAgICAgIGlmIChyb3cgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIltNQ1JdIG5vIHJvdyBpbmRleCBmb3VuZC5cIiwgdGFyZ2V0KTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGlkeCA9IHJvdy5nZXRBdHRyaWJ1dGUoa2VuZG9UcmVlbGlzdFJvd0luZGV4QXR0cik7IC8vbmctcmVmbGVjdC1kYXRhLXJvdy1pbmRleCAoaW5kaWNlIHRvdGFsZSkgLSBkYXRhLXRyZWVsaXN0LXZpZXctaW5kZXggKGluZGljZSBwYWdpbmF0bykgLSBuZy1yZWZsZWN0LWxvZ2ljYWwtcm93LWluZGV4IChpbmRpY2UgbG9naWNvIHRvdGFsZSlcclxuICAgICAgICBjb25zdCB0ZCA9IHVwKFwidGRcIikodGFyZ2V0KTsgLy9rZW5kb3RyZWVsaXN0bG9naWNhbGNlbGxcclxuICAgICAgICBpZiAoKHRhcmdldC50YWdOYW1lID09PSBcIlNQQU5cIiB8fCB0YXJnZXQudGFnTmFtZSA9PT0gXCJESVZcIikgJiYgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImstaWNvblwiKSlcclxuICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQsIHRhcmdldCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJrLWktY2FyZXQtYWx0LXJpZ2h0XCIpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJrLWktZXhwYW5kXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gXCJLZW5kb1RyZWVsaXN0RXhwYW5kXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBcIktlbmRvVHJlZWxpc3RDb2xsYXBzZVwiLFxyXG4gICAgICAgICAgICAgICAgaWR4LFxyXG4gICAgICAgICAgICAgICAgbnRoOiArdGQuZ2V0QXR0cmlidXRlKGtlbmRvVHJlZWxpc3RDb2xJbmRleEF0dHIpLFxyXG4gICAgICAgICAgICAgICAgZXZlbnRWYWx1ZTogdGQucXVlcnlTZWxlY3RvcihcInNwYW5bZGF0YS10ZXN0XSxkaXZbZGF0YS10ZXN0XVwiKVxyXG4gICAgICAgICAgICAgICAgICAgID8gKHRkLnF1ZXJ5U2VsZWN0b3IoXCJzcGFuW2RhdGEtdGVzdF0sZGl2W2RhdGEtdGVzdF1cIikgYXMgSFRNTEVsZW1lbnQpPy5nZXRBdHRyaWJ1dGUoXCJkYXRhLXRlc3RcIilcclxuICAgICAgICAgICAgICAgICAgICA6IFwiXCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRkLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS10ZXN0XVwiKS5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKGlkLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogXCJLZW5kb1RyZWVsaXN0TmF0aXZlQ2VsbFwiLFxyXG4gICAgICAgICAgICAgICAgbWFpbkNvbXBvbmVudDogZ2V0SWQodGhpcy5pc0NvbXBvbmVudCh0YXJnZXQpKSxcclxuICAgICAgICAgICAgICAgIGlkeCxcclxuICAgICAgICAgICAgICAgIG50aDogK3RkLmdldEF0dHJpYnV0ZShrZW5kb1RyZWVsaXN0Q29sSW5kZXhBdHRyKSxcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciBzZXR0aW5ncyA9IGdldFNldHRpbmdzKHRoaXMuaXNDb21wb25lbnQodGFyZ2V0KSk7XHJcbiAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQsIHRhcmdldCwge1xyXG4gICAgICAgICAgICB0YWc6IHNldHRpbmdzPy5yb3dJbmRleCA/IFwiS2VuZG9UcmVlbGlzdFJvd0luZGV4XCIgOiBcIktlbmRvVHJlZWxpc3RcIixcclxuICAgICAgICAgICAgaWR4LFxyXG4gICAgICAgICAgICBudGg6ICt0ZC5nZXRBdHRyaWJ1dGUoa2VuZG9HcmlkQ29sSW5kZXhBdHRyKSxcclxuICAgICAgICAgICAgbWFpbkNvbXBvbmVudDogZ2V0SWQodGhpcy5pc0NvbXBvbmVudCh0YXJnZXQpKSxcclxuICAgICAgICAgICAgZXZlbnRWYWx1ZTogdGQucXVlcnlTZWxlY3RvcihcInNwYW5bZGF0YS10ZXN0XVwiKVxyXG4gICAgICAgICAgICAgICAgPyAodGQucXVlcnlTZWxlY3RvcihcInNwYW5bZGF0YS10ZXN0XVwiKSBhcyBIVE1MRWxlbWVudCk/LmdldEF0dHJpYnV0ZShcImRhdGEtdGVzdFwiKVxyXG4gICAgICAgICAgICAgICAgOiBcIlwiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgS2VuZG9HcmlkQ29tcG9uZW50IHtcclxuICAgIHN0YXRpYyBpc0NvbXBvbmVudCh0YXJnZXQ6IEVsZW1lbnQpOiBFbGVtZW50IHtcclxuICAgICAgICByZXR1cm4gdXAoXCJrZW5kby1ncmlkXCIpKHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIGNvbW1hbmQ6IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZCwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KSB7XHJcbiAgICAgICAgbGV0IHZ2ID0gdXA7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJLZW5kb0dyaWRDb21wb25lbnQgY2FwdHVyZVwiKTtcclxuICAgICAgICBpZiAodXAoXCJrZW5kby1ncmlkLXRvb2xiYXJcIikodGFyZ2V0KSkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgdmFyIGFuYyA9IHVwVG9JZCh0YXJnZXQpO1xyXG4gICAgICAgIGNvbnN0IGlkID0gZ2V0SWQoYW5jKTtcclxuICAgICAgICBpZiAoaWQgPT09IGdldElkKHRoaXMuaXNDb21wb25lbnQodGFyZ2V0KSkpIHJldHVybiBudWxsO1xyXG4gICAgICAgIGxldCBpZHggPSB1cCgnWycgKyBrZW5kb0dyaWRSb3dJbmRleEF0dHIgKyAnXScpKHRhcmdldCk/LmdldEF0dHJpYnV0ZShrZW5kb0dyaWRSb3dJbmRleEF0dHIpO1xyXG4gICAgICAgIGxldCBudGggPSArdXAoJ1snICsga2VuZG9HcmlkQ29sSW5kZXhBdHRyICsgJ10nKSh0YXJnZXQpPy5nZXRBdHRyaWJ1dGUoa2VuZG9HcmlkQ29sSW5kZXhBdHRyKTtcclxuXHJcbiAgICAgICAgaWYgKCFpZHgpIC8vIHJpZ2EgdmlydHVhbGUgKHVuYSBzb2xhIHZpc2liaWxlKVxyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChpZCwgdGFyZ2V0LCB7XHJcbiAgICAgICAgICAgICAgICB0YWc6IGBLZW5kb0dyaWRgLFxyXG4gICAgICAgICAgICAgICAgaWR4LC8vcm93IGluZGV4XHJcbiAgICAgICAgICAgICAgICBudGgsLy9jb2wgaW5kZXhcclxuICAgICAgICAgICAgICAgIG1haW5Db21wb25lbnQ6IGdldElkKHRoaXMuaXNDb21wb25lbnQodGFyZ2V0KSksXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImNsaWNrIGtlbmRvIGdyaWRcIixcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICh1cChcImtlbmRvLWdyaWRcIikodGFyZ2V0KSkgLy9ncmlkXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKGlkLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogYEtlbmRvR3JpZFJvd0luZGV4YCxcclxuICAgICAgICAgICAgICAgIGlkeCwvL3JvdyBpbmRleFxyXG4gICAgICAgICAgICAgICAgbnRoLC8vY29sIGluZGV4XHJcbiAgICAgICAgICAgICAgICBtYWluQ29tcG9uZW50OiBnZXRJZCh0aGlzLmlzQ29tcG9uZW50KHRhcmdldCkpLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheTogXCJjbGljayBncmlkIGluZGV4XCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQm9keUVkaXRDb21wb25lbnQge1xyXG4gICAgc3RhdGljIGlzQ29tcG9uZW50KHRhcmdldDogRWxlbWVudCk6IEVsZW1lbnQge1xyXG4gICAgICAgIHJldHVybiB1cChcInRiLWJlXCIpKHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIGNvbW1hbmQ6IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZCwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KSB7XHJcbiAgICAgICAgbGV0IHZ2ID0gdXA7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJCb2R5RWRpdENvbXBvbmVudCBjYXB0dXJlXCIpO1xyXG4gICAgICAgIHZhciBhbmMgPSB1cFRvSWQodGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBpZCA9IGdldElkKGFuYyk7XHJcbiAgICAgICAgbGV0IGlkeCA9IHVwKCdbJyArIGtlbmRvR3JpZFJvd0luZGV4QXR0ciArICddJykodGFyZ2V0KT8uZ2V0QXR0cmlidXRlKGtlbmRvR3JpZFJvd0luZGV4QXR0cik7XHJcbiAgICAgICAgbGV0IG50aCA9ICt1cCgnWycgKyBrZW5kb0dyaWRDb2xJbmRleEF0dHIgKyAnXScpKHRhcmdldCk/LmdldEF0dHJpYnV0ZShrZW5kb0dyaWRDb2xJbmRleEF0dHIpO1xyXG5cclxuICAgICAgICBpZiAoaWQgPT0gZ2V0SWQodGhpcy5pc0NvbXBvbmVudCh0YXJnZXQpKSAmJiAoIWlkeCB8fCB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiay1ncmlkLWNvbnRlbnRcIikpKVxyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChcIltkYXRhLXRlc3Q9J2JvZHlFZGl0UGFnZXJOdW1iZXJEaXNtaXNzRm9jdXMnXVwiLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogXCJCb2R5RWRpdFwiLFxyXG4gICAgICAgICAgICAgICAgbWFpbkNvbXBvbmVudDogZ2V0SWQodGhpcy5pc0NvbXBvbmVudCh0YXJnZXQpKVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKGlkICYmICFpZHggJiYgdGFyZ2V0LmNsb3Nlc3QoXCJrZW5kby1ncmlkIHRoZWFkIHRyID4gdGhcIikpXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKGlkLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogYEJvZHlFZGl0YCxcclxuICAgICAgICAgICAgICAgIG1haW5Db21wb25lbnQ6IGdldElkKHRoaXMuaXNDb21wb25lbnQodGFyZ2V0KSksXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImNsaWNrIGJvZHkgZWRpdCBoZWFkZXJcIixcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChpZCAmJiAhaWR4ICYmIHRhcmdldC5jbG9zZXN0KFwidGItZXZcIikpXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKGlkLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogYEJFZGl0Vmlld2AsXHJcbiAgICAgICAgICAgICAgICBtYWluQ29tcG9uZW50OiBnZXRJZCh0aGlzLmlzQ29tcG9uZW50KHRhcmdldCkpLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheTogXCJib2R5IGVkaXQgdmlld1wiLFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJkdW1teVJvd1wiKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChpZCwgdGFyZ2V0LCB7XHJcbiAgICAgICAgICAgICAgICB0YWc6IGBCb2R5RWRpdER1bW15Um93YCxcclxuICAgICAgICAgICAgICAgIG1haW5Db21wb25lbnQ6IGdldElkKHRoaXMuaXNDb21wb25lbnQodGFyZ2V0KSksXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImFkZCByb3dcIixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodXAoXCJrZW5kby1ncmlkXCIpKHRhcmdldCkpIC8vZ3JpZFxyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChpZCwgdGFyZ2V0LCB7XHJcbiAgICAgICAgICAgICAgICB0YWc6IGBCb2R5RWRpdFJvd2AsXHJcbiAgICAgICAgICAgICAgICBpZHgsLy9yb3cgaW5kZXhcclxuICAgICAgICAgICAgICAgIG50aCwvL2NvbCBpbmRleFxyXG4gICAgICAgICAgICAgICAgbWFpbkNvbXBvbmVudDogZ2V0SWQodGhpcy5pc0NvbXBvbmVudCh0YXJnZXQpKSxcclxuICAgICAgICAgICAgICAgIGRpc3BsYXk6IFwiY2xpY2sgYm9keSBncmlkXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIGVsc2UgLy90b29sYmFyXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKGlkLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogYEJvZHlFZGl0YCxcclxuICAgICAgICAgICAgICAgIG1haW5Db21wb25lbnQ6IGdldElkKHRoaXMuaXNDb21wb25lbnQodGFyZ2V0KSksXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImNsaWNrIGJvZHkgZWRpdFwiLFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBXaW5kb3dDb21wb25lbnQge1xyXG4gICAgc3RhdGljIGlzQ29tcG9uZW50KHRhcmdldDogRWxlbWVudCk6IEVsZW1lbnQge1xyXG4gICAgICAgIHJldHVybiB1cChcImtlbmRvLXdpbmRvd1wiKSh0YXJnZXQpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGNhcHR1cmUodGFyZ2V0OiBFbGVtZW50LCBjb21tYW5kOiAoc2VsZWN0b3I6IHN0cmluZywgdGFyZ2V0PzogRWxlbWVudCwgb3B0aW9ucz86IE9wdGlvbnMpID0+IENvbW1hbmQsIHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiV2luZG93Q29tcG9uZW50IGNhcHR1cmVcIik7XHJcbiAgICAgICAgY29uc3QgZWwgPSB1cFRvSWQodGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBpZCA9IGdldElkKGVsKTtcclxuXHJcbiAgICAgICAgaWYgKHRhcmdldC50YWdOYW1lID09IFwiU1BBTlwiICYmIHRhcmdldC5wYXJlbnRFbGVtZW50Py5oYXNBdHRyaWJ1dGUoXCJrZW5kb3dpbmRvd2Nsb3NlYWN0aW9uXCIpIHx8XHJcbiAgICAgICAgICAgIHRhcmdldC50YWdOYW1lID09IFwiQlVUVE9OXCIgJiYgdGFyZ2V0Lmhhc0F0dHJpYnV0ZShcImtlbmRvd2luZG93Y2xvc2VhY3Rpb25cIikpXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKFwiS2VuZG8tV2luZG93XCIsIHRhcmdldCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOiBcIldpbmRvd0Nsb3NlXCIsXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImNsb3NlIHdpbmRvd1wiLFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQsIHRhcmdldCwgeyB0YWc6IFwiV2luZG93XCIvKiwgc2NvcGU6ICdBbGwnKi8gfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBEaWFsb2dDb21wb25lbnQge1xyXG4gICAgc3RhdGljIGlzQ29tcG9uZW50KHRhcmdldDogRWxlbWVudCk6IEVsZW1lbnQge1xyXG4gICAgICAgIHJldHVybiB1cChcImtlbmRvLWRpYWxvZ1wiKSh0YXJnZXQpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGNhcHR1cmUodGFyZ2V0OiBFbGVtZW50LCBjb21tYW5kOiAoc2VsZWN0b3I6IHN0cmluZywgdGFyZ2V0PzogRWxlbWVudCwgb3B0aW9ucz86IE9wdGlvbnMpID0+IENvbW1hbmQsIHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRGlhbG9nQ29tcG9uZW50IGNhcHR1cmVcIik7XHJcbiAgICAgICAgY29uc3QgZWwgPSB1cFRvSWQodGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBpZCA9IGdldElkKGVsKTtcclxuXHJcbiAgICAgICAgaWYgKHVwKCdrZW5kby1kaWFsb2ctYWN0aW9ucycpKHRhcmdldCkpIHtcclxuICAgICAgICAgICAgaWYgKHRhcmdldC5jbG9zZXN0KCdtYy1zY2hlZHVsZXItYXBwJykpLy9wZXIgbGEgZGlhbG9nIG5hdGl2YSBkZWxsbyBzY2hlZHVsZXIgY2hlIG5vbiBzZW1icmEgcGVyc29uYWxpenphYmlsZVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmQoJ3RleHQ9JyArICh0YXJnZXQuY2xvc2VzdCgnYnV0dG9uJykucXVlcnlTZWxlY3RvcignLmstYnV0dG9uLXRleHQnKSBhcyBIVE1MRWxlbWVudCkuaW5uZXJUZXh0LCB0YXJnZXQuY2xvc2VzdCgnYnV0dG9uJyksIHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwiRGlhbG9nQWN0aW9uc1NjaGVkdWxlclwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IFwiZGlhbG9nIGFjdGlvbnNcIixcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQgPyBpZCA6IFwia2VuZG8tZGlhbG9nXCIsIHRhcmdldCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOiBcIkRpYWxvZ0FjdGlvbnNcIixcclxuICAgICAgICAgICAgICAgIGRpc3BsYXk6IFwiZGlhbG9nIGFjdGlvbnNcIixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZWwgJiYgdXAoJ2tlbmRvLWRpYWxvZy10aXRsZWJhcicpKHRhcmdldCkgJiZcclxuICAgICAgICAgICAgKHRhcmdldC50YWdOYW1lID09IFwiU1BBTlwiICYmIHRhcmdldC5wYXJlbnRFbGVtZW50Py5oYXNBdHRyaWJ1dGUoXCJ0aXRsZVwiKSAmJiB0YXJnZXQucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIpID09IFwiQ2xvc2VcIikgfHxcclxuICAgICAgICAgICAgKHRhcmdldC50YWdOYW1lID09IFwiQlVUVE9OXCIgJiYgdGFyZ2V0Lmhhc0F0dHJpYnV0ZShcInRpdGxlXCIpICYmIHRhcmdldC5nZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIpID09IFwiQ2xvc2VcIikpXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKFwiS2VuZG8tRGlhbG9nXCIsIHRhcmdldCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOiBcIkRpYWxvZ0Nsb3NlXCIsXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImNsb3NlIGRpYWxvZ1wiLFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCFpZCkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQsIHRhcmdldCwgeyB0YWc6IFwiRGlhbG9nXCIvKiwgc2NvcGU6ICdBbGwnKi8gfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBEb2NrZXJDb21wb25lbnQge1xyXG4gICAgc3RhdGljIGlzQ29tcG9uZW50KHRhcmdldDogRWxlbWVudCk6IEVsZW1lbnQge1xyXG4gICAgICAgIHJldHVybiB1cChcInRiLWRvY2twYW5lLWNvbnRhaW5lclwiKSh0YXJnZXQpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGlzRGVzaWduU3RhdGUodGFyZ2V0OiBFbGVtZW50KTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuICEhdXAoXCJ0Yi1kb2NrcGFuZS1jb250YWluZXIudGItZGVzaWduLXN0YXRlXCIpKHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIGNvbW1hbmQ6IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZCwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJEb2NrZXJDb21wb25lbnQgY2FwdHVyZVwiKTtcclxuICAgICAgICAvL2NvbnN0IHdyYXAgPSB7IHVwLCB1cFRvSWQsIHVwVG9DdHJsV2l0aElkLCBnZXRJZCB9O1xyXG4gICAgICAgIHZhciB0YWJiZXJTZWxlY3RvclRhcmdldCA9IHVwKFwiLmRvY2twYW5lLXRhYmJlci1zZWxlY3RvclwiKSh0YXJnZXQpO1xyXG4gICAgICAgIGlmICh0YWJiZXJTZWxlY3RvclRhcmdldCA9PSBudWxsKSB7IC8vY2xpY2sgbmVsIGNvbnRlbnV0byBkZWwgZG9ja3BhbmVcclxuICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IHVwKFwidGItZG9ja3BhbmUtY29udGFpbmVyXCIpKHRhcmdldCk7XHJcbiAgICAgICAgICAgIHZhciB0YWJiZXJTZWxlY3RvciA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmRvY2twYW5lLXRhYmJlci1zZWxlY3RvciB1bCBsaS5hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkID0gZ2V0SWQodGFiYmVyU2VsZWN0b3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChpZCwgdGFiYmVyU2VsZWN0b3IsIHsgdGFnOiBcIkRvY2tQYW5lXCIsIC8qZGlzcGxheTogaWNvbiovIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBLZW5kb1VwbG9hZENvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgaXNDb21wb25lbnQodGFyZ2V0OiBFbGVtZW50KTogRWxlbWVudCB7XHJcbiAgICAgICAgcmV0dXJuIHVwKFwia2VuZG8tdXBsb2FkXCIpKHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIGNvbW1hbmQ6IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZCwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJLZW5kb1VwbG9hZENvbXBvbmVudCBjYXB0dXJlXCIpO1xyXG4gICAgICAgIGlmICh0YXJnZXQudGFnTmFtZSA9PSBcIklOUFVUXCIgJiYgdGFyZ2V0LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiay11cGxvYWQtYnV0dG9uXCIpKVxyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChcImtlbmRvLXVwbG9hZCBkaXYuay11cGxvYWQtYnV0dG9uIGlucHV0XCIsIHRhcmdldCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOiBcIktlbmRvVXBsb2FkXCIsXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcInNlbGVjdCBmaWxlXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0YXJnZXQudGFnTmFtZSA9PSBcIkJVVFRPTlwiICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJrLXVwbG9hZC1zZWxlY3RlZFwiKSlcclxuICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmQoXCJrZW5kby11cGxvYWQtYWN0aW9uLWJ1dHRvbnMgYnV0dG9uLmstdXBsb2FkLXNlbGVjdGVkXCIsIHRhcmdldCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOiBcIktlbmRvVXBsb2FkXCIsXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcInVwbG9hZCBmaWxlXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0YXJnZXQudGFnTmFtZSA9PSBcIkJVVFRPTlwiICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJrLWNsZWFyLXNlbGVjdGVkXCIpKVxyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChcImtlbmRvLXVwbG9hZC1hY3Rpb24tYnV0dG9ucyBidXR0b24uay1jbGVhci1zZWxlY3RlZFwiLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogXCJLZW5kb1VwbG9hZFwiLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheTogXCJjbGVhciBmaWxlIHNlbGVjdGVkXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgUmFkYXJDb21wb25lbnQge1xyXG4gICAgc3RhdGljIGlzQ29tcG9uZW50KHRhcmdldDogRWxlbWVudCk6IEVsZW1lbnQge1xyXG4gICAgICAgIHJldHVybiB1cChcInRiLXJhZGFyLWN1c3RvbWlzYWJsZS1ncmlkXCIpKHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIGNvbW1hbmQ6IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZCwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KTogYW55IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlJhZGFyQ29tcG9uZW50IGNhcHR1cmVcIik7XHJcbiAgICAgICAgbGV0IHZ2ID0gdXA7XHJcbiAgICAgICAgY29uc3Qgb3duZXJEb2MgPSB1cCgoZWwpID0+IGVsLnRhZ05hbWUuc3RhcnRzV2l0aChcIlRCLUlERFwiKSkodGFyZ2V0KTtcclxuICAgICAgICBjb25zdCByb3cgPSB1cChcInRyW1wiICsga2VuZG9HcmlkUm93SW5kZXhBdHRyICsgXCJdXCIpKHRhcmdldCk7XHJcbiAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiW01DUl0gbm8gcm93IGluZGV4IGZvdW5kLlwiLCB0YXJnZXQpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgaWR4ID0gcm93LmdldEF0dHJpYnV0ZShrZW5kb0dyaWRSb3dJbmRleEF0dHIpO1xyXG4gICAgICAgIGNvbnN0IGVsID0gdXBUb0lkKHRhcmdldCk7XHJcbiAgICAgICAgY29uc3QgaWQgPSBnZXRJZChlbCk7XHJcbiAgICAgICAgY29uc3QgaXNXZWJTdHlsZSA9IHVwKCdrZW5kby1ncmlkJykodGFyZ2V0KT8uY2xhc3NMaXN0Py5jb250YWlucygnbW9kZTEnKTtcclxuICAgICAgICByZXR1cm4gY29tbWFuZChpZCwgdGFyZ2V0LCB7XHJcbiAgICAgICAgICAgIHRhZzogaXNXZWJTdHlsZSA/IFwiVGJSYWRhcldlYlN0eWxlXCIgOiBcIlRiUmFkYXJUYWJsZVN0eWxlXCIsXHJcbiAgICAgICAgICAgIHBhcmVudDogb3duZXJEb2M/LnRhZ05hbWUsXHJcbiAgICAgICAgICAgIGlkeCxcclxuICAgICAgICAgICAgZGlzcGxheTogXCJyYWRhcjogY2xpY2sgcm93IFwiICsgaWR4XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwidmVyc2lvbiI6MywiZmlsZSI6ImludGVyY2VwdG9yLmpzLm1hcCJ9
