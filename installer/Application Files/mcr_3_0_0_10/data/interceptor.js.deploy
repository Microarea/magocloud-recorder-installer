(() => {
let $1aae169a1a51f082$export$3d7865934588d77e;
(function(EventType) {
    EventType["CLICK"] = "click";
    EventType["CHANGE"] = "change";
    EventType["DBLCLICK"] = "dblclick";
    EventType["KEYDOWN"] = "keydown";
    EventType["SUBMIT"] = "submit";
    EventType["CONTEXTMENU"] = "contextmenu";
    EventType["DRAGSTART"] = "dragstart";
    EventType["DROP"] = "drop";
})($1aae169a1a51f082$export$3d7865934588d77e || ($1aae169a1a51f082$export$3d7865934588d77e = {}));
let $1aae169a1a51f082$export$75972070afd93869;
(function(KeydownType) {
    KeydownType["ESCAPE"] = "Escape";
    KeydownType["F1"] = "F1";
    KeydownType["F2"] = "F2";
    KeydownType["F3"] = "F3";
    KeydownType["F7"] = "F7";
    KeydownType["F10"] = "F10";
    KeydownType["TAB"] = "Tab";
})($1aae169a1a51f082$export$75972070afd93869 || ($1aae169a1a51f082$export$75972070afd93869 = {}));
let $1aae169a1a51f082$export$19ad8633adf38a6d;
(function(ControlAction) {
    ControlAction[ControlAction["START"] = 0] = "START";
    ControlAction[ControlAction["STOP"] = 1] = "STOP";
    ControlAction[ControlAction["RESET"] = 2] = "RESET";
    ControlAction[ControlAction["DELETE"] = 3] = "DELETE";
    ControlAction[ControlAction["MOVE"] = 4] = "MOVE";
    ControlAction[ControlAction["PUSH"] = 5] = "PUSH";
    ControlAction[ControlAction["EDIT"] = 6] = "EDIT";
    ControlAction[ControlAction["LOAD"] = 7] = "LOAD";
})($1aae169a1a51f082$export$19ad8633adf38a6d || ($1aae169a1a51f082$export$19ad8633adf38a6d = {}));
let $1aae169a1a51f082$export$a82430915e8eaf8e;
(function(RecState) {
    RecState[RecState["ON"] = 0] = "ON";
    RecState[RecState["OFF"] = 1] = "OFF";
    RecState[RecState["PAUSED"] = 2] = "PAUSED";
})($1aae169a1a51f082$export$a82430915e8eaf8e || ($1aae169a1a51f082$export$a82430915e8eaf8e = {}));


class $a47815ae80a06a17$export$2e2bcd8739ae039 {
    constructor(options){
        var _a, _b, _c, _d, _e, _f, _g, _h, _j;
        this.overlay = document.createElement("div");
        this.overlay.className = options.className || "_ext-element-overlay";
        this.overlay.style.background = ((_a = options.style) === null || _a === void 0 ? void 0 : _a.background) || "rgba(250, 240, 202, 0.2)";
        this.overlay.style.borderColor = ((_b = options.style) === null || _b === void 0 ? void 0 : _b.borderColor) || "#F95738";
        this.overlay.style.borderStyle = ((_c = options.style) === null || _c === void 0 ? void 0 : _c.borderStyle) || "solid";
        this.overlay.style.borderRadius = ((_d = options.style) === null || _d === void 0 ? void 0 : _d.borderRadius) || "1px";
        this.overlay.style.borderWidth = ((_e = options.style) === null || _e === void 0 ? void 0 : _e.borderWidth) || "1px";
        this.overlay.style.boxSizing = ((_f = options.style) === null || _f === void 0 ? void 0 : _f.boxSizing) || "border-box";
        this.overlay.style.cursor = ((_g = options.style) === null || _g === void 0 ? void 0 : _g.cursor) || "crosshair";
        this.overlay.style.position = ((_h = options.style) === null || _h === void 0 ? void 0 : _h.position) || "absolute";
        this.overlay.style.zIndex = ((_j = options.style) === null || _j === void 0 ? void 0 : _j.zIndex) || "2147483647";
        this.shadowContainer = document.createElement("div");
        this.shadowContainer.className = "_ext-element-overlay-container";
        this.shadowContainer.style.position = "absolute";
        this.shadowContainer.style.top = "0px";
        this.shadowContainer.style.left = "0px";
        this.shadowRoot = this.shadowContainer.attachShadow({
            mode: "open"
        });
    }
    addToDOM(parent, useShadowDOM) {
        this.usingShadowDOM = useShadowDOM;
        if (useShadowDOM) {
            parent.insertBefore(this.shadowContainer, parent.firstChild);
            this.shadowRoot.appendChild(this.overlay);
        } else parent.appendChild(this.overlay);
    }
    removeFromDOM() {
        this.setBounds({
            x: 0,
            y: 0,
            width: 0,
            height: 0
        });
        this.overlay.remove();
        if (this.usingShadowDOM) this.shadowContainer.remove();
    }
    captureCursor() {
        this.overlay.style.pointerEvents = "auto";
    }
    ignoreCursor() {
        this.overlay.style.pointerEvents = "none";
    }
    setBounds({ x: x , y: y , width: width , height: height  }) {
        this.overlay.style.left = x + "px";
        this.overlay.style.top = y + "px";
        this.overlay.style.width = width + "px";
        this.overlay.style.height = height + "px";
    }
}


const $0d2e1d696ad9a5e9$export$abe5643cba19555f = (el)=>{
    const rect = el.getBoundingClientRect();
    return {
        x: window.pageXOffset + rect.left,
        y: window.pageYOffset + rect.top,
        width: el.offsetWidth,
        height: el.offsetHeight
    };
};


class $7c5d4ec7fb1c475d$export$2e2bcd8739ae039 {
    constructor(overlayOptions){
        this.handleMouseMove = (event)=>{
            this.mouseX = event.clientX;
            this.mouseY = event.clientY;
        };
        this.handleClick = (event)=>{
            var _a;
            if (this.target && ((_a = this.options) === null || _a === void 0 ? void 0 : _a.onClick)) this.options.onClick(this.target);
            event.preventDefault();
        };
        this.tick = ()=>{
            this.updateTarget();
            this.tickReq = window.requestAnimationFrame(this.tick);
        };
        this.active = false;
        this.overlay = new (0, $a47815ae80a06a17$export$2e2bcd8739ae039)(overlayOptions !== null && overlayOptions !== void 0 ? overlayOptions : {});
    }
    start(options) {
        var _a, _b;
        if (this.active) return false;
        this.active = true;
        this.options = options;
        document.addEventListener("mousemove", this.handleMouseMove, true);
        document.addEventListener("click", this.handleClick, true);
        this.overlay.addToDOM((_a = options.parentElement) !== null && _a !== void 0 ? _a : document.body, (_b = options.useShadowDOM) !== null && _b !== void 0 ? _b : true);
        this.tick();
        return true;
    }
    stop() {
        this.active = false;
        this.options = undefined;
        document.removeEventListener("mousemove", this.handleMouseMove, true);
        document.removeEventListener("click", this.handleClick, true);
        this.overlay.removeFromDOM();
        this.target = undefined;
        this.mouseX = undefined;
        this.mouseY = undefined;
        if (this.tickReq) window.cancelAnimationFrame(this.tickReq);
    }
    updateTarget() {
        var _a, _b;
        if (this.mouseX === undefined || this.mouseY === undefined) return;
        // Peek through the overlay to find the new target
        this.overlay.ignoreCursor();
        const elAtCursor = document.elementFromPoint(this.mouseX, this.mouseY);
        const newTarget = elAtCursor;
        this.overlay.captureCursor();
        // If the target hasn't changed, there's nothing to do
        if (!newTarget || newTarget === this.target) return;
        // If we have an element filter and the new target doesn't match,
        // clear out the target
        if ((_a = this.options) === null || _a === void 0 ? void 0 : _a.elementFilter) {
            if (!this.options.elementFilter(newTarget)) {
                this.target = undefined;
                this.overlay.setBounds({
                    x: 0,
                    y: 0,
                    width: 0,
                    height: 0
                });
                return;
            }
        }
        this.target = newTarget;
        const bounds = (0, $0d2e1d696ad9a5e9$export$abe5643cba19555f)(newTarget);
        this.overlay.setBounds(bounds);
        if ((_b = this.options) === null || _b === void 0 ? void 0 : _b.onHover) this.options.onHover(newTarget);
    }
}





const $8ee96a0c35d6f15f$var$defaultOptions = {
    escapeEverything: false,
    isIdentifier: false,
    quotes: "backtick",
    wrap: false
};
const $8ee96a0c35d6f15f$var$regexAnySingleEscape = /[ -,\.\/:-@\[-\^`\{-~]/;
const $8ee96a0c35d6f15f$var$regexSingleEscape = /[ -,\.\/:-@\[\]\^`\{-~]/;
const $8ee96a0c35d6f15f$var$regexExcessiveSpaces = /(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g;
function $8ee96a0c35d6f15f$export$4d8ccb164339c234(string, opt = {}) {
    const options = {
        ...$8ee96a0c35d6f15f$var$defaultOptions,
        ...opt
    };
    if (options.quotes != "single" && options.quotes != "double") options.quotes = "backtick";
    const quote = options.quotes == "backtick" ? "`" : '"';
    const isIdentifier = options.isIdentifier;
    const firstChar = string.charAt(0);
    let output = "";
    let counter = 0;
    const length = string.length;
    while(counter < length){
        const character = string.charAt(counter++);
        let codePoint = character.charCodeAt(0);
        let value = void 0;
        // If it’s not a printable ASCII character…
        if (codePoint < 0x20 || codePoint > 0x7e) {
            if (codePoint >= 0xd800 && codePoint <= 0xdbff && counter < length) {
                // It’s a high surrogate, and there is a next character.
                const extra = string.charCodeAt(counter++);
                if ((extra & 0xfc00) == 0xdc00) // next character is low surrogate
                codePoint = ((codePoint & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000;
                else // It’s an unmatched surrogate; only append this code unit, in case
                // the next code unit is the high surrogate of a surrogate pair.
                counter--;
            }
            value = "\\" + codePoint.toString(16).toUpperCase() + " ";
        } else {
            if (options.escapeEverything) {
                if ($8ee96a0c35d6f15f$var$regexAnySingleEscape.test(character)) value = "\\" + character;
                else value = "\\" + codePoint.toString(16).toUpperCase() + " ";
            } else if (/[\t\n\f\r\x0B]/.test(character)) value = "\\" + codePoint.toString(16).toUpperCase() + " ";
            else if (character == "\\" || !isIdentifier && (character == '"' && quote == character || character == "'" && quote == character) || isIdentifier && $8ee96a0c35d6f15f$var$regexSingleEscape.test(character)) value = "\\" + character;
            else value = character;
        }
        output += value;
    }
    if (isIdentifier) {
        if (/^-[-\d]/.test(output)) output = "\\-" + output.slice(1);
        else if (/\d/.test(firstChar)) output = "\\3" + firstChar + " " + output.slice(1);
    }
    // Remove spaces after `\HEX` escapes that are not followed by a hex digit,
    // since they’re redundant. Note that this is only possible if the escape
    // sequence isn’t preceded by an odd number of backslashes.
    output = output.replace($8ee96a0c35d6f15f$var$regexExcessiveSpaces, function($0, $1, $2) {
        if ($1 && $1.length % 2) // It’s not safe to remove the space, so don’t.
        return $0;
        // Strip the space.
        return ($1 || "") + $2;
    });
    if (!isIdentifier && options.wrap) return quote + output + quote;
    return output;
}


const $eca5f0a74b1f1765$export$b81b7dbe03f7c121 = (el)=>!!$eca5f0a74b1f1765$export$c8a20044beb8a172(el);
const $eca5f0a74b1f1765$export$c8a20044beb8a172 = (el)=>$eca5f0a74b1f1765$export$e1f445cd6eeea85e(`.tabber-content>kendo-tabstrip>[role='tabpanel'][aria-hidden='false']`)(el);
const $eca5f0a74b1f1765$export$1391212d75b2ee65 = (ms)=>new Promise((res)=>setTimeout(()=>res(0), ms));
const $eca5f0a74b1f1765$export$218c8c3169c024d2 = (el)=>{
    let id;
    if (id = el?.getAttribute("data-test")) return `[data-test='${id}']`;
    if (id = el?.getAttribute("parent-data-test")) return `[parent-data-test='${id}']`;
    if (id = el?.getAttribute("cmpid")) return `[cmpid='${id}']`;
    if (id = el?.getAttribute("data-cy")) return `[data-cy='${id}']`;
    return null;
};
const $eca5f0a74b1f1765$export$4a647155031ece = (el)=>{
    let settings;
    if (settings = el?.getAttribute("data-settings")) return JSON.parse(settings);
    return null;
};
const $eca5f0a74b1f1765$export$e1f445cd6eeea85e = (to)=>(from, stopOn, count)=>{
        const upSelectorToPred = (s)=>s ? typeof s === "object" ? (el)=>el === s : typeof s === "string" ? (el)=>el.matches(s) : s : (_)=>false;
        const targetPred = upSelectorToPred(to);
        const untilPred = upSelectorToPred(stopOn);
        while(from && !untilPred(from) && (!count || count > 0)){
            if (targetPred(from)) return from;
            if (typeof stopOn === "string" && from.matches(stopOn)) return null;
            from = from.parentElement;
            if (count) count--;
        }
        return null;
    };
const $eca5f0a74b1f1765$export$917fd6776815e690 = (el)=>el.tagName.toLowerCase().startsWith("tb-") || el.tagName.toLowerCase().startsWith("kendo-");
const $eca5f0a74b1f1765$export$f831dd079c3be771 = (el)=>$eca5f0a74b1f1765$export$218c8c3169c024d2(el) !== null;
const $eca5f0a74b1f1765$export$494b4b5b7c25b002 = $eca5f0a74b1f1765$export$e1f445cd6eeea85e($eca5f0a74b1f1765$export$917fd6776815e690);
const $eca5f0a74b1f1765$export$9813b7426bbdbcc3 = $eca5f0a74b1f1765$export$e1f445cd6eeea85e($eca5f0a74b1f1765$export$f831dd079c3be771);
const $eca5f0a74b1f1765$export$8733e2af6851723d = $eca5f0a74b1f1765$export$e1f445cd6eeea85e((el)=>$eca5f0a74b1f1765$export$f831dd079c3be771(el) || $eca5f0a74b1f1765$export$917fd6776815e690(el));
const $eca5f0a74b1f1765$export$8e1077bc36a840e3 = $eca5f0a74b1f1765$export$e1f445cd6eeea85e((el)=>$eca5f0a74b1f1765$export$f831dd079c3be771(el) && $eca5f0a74b1f1765$export$917fd6776815e690(el));
const $eca5f0a74b1f1765$export$3bf645f08efe3292 = (el, ...tags)=>tags.some((t)=>el?.tagName.toLowerCase() === t.toLowerCase());
function $eca5f0a74b1f1765$export$aeca4cd84e0bb2a4(input, pred) {
    const names = Array.from(input.classList).filter(pred);
    return names.map((name)=>"." + (0, $8ee96a0c35d6f15f$export$4d8ccb164339c234)(name, {
            isIdentifier: true
        }));
}
function $eca5f0a74b1f1765$export$a1a11b095f88289a(css) {
    return css.trim();
}


const $2ed861787b256cca$export$4659b591c19bdf3d = (map)=>(selector)=>selector in map ? map[selector] : "_" in map ? map["_"] : null;
$2ed861787b256cca$export$4659b591c19bdf3d({
    bear: "roar",
    bird: "cip",
    cat: "miao",
    dog: "bau",
    horse: "boh"
})("dog");
$2ed861787b256cca$export$4659b591c19bdf3d({
    bear: "roar",
    bird: "cip",
    cat: "miao",
    _: "boh"
})("dog");




const $108fceddea91583c$var$kendoGridRowIndexAttr = "data-kendo-grid-item-index";
const $108fceddea91583c$var$kendoGridColIndexAttr = "data-kendo-grid-column-index";
const $108fceddea91583c$var$kendoTreelistRowIndexAttr = "data-treelist-view-index";
const $108fceddea91583c$var$kendoTreelistColIndexAttr = "aria-colindex";
class $108fceddea91583c$export$518e6c43c5b1c30e {
    static isComponent(target, tagName) {
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        return (0, $eca5f0a74b1f1765$export$3bf645f08efe3292)(anc, tagName);
    }
    static capture(target, parsedEvent, tag, command, selector, attribute) {
        console.log("GenericCommandComponent capture");
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        const value = this.getValue(target, selector, attribute);
        return (0, $100b2cdf1a1e5933$export$98d55a3b08386cd3)(command, parsedEvent)(id, target, {
            tag: tag,
            eventValue: value
        });
    }
    static getValue(target, selector, attribute) {
        if (selector) return target.querySelector(selector)?.getAttribute(attribute);
        else return target.getAttribute(attribute);
    }
}
class $108fceddea91583c$export$3047b0dd9385f89 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-item-source")(target) || (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)(".tb-popup-item-source-content")(target);
    }
    static async capture(target, parsedEvent, isPicker) {
        console.log("ItemSourceComponent capture");
        var ancParent = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        if (ancParent.getAttribute("data-test")?.startsWith("itemSourceDropDownButton")) return Promise.resolve(null);
        if (ancParent.getAttribute("data-test")?.startsWith("itemSourceAddOnFly")) return Promise.resolve(null);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(ancParent);
        const valueDataTest = document.querySelector(id).getAttribute("parent-data-test");
        if (valueDataTest) {
            await (0, $eca5f0a74b1f1765$export$1391212d75b2ee65)(100);
            var itemSource = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-item-source")(document.querySelector(`[data-test='${valueDataTest}']`));
            const value = this.getValueFromSelector(valueDataTest);
            return (0, $100b2cdf1a1e5933$export$98d55a3b08386cd3)("select", parsedEvent)((0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(itemSource), target, {
                tag: "ItemSource",
                eventValue: value
            });
        }
        if (isPicker) {
            var itemSourceInput = target.querySelector("[selected-id]") || target;
            var value1 = this.getValue(itemSourceInput);
            var itemSource = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-item-source")(itemSourceInput);
            return (0, $100b2cdf1a1e5933$export$98d55a3b08386cd3)("select", parsedEvent)(`${(0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(itemSource)} ${(0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(itemSourceInput)}`, itemSourceInput, {
                tag: "ItemSource",
                eventValue: value1
            });
        }
    }
    static getValueFromSelector(value) {
        var target = document.querySelector(`[data-test='${value}']`);
        return target?.getAttribute("selected-id");
    }
    static getValue(target) {
        return target?.getAttribute("selected-id");
    }
}
class $108fceddea91583c$export$40073d408f029a0b {
    static isComponent(target) {
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        return (0, $eca5f0a74b1f1765$export$3bf645f08efe3292)(anc, "tb-panel");
    }
    static capture(target, command, parsedEvent) {
        console.log("PanelComponent capture");
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        return command(id, target, {
            tag: "TbPanel",
            display: "expand/collapse",
            other: anc.classList.contains("collapsed") ? "expand" : "collapse"
        });
    }
}
class $108fceddea91583c$export$d9f24a445e3fa038 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-dynamic-checkbox-list")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("DynamicCheckboxComponent capture");
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        if (target.tagName == "LABEL" || target.tagName == "SPAN") return null;
        return command(id, target, {
            tag: "DynamicCheckbox",
            eventValue: target.parentElement.querySelector("label").innerText,
            eventKey: parsedEvent?.key
        });
    }
}
class $108fceddea91583c$export$ecaa49d2dbf56de5 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-treelist")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("KendoTreeListComponent capture");
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        let id = undefined;
        if (target.tagName == "TD") id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(target.querySelector("[data-test]"));
        else id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        if ((0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-treelist-toolbar")(target) && anc.attributes["data-test"]) return command(id, anc);
        //if (target.attributes["data-test"]) return cmd.click(id, target);
        const row = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tr[" + $108fceddea91583c$var$kendoTreelistRowIndexAttr + "]")(target);
        if (row === null) {
            console.error("[MCR] no row index found.", target);
            return null;
        }
        const idx = row.getAttribute($108fceddea91583c$var$kendoTreelistRowIndexAttr); //ng-reflect-data-row-index (indice totale) - data-treelist-view-index (indice paginato) - ng-reflect-logical-row-index (indice logico totale)
        const td = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("td")(target); //kendotreelistlogicalcell
        if ((target.tagName === "SPAN" || target.tagName === "DIV") && target.classList.contains("k-icon")) return command(id, target, {
            tag: target.classList.contains("k-i-caret-alt-right") || target.classList.contains("k-i-expand") ? "KendoTreelistExpand" : "KendoTreelistCollapse",
            idx: idx,
            nth: +td.getAttribute($108fceddea91583c$var$kendoTreelistColIndexAttr),
            eventValue: td.querySelector("span[data-test],div[data-test]") ? td.querySelector("span[data-test],div[data-test]")?.getAttribute("data-test") : ""
        });
        if (td.querySelectorAll("[data-test]").length === 0) return command(id, target, {
            tag: "KendoTreelistNativeCell",
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            idx: idx,
            nth: +td.getAttribute($108fceddea91583c$var$kendoTreelistColIndexAttr)
        });
        var settings = (0, $eca5f0a74b1f1765$export$4a647155031ece)(this.isComponent(target));
        return command(id, target, {
            tag: settings?.rowIndex ? "KendoTreelistRowIndex" : "KendoTreelist",
            idx: idx,
            nth: +td.getAttribute($108fceddea91583c$var$kendoGridColIndexAttr),
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            eventValue: td.querySelector("span[data-test]") ? td.querySelector("span[data-test]")?.getAttribute("data-test") : ""
        });
    }
}
class $108fceddea91583c$export$97fb74d06163c4cd {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-grid")(target);
    }
    static capture(target, command, parsedEvent) {
        let vv = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e);
        console.log("KendoGridComponent capture");
        if ((0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-grid-toolbar")(target)) return null;
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        if (id === (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target))) return null;
        let idx = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[" + $108fceddea91583c$var$kendoGridRowIndexAttr + "]")(target)?.getAttribute($108fceddea91583c$var$kendoGridRowIndexAttr);
        let nth = +(0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[" + $108fceddea91583c$var$kendoGridColIndexAttr + "]")(target)?.getAttribute($108fceddea91583c$var$kendoGridColIndexAttr);
        if (!idx) return command(id, target, {
            tag: `KendoGrid`,
            idx: idx,
            nth: nth,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "click kendo grid"
        });
        if ((0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-grid")(target)) return command(id, target, {
            tag: `KendoGridRowIndex`,
            idx: idx,
            nth: nth,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "click grid index"
        });
    }
}
class $108fceddea91583c$export$1d82713ecf271015 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-be")(target);
    }
    static capture(target, command, parsedEvent) {
        let vv = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e);
        console.log("BodyEditComponent capture");
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        let idx = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[" + $108fceddea91583c$var$kendoGridRowIndexAttr + "]")(target)?.getAttribute($108fceddea91583c$var$kendoGridRowIndexAttr);
        let nth = +(0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[" + $108fceddea91583c$var$kendoGridColIndexAttr + "]")(target)?.getAttribute($108fceddea91583c$var$kendoGridColIndexAttr);
        if (id == (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)) && (!idx || target.classList.contains("k-grid-content"))) return command("[data-test='bodyEditPagerNumberDismissFocus']", target, {
            tag: "BodyEdit",
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target))
        });
        if (id && !idx && target.closest("kendo-grid thead tr > th")) return command(id, target, {
            tag: `BodyEdit`,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "click body edit header"
        });
        if (id && !idx && target.closest("tb-ev")) return command(id, target, {
            tag: `BEditView`,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "body edit view"
        });
        if (target.classList.contains("dummyRow")) return command(id, target, {
            tag: `BodyEditDummyRow`,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "add row"
        });
        if ((0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-grid")(target)) return command(id, target, {
            tag: `BodyEditRow`,
            idx: idx,
            nth: nth,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "click body grid"
        });
        else return command(id, target, {
            tag: `BodyEdit`,
            mainComponent: (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(this.isComponent(target)),
            display: "click body edit"
        });
    }
}
class $108fceddea91583c$export$94c9456df3c9d7b1 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-window")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("WindowComponent capture");
        const el = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(el);
        if (target.tagName == "SPAN" && target.parentElement?.hasAttribute("kendowindowcloseaction") || target.tagName == "BUTTON" && target.hasAttribute("kendowindowcloseaction")) return command("Kendo-Window", target, {
            tag: "WindowClose",
            display: "close window"
        });
        return command(id, target, {
            tag: "Window" /*, scope: 'All'*/ 
        });
    }
}
class $108fceddea91583c$export$24ec15341293d56f {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-dialog")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("DialogComponent capture");
        const el = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(el);
        if ((0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-dialog-actions")(target)) {
            if (target.closest("mc-scheduler-app")) return command("text=" + target.closest("button").querySelector(".k-button-text").innerText, target.closest("button"), {
                tag: "DialogActionsScheduler",
                display: "dialog actions"
            });
            return command(id ? id : "kendo-dialog", target, {
                tag: "DialogActions",
                display: "dialog actions"
            });
        }
        if (!el && (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-dialog-titlebar")(target) && target.tagName == "SPAN" && target.parentElement?.hasAttribute("title") && target.parentElement.getAttribute("aria-label") == "Close" || target.tagName == "BUTTON" && target.hasAttribute("title") && target.getAttribute("aria-label") == "Close") return command("Kendo-Dialog", target, {
            tag: "DialogClose",
            display: "close dialog"
        });
        if (!id) return null;
        return command(id, target, {
            tag: "Dialog" /*, scope: 'All'*/ 
        });
    }
}
class $108fceddea91583c$export$9cca54ee596bd686 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-dockpane-container")(target);
    }
    static isDesignState(target) {
        return !!(0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-dockpane-container.tb-design-state")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("DockerComponent capture");
        //const wrap = { up, upToId, upToCtrlWithId, getId };
        var tabberSelectorTarget = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)(".dockpane-tabber-selector")(target);
        if (tabberSelectorTarget == null) {
            var container = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-dockpane-container")(target);
            var tabberSelector = container.querySelector(".dockpane-tabber-selector ul li.active");
            const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(tabberSelector);
            return command(id, tabberSelector, {
                tag: "DockPane"
            });
        }
        return null;
    }
}
class $108fceddea91583c$export$5dab2a3f827061f6 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-upload")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("KendoUploadComponent capture");
        if (target.tagName == "INPUT" && target.parentElement.classList.contains("k-upload-button")) return command("kendo-upload div.k-upload-button input", target, {
            tag: "KendoUpload",
            display: "select file"
        });
        if (target.tagName == "BUTTON" && target.classList.contains("k-upload-selected")) return command("kendo-upload-action-buttons button.k-upload-selected", target, {
            tag: "KendoUpload",
            display: "upload file"
        });
        if (target.tagName == "BUTTON" && target.classList.contains("k-clear-selected")) return command("kendo-upload-action-buttons button.k-clear-selected", target, {
            tag: "KendoUpload",
            display: "clear file selected"
        });
        return null;
    }
}
class $108fceddea91583c$export$9ea6347596840518 {
    static isComponent(target) {
        return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-radar-customisable-grid")(target);
    }
    static capture(target, command, parsedEvent) {
        console.log("RadarComponent capture");
        let vv = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e);
        const ownerDoc = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)((el)=>el.tagName.startsWith("TB-IDD"))(target);
        const row = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tr[" + $108fceddea91583c$var$kendoGridRowIndexAttr + "]")(target);
        if (row === null) {
            console.error("[MCR] no row index found.", target);
            return null;
        }
        const idx = row.getAttribute($108fceddea91583c$var$kendoGridRowIndexAttr);
        const el = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        const id = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(el);
        const isWebStyle = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("kendo-grid")(target)?.classList?.contains("mode1");
        return command(id, target, {
            tag: isWebStyle ? "TbRadarWebStyle" : "TbRadarTableStyle",
            parent: ownerDoc?.tagName,
            idx: idx,
            display: "radar: click row " + idx
        });
    }
}


const $100b2cdf1a1e5933$var$capturingControls = [
    "tb-date-edit",
    "tb-application-date",
    "tb-enum-combo",
    "kendo-dropdownlist",
    "kendo-combobox",
    "kendo-multicolumncombobox",
    "kendo-multiselect"
]; // TS 3.4
const $100b2cdf1a1e5933$var$ctrl = {
    needsCapture: (el)=>(0, $eca5f0a74b1f1765$export$3bf645f08efe3292)(el, ...$100b2cdf1a1e5933$var$capturingControls),
    capturedValue: (capturedBy)=>(0, $2ed861787b256cca$export$4659b591c19bdf3d)({
            "tb-enum-combo": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, "[selected-code]", "selected-code"),
            "kendo-dropdownlist": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, undefined, "selected-code"),
            "kendo-multiselect": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, undefined, "selected-code"),
            "kendo-combobox": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, undefined, "selected-code"),
            "kendo-multicolumncombobox": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, undefined, "selected-code"),
            "tb-date-edit": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, "textarea, input", "selected-date"),
            "tb-application-date": ()=>(0, $108fceddea91583c$export$518e6c43c5b1c30e).getValue(capturedBy, "textarea, input", "selected-date"),
            _: ()=>capturedBy.querySelector("textarea, input")?.value
        })(capturedBy.tagName.toLowerCase())()
};
const $100b2cdf1a1e5933$var$handleCapturingControls = (()=>{
    let capturedBy = null;
    let oldValue = "";
    return async (target, parsedEvent)=>{
        console.log("handleCapturingControls capturedBy", capturedBy?.tagName);
        let vv = $100b2cdf1a1e5933$var$ctrl;
        const capture = ()=>{
            oldValue = "";
            capturedBy = $100b2cdf1a1e5933$var$ctrl.needsCapture(tmp) ? tmp : null;
            oldValue = capturedBy ? $100b2cdf1a1e5933$var$ctrl.capturedValue(capturedBy) : "";
            return capturedBy;
        };
        const tmp = (0, $eca5f0a74b1f1765$export$8e1077bc36a840e3)(target);
        if (capturedBy === null) return [
            [],
            capture()
        ];
        if (capturedBy && (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("cdk-virtual-scroll-viewport, kendo-calendar, kendo-list")(target)) return [
            [],
            capturedBy
        ];
        const outsideOfActiveCtrl = tmp === null && capturedBy !== null && !capturedBy.contains(target);
        const activeCtrlChanged = outsideOfActiveCtrl || tmp !== capturedBy || parsedEvent.action === (0, $1aae169a1a51f082$export$3d7865934588d77e).KEYDOWN && parsedEvent.key === "Tab";
        if (!activeCtrlChanged) return [
            [],
            capturedBy
        ];
        //await delay(100);
        const value = $100b2cdf1a1e5933$var$ctrl.capturedValue(capturedBy);
        console.log("handleCapturingControls control value", value, oldValue, capturedBy?.tagName);
        if (value === oldValue) return [
            [],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "tb-enum-combo")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, "EnumCombo", "select", "[selected-code]", "selected-code")
            ],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "kendo-dropdownlist")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, "KendoDropdownlist", "select", undefined, "selected-code")
            ],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "kendo-multiselect")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, "KendoDropdownlist", "select", undefined, "selected-code")
            ],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "kendo-combobox")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, "KendoDropdownlist", "select", undefined, "selected-code")
            ],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "kendo-multicolumncombobox")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, "KendoDropdownlist", "select", undefined, "selected-code")
            ],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "tb-date-edit")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, undefined, "write", "textarea, input", "selected-date")
            ],
            capture()
        ];
        if ((0, $108fceddea91583c$export$518e6c43c5b1c30e).isComponent(capturedBy, "tb-application-date")) return [
            [
                (0, $108fceddea91583c$export$518e6c43c5b1c30e).capture(capturedBy, parsedEvent, undefined, "write", "textarea, input", "selected-date")
            ],
            capture()
        ];
        return [
            [],
            capture()
        ];
    };
})();
const $100b2cdf1a1e5933$var$toopt = (selector, el, options, parsedEvent)=>{
    options = options ?? {};
    if (parsedEvent?.value !== null && parsedEvent?.value !== undefined && parsedEvent?.value.length >= 0 && !options.eventValue) options.eventValue = parsedEvent?.value.toString().replace(/'/g, "\\'");
    if (parsedEvent?.key && !options.eventKey) options.eventKey = parsedEvent?.key.toString().replace(/'/g, "\\'");
    if (parsedEvent?.modifiers?.length > 0) options.keyboardModifier = parsedEvent.modifiers;
    if (parsedEvent?.pageIndex !== undefined) options.pageIndex = parsedEvent.pageIndex;
    options.force = !!(el?.hasAttribute("disabled") || el?.getAttribute("disabled"));
    options.retry = false;
    if (!options?.scope && !(0, $eca5f0a74b1f1765$export$b81b7dbe03f7c121)(el)) return {
        ...options,
        scope: "all"
    };
    if (options) return options;
    return {};
};
const $100b2cdf1a1e5933$export$98d55a3b08386cd3 = (cmd, parsedEvent)=>(selector, target, options)=>{
        return {
            Type: cmd,
            Selector: (0, $8ee96a0c35d6f15f$export$4d8ccb164339c234)(selector) + $100b2cdf1a1e5933$var$getTagName(target),
            Options: $100b2cdf1a1e5933$var$toopt(selector, target, options, parsedEvent)
        };
    };
// export const cmd = {
//   write: tocmd("write"),
//   select: tocmd("select"),
//   click: tocmd("click"),
//   keydown: tocmd("keydown"),
//   pick: tocmd("pick"),
// };
let $100b2cdf1a1e5933$var$pendingDrag = undefined;
let $100b2cdf1a1e5933$var$skipFind = false;
function $100b2cdf1a1e5933$var$getTagName(target) {
    if (target.attributes["data-test"] || target.attributes["data-cy"] || target.attributes["cmpId"]) return "";
    var element = (0, $eca5f0a74b1f1765$export$8e1077bc36a840e3)(target);
    if (!element) return "";
    if (element.tagName.startsWith("TB-")) {
        var e = target.tagName.toLowerCase();
        if ([
            "input",
            "select",
            "textarea"
        ].includes(e)) return " " + e;
        else if ((0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(target.closest("button")) == null && element.contains(target.closest("button"))) return " button";
    }
    return "";
}
function $100b2cdf1a1e5933$var$evaluatePostWaitCommand(target, res, parsedEvent) {
    if (parsedEvent?.modifiers?.includes("Control")) return $100b2cdf1a1e5933$export$98d55a3b08386cd3("wait", parsedEvent)("", target, {
        value: "5000"
    });
    return null;
}
function $100b2cdf1a1e5933$var$evaluatePreWaitCommand(target, res, parsedEvent) {
    var selectors, attr;
    return res; // disabilitato per il momento
}
async function $100b2cdf1a1e5933$export$e580b1cbf68957c3(target, command, parsedEvent, res = [], picker = false) {
    try {
        var firstClosestId = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(target);
        //if (firstClosestId?.hasAttribute("disabled")) return res; //hyperlink ora lo registro
        if ((0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("tb-checkbox")(target) && !target.matches(`input[type='checkbox']`)) return res;
        res = $100b2cdf1a1e5933$var$evaluatePreWaitCommand(target, res, parsedEvent);
        let com = undefined;
        let dockPanecCom = undefined;
        if (!(0, $108fceddea91583c$export$9cca54ee596bd686).isDesignState(target) && (0, $108fceddea91583c$export$9cca54ee596bd686).isComponent(target) && !com && picker === false) dockPanecCom = (0, $108fceddea91583c$export$9cca54ee596bd686).capture(target, command, parsedEvent);
        if ((0, $108fceddea91583c$export$3047b0dd9385f89).isComponent(target)) com = await (0, $108fceddea91583c$export$3047b0dd9385f89).capture(target, parsedEvent, picker);
        if ((0, $108fceddea91583c$export$5dab2a3f827061f6).isComponent(target) && !com) com = (0, $108fceddea91583c$export$5dab2a3f827061f6).capture(target, command, parsedEvent);
        if ((0, $108fceddea91583c$export$9ea6347596840518).isComponent(target) && !com) com = (0, $108fceddea91583c$export$9ea6347596840518).capture(target, command, parsedEvent);
        if (((0, $108fceddea91583c$export$97fb74d06163c4cd).isComponent(target) || (0, $108fceddea91583c$export$1d82713ecf271015).isComponent(target)) && !com) {
            if ((0, $108fceddea91583c$export$1d82713ecf271015).isComponent(target) && !com) com = (0, $108fceddea91583c$export$1d82713ecf271015).capture(target, command, parsedEvent); //tb-be
            else com = (0, $108fceddea91583c$export$97fb74d06163c4cd).capture(target, command, parsedEvent); //kendo-grid semplice
        }
        if ((0, $108fceddea91583c$export$ecaa49d2dbf56de5).isComponent(target) && !com) com = (0, $108fceddea91583c$export$ecaa49d2dbf56de5).capture(target, command, parsedEvent);
        if ((0, $108fceddea91583c$export$d9f24a445e3fa038).isComponent(target) && !com) com = (0, $108fceddea91583c$export$d9f24a445e3fa038).capture(target, command, parsedEvent);
        if ((0, $108fceddea91583c$export$40073d408f029a0b).isComponent(target) && !com) com = (0, $108fceddea91583c$export$40073d408f029a0b).capture(target, command, parsedEvent);
        if ((0, $108fceddea91583c$export$24ec15341293d56f).isComponent(target) && !com) com = (0, $108fceddea91583c$export$24ec15341293d56f).capture(target, command, parsedEvent);
        if ((0, $108fceddea91583c$export$94c9456df3c9d7b1).isComponent(target) && !com) com = (0, $108fceddea91583c$export$94c9456df3c9d7b1).capture(target, command, parsedEvent);
        if (com) return [
            ...res,
            dockPanecCom,
            com
        ];
        console.log("generic selector for target: ", target, firstClosestId, (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(firstClosestId));
        if (!firstClosestId && parsedEvent.action !== "keydown") {
            console.log("firstClosestId not found");
            return res;
        }
        return [
            ...res,
            dockPanecCom,
            command(firstClosestId ? (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(firstClosestId) : "[data-test-app-root]", target, {
                force: false
            })
        ];
    } catch (error) {
        console.error(error);
    }
}
async function $100b2cdf1a1e5933$export$dc1aaf6398cf38a9(fromElement, toElement, parsedEvent) {
    try {
        var anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(fromElement.target);
        const fromId = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        anc = (0, $eca5f0a74b1f1765$export$9813b7426bbdbcc3)(toElement.target);
        const toId = (0, $eca5f0a74b1f1765$export$218c8c3169c024d2)(anc);
        return [
            $100b2cdf1a1e5933$export$98d55a3b08386cd3("dragdrop", parsedEvent)(toId, toElement.target, {
                tag: "DragDrop",
                fromSelector: fromId
            })
        ];
    } catch (error) {
        console.error(error);
    }
    return [];
}
async function $100b2cdf1a1e5933$var$magofind(event, parsedEvent) {
    if ($100b2cdf1a1e5933$var$skipFind) {
        console.log("[MCR] find skipped.", event, parsedEvent);
        return [];
    }
    let target = event.target;
    if ($100b2cdf1a1e5933$var$skip(event, parsedEvent)) return [];
    $100b2cdf1a1e5933$var$skipFind = true;
    const [res, capturedBy] = await $100b2cdf1a1e5933$var$handleCapturingControls(target, parsedEvent);
    $100b2cdf1a1e5933$var$skipFind = false;
    if (capturedBy !== null) return res;
    let command = undefined;
    switch(parsedEvent.action){
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).DRAGSTART:
            $100b2cdf1a1e5933$var$pendingDrag = event;
            return [];
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).DROP:
            if (!$100b2cdf1a1e5933$var$pendingDrag) return [];
            return $100b2cdf1a1e5933$export$dc1aaf6398cf38a9($100b2cdf1a1e5933$var$pendingDrag, event, parsedEvent);
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).CHANGE:
            command = $100b2cdf1a1e5933$export$98d55a3b08386cd3("write", parsedEvent);
            return $100b2cdf1a1e5933$export$e580b1cbf68957c3(target, command, parsedEvent, res);
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).KEYDOWN:
            {
                command = $100b2cdf1a1e5933$export$98d55a3b08386cd3("keydown", parsedEvent);
                const keyTypesAccepted = [
                    (0, $1aae169a1a51f082$export$75972070afd93869).ESCAPE,
                    (0, $1aae169a1a51f082$export$75972070afd93869).F1,
                    (0, $1aae169a1a51f082$export$75972070afd93869).F2,
                    (0, $1aae169a1a51f082$export$75972070afd93869).F3,
                    (0, $1aae169a1a51f082$export$75972070afd93869).F7,
                    (0, $1aae169a1a51f082$export$75972070afd93869).F10
                ]; //tab da gestire
                if (!keyTypesAccepted.map((x)=>x.toString()).includes(parsedEvent.key)) return res;
                return $100b2cdf1a1e5933$export$e580b1cbf68957c3(document.activeElement, command, parsedEvent, res);
            }
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).DBLCLICK:
            command = $100b2cdf1a1e5933$export$98d55a3b08386cd3("dblclick", parsedEvent);
            return $100b2cdf1a1e5933$export$e580b1cbf68957c3(target, command, parsedEvent, res);
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).CONTEXTMENU:
        case (0, $1aae169a1a51f082$export$3d7865934588d77e).CLICK:
            command = $100b2cdf1a1e5933$export$98d55a3b08386cd3("click", parsedEvent);
            return $100b2cdf1a1e5933$export$e580b1cbf68957c3(target, command, parsedEvent, res);
    }
    return res;
}
const $100b2cdf1a1e5933$var$skip = (_, parsedEvent)=>(parsedEvent.action === (0, $1aae169a1a51f082$export$3d7865934588d77e).CHANGE || parsedEvent.action === (0, $1aae169a1a51f082$export$3d7865934588d77e).KEYDOWN) && (parsedEvent.inputType === "checkbox" || parsedEvent.inputType === "radio");
async function $100b2cdf1a1e5933$export$2e2bcd8739ae039(event) {
    //console.log('parseEvent', event);
    const parsedEvent = {
        action: event.type,
        tag: event.target.tagName,
        value: [
            "checkbox",
            "radio"
        ].includes(event.target.type) ? event.target.checked + "" : event.target.value,
        pageIndex: window["___mcr___pageIndex"] !== undefined ? window["___mcr___pageIndex"] : 0
    };
    if (event.target.hasAttribute("href")) parsedEvent.href = event.target.href;
    if (event.target.hasAttribute("id")) parsedEvent.id = event.target.id;
    if (parsedEvent.tag === "INPUT") parsedEvent.inputType = event.target.type;
    if (event.type === "keydown") parsedEvent.key = event.key;
    var modifiers = [
        "Alt",
        "Control",
        "Meta",
        "Shift"
    ];
    parsedEvent.modifiers = [];
    modifiers.forEach((mod)=>{
        if ((event instanceof KeyboardEvent || event instanceof PointerEvent) && event.getModifierState(mod)) parsedEvent.modifiers.push(mod);
    });
    let res = await $100b2cdf1a1e5933$var$magofind(event, parsedEvent);
    res = res.filter((x)=>!!x); //tolgo i nulli
    console.log("res: ", res);
    return res.map((x)=>({
            ...x,
            EventType: parsedEvent.action
        })).map((command)=>({
            ...parsedEvent,
            command: command
        }));
}



function $4068186cacd1ad2c$var$handleEvent(event) {
    if (!event.isTrusted) return;
    (0, $100b2cdf1a1e5933$export$2e2bcd8739ae039)(event).then((e)=>{
        if (window["___mcr___send"]) window["___mcr___send"](JSON.stringify({
            type: "commands",
            content: JSON.stringify(e.map((x)=>x.command))
        }));
    });
}
function $4068186cacd1ad2c$var$addDOMListeners() {
    if (window["___mcr___isListening"]) {
        console.error("[mcr] addDOMListeners: already listening");
        return;
    }
    window["___mcr___isListening"] = true;
    Object.values((0, $1aae169a1a51f082$export$3d7865934588d77e)).forEach((event)=>{
        document.addEventListener(event, $4068186cacd1ad2c$var$handleEvent, {
            capture: true,
            passive: true
        });
    });
    console.log("[mcr] addDOMListeners: done");
}
function $4068186cacd1ad2c$var$removeDOMListeners() {
    if (!window["___mcr___isListening"]) {
        console.log("[mcr] removeDOMListeners: already not listening");
        return;
    }
    delete window["___mcr___isListening"];
    Object.values((0, $1aae169a1a51f082$export$3d7865934588d77e)).forEach((event)=>{
        document.removeEventListener(event, $4068186cacd1ad2c$var$handleEvent, {
            capture: true
        });
    });
    console.log("[mcr] removeDOMListeners: done");
}
async function $4068186cacd1ad2c$var$pick(uid) {
    const picker = new (0, $7c5d4ec7fb1c475d$export$2e2bcd8739ae039)();
    picker.start({
        elementFilter: (el)=>{
            return (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[cmpid]")(el) || (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[data-test]")(el) || (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[data-cy]")(el);
        },
        onHover: (el)=>console.log(el),
        onClick: async (el)=>{
            picker.stop();
            console.log(`Picked: ${el}`);
            const ctrl = (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[cmpid]")(el) || (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[data-test]")(el) || (0, $eca5f0a74b1f1765$export$e1f445cd6eeea85e)("[data-cy]")(el);
            if (!ctrl) return;
            const parsedEvent = {
                action: "pick",
                tag: el.tagName,
                value: el.value,
                pageIndex: window["___mcr___pageIndex"]
            };
            var res = await (0, $100b2cdf1a1e5933$export$e580b1cbf68957c3)(el, (0, $100b2cdf1a1e5933$export$98d55a3b08386cd3)("pick", parsedEvent), parsedEvent, [], true);
            res = res.filter((x)=>!!x); //tolgo i nulli
            res.map((x)=>{
                if (x.Options) {
                    var el = document.querySelectorAll(x.Selector);
                    for(var i = 0; i < el.length; i++){
                        var xx = el[i].closest(".tabber-content>kendo-tabstrip>[role='tabpanel'][aria-hidden='false']");
                        if (!xx) continue;
                        x.Options.scope = "Document";
                    }
                    if (!x.Options.scope) x.Options.scope = "All";
                }
            });
            let value = "";
            if (res.length === 1) {
                var sel = document.querySelector(res[0].Selector);
                if (sel instanceof HTMLInputElement) value = sel.value;
                else value = sel.querySelector("input,textarea")?.value;
                res[0].Options.value = value;
            }
            console.log("Element picker", res, value);
            if (window["___mcr___send"]) window["___mcr___send"](JSON.stringify({
                type: "pick",
                content: JSON.stringify(res),
                uid: uid,
                value: value
            }));
        }
    });
}
async function $4068186cacd1ad2c$var$setPageIndex(index) {
    window["___mcr___pageIndex"] = index;
}
function $4068186cacd1ad2c$var$initialize() {
    window["___mcr___injected"] = true;
    window["___mcr___startListening"] = $4068186cacd1ad2c$var$addDOMListeners;
    window["___mcr___stopListening"] = $4068186cacd1ad2c$var$removeDOMListeners;
    window["___mcr___page"] = $4068186cacd1ad2c$var$setPageIndex;
    window["___mcr___pick"] = $4068186cacd1ad2c$var$pick;
}
$4068186cacd1ad2c$var$initialize();

})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJtYXBwaW5ncyI6IjtBQ0FBLElBQU87VUFBSyxTQUFTO0lBQVQsVUFDVixXQUFRO0lBREUsVUFFVixZQUFTO0lBRkMsVUFHVixjQUFXO0lBSEQsVUFJVixhQUFVO0lBSkEsVUFLVixZQUFTO0lBTEMsVUFNVixpQkFBYztJQU5KLFVBT1YsZUFBWTtJQVBGLFVBUVYsVUFBTztHQVJHLDhDQUFBO0lBV0w7VUFBSyxXQUFXO0lBQVgsWUFBYyxZQUFTO0lBQXZCLFlBQWlDLFFBQUE7SUFBakMsWUFBNEMsUUFBQTtJQUE1QyxZQUF1RCxRQUFBO0lBQXZELFlBQWtFLFFBQUE7SUFBbEUsWUFBNkUsU0FBQTtJQUE3RSxZQUEwRixTQUFNO0dBQWhHLDhDQUFBO0lBRUw7VUFBSyxhQUFhO0lBQWIsY0FBQSxjQUNWLFdBQUEsS0FBQTtJQURVLGNBQUEsY0FFVixVQUFBLEtBQUE7SUFGVSxjQUFBLGNBR1YsV0FBQSxLQUFBO0lBSFUsY0FBQSxjQUlWLFlBQUEsS0FBQTtJQUpVLGNBQUEsY0FLVixVQUFBLEtBQUE7SUFMVSxjQUFBLGNBTVYsVUFBQSxLQUFBO0lBTlUsY0FBQSxjQU9WLFVBQUEsS0FBQTtJQVBVLGNBQUEsY0FRVixVQUFBLEtBQUE7R0FSVSw4Q0FBQTtJQVdMO1VBQUssUUFBUTtJQUFSLFNBQUEsU0FDVixRQUFBLEtBQUE7SUFEVSxTQUFBLFNBRVYsU0FBQSxLQUFBO0lBRlUsU0FBQSxTQUdWLFlBQUEsS0FBQTtHQUhVLDhDQUFBOztBRHhCWjtBSUFlO0lBQ1gsWUFBWSxPQUFPLENBQUU7UUFDakIsSUFBSSxJQUFJLElBQUksSUFBSSxJQUFJLElBQUksSUFBSSxJQUFJLElBQUk7UUFDcEMsSUFBSSxDQUFDLE9BQU8sR0FBRyxTQUFTLGFBQWEsQ0FBQztRQUN0QyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsR0FBRyxRQUFRLFNBQVMsSUFBSTtRQUM5QyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxVQUFVLEdBQUcsQUFBQyxDQUFBLEFBQUMsQ0FBQSxLQUFLLFFBQVEsS0FBSyxBQUFELE1BQU8sSUFBSSxJQUFJLE9BQU8sS0FBSyxJQUFJLEtBQUssSUFBSSxHQUFHLFVBQVUsQUFBRCxLQUFNO1FBQzdHLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFdBQVcsR0FBRyxBQUFDLENBQUEsQUFBQyxDQUFBLEtBQUssUUFBUSxLQUFLLEFBQUQsTUFBTyxJQUFJLElBQUksT0FBTyxLQUFLLElBQUksS0FBSyxJQUFJLEdBQUcsV0FBVyxBQUFELEtBQU07UUFDL0csSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsV0FBVyxHQUFHLEFBQUMsQ0FBQSxBQUFDLENBQUEsS0FBSyxRQUFRLEtBQUssQUFBRCxNQUFPLElBQUksSUFBSSxPQUFPLEtBQUssSUFBSSxLQUFLLElBQUksR0FBRyxXQUFXLEFBQUQsS0FBTTtRQUMvRyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLEdBQUcsQUFBQyxDQUFBLEFBQUMsQ0FBQSxLQUFLLFFBQVEsS0FBSyxBQUFELE1BQU8sSUFBSSxJQUFJLE9BQU8sS0FBSyxJQUFJLEtBQUssSUFBSSxHQUFHLFlBQVksQUFBRCxLQUFNO1FBQ2pILElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFdBQVcsR0FBRyxBQUFDLENBQUEsQUFBQyxDQUFBLEtBQUssUUFBUSxLQUFLLEFBQUQsTUFBTyxJQUFJLElBQUksT0FBTyxLQUFLLElBQUksS0FBSyxJQUFJLEdBQUcsV0FBVyxBQUFELEtBQU07UUFDL0csSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsU0FBUyxHQUFHLEFBQUMsQ0FBQSxBQUFDLENBQUEsS0FBSyxRQUFRLEtBQUssQUFBRCxNQUFPLElBQUksSUFBSSxPQUFPLEtBQUssSUFBSSxLQUFLLElBQUksR0FBRyxTQUFTLEFBQUQsS0FBTTtRQUMzRyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQUFBQyxDQUFBLEFBQUMsQ0FBQSxLQUFLLFFBQVEsS0FBSyxBQUFELE1BQU8sSUFBSSxJQUFJLE9BQU8sS0FBSyxJ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WixJQUFJLElBQUksTUFBTSxLQUFLLEdBQUc7Z0JBQ2xCLElBQUksTUFBTSxTQUFTLGFBQWEsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLFFBQVE7Z0JBQ2hELElBQUksZUFBZSxrQkFDZixRQUFRLElBQUksS0FBSztxQkFDaEIsUUFBUyxJQUFJLGFBQWEsQ0FBQyxtQkFBd0M7Z0JBQ3hFLEdBQUcsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLEtBQUssR0FBRztZQUMzQixDQUFDO1lBQ0QsUUFBUSxHQUFHLENBQUMsa0JBQWtCLEtBQUs7WUFFbkMsSUFBSSxNQUFNLENBQUMsZ0JBQWdCLEVBQ3ZCLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLFNBQVMsQ0FBQztnQkFBRSxNQUFNO2dCQUFRLFNBQVMsS0FBSyxTQUFTLENBQUM7cUJBQU07dUJBQUs7WUFBTTtRQUN4RztJQUNKO0FBQ0o7QUFFQSxlQUFlLG1DQUFhLEtBQWEsRUFBRTtJQUN2QyxNQUFNLENBQUMscUJBQXFCLEdBQUc7QUFDbkM7QUFFQSxTQUFTLG1DQUFtQjtJQUN4QixNQUFNLENBQUMsb0JBQW9CLEdBQUcsSUFBSTtJQUNsQyxNQUFNLENBQUMsMEJBQTBCLEdBQUc7SUFDcEMsTUFBTSxDQUFDLHlCQUF5QixHQUFHO0lBQ25DLE1BQU0sQ0FBQyxnQkFBZ0IsR0FBRztJQUMxQixNQUFNLENBQUMsZ0JBQWdCLEdBQUc7QUFDOUI7QUFFQSIsInNvdXJjZXMiOlsiaW50ZXJjZXB0b3IudHMiLCJ0eXBlcy50cyIsIm5vZGVfbW9kdWxlcy9waWNrLWRvbS1lbGVtZW50L2Rpc3QvaW5kZXguanMiLCJub2RlX21vZHVsZXMvcGljay1kb20tZWxlbWVudC9kaXN0L2VsZW1lbnQtcGlja2VyLmpzIiwibm9kZV9tb2R1bGVzL3BpY2stZG9tLWVsZW1lbnQvZGlzdC9lbGVtZW50LW92ZXJsYXkuanMiLCJub2RlX21vZHVsZXMvcGljay1kb20tZWxlbWVudC9kaXN0L3V0aWxzLmpzIiwiZXZlbnRQYXJzZXIudHMiLCJ1LnRzIiwiY3NzZXNjLnRzIiwibWF0Y2hlci50cyIsImNhcHRvcnMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tbWFuZCwgRXZlbnRUeXBlLCBQYXJzZWRFdmVudCB9IGZyb20gXCIuL3R5cGVzXCI7XHJcbmltcG9ydCB7IEVsZW1lbnRQaWNrZXIgfSBmcm9tIFwicGljay1kb20tZWxlbWVudFwiO1xyXG5pbXBvcnQgcGFyc2VFdmVudCwgeyBjYXB0dXJlRXZlbnRBdHRyaWJ1dGVzLCB0b2NtZCB9IGZyb20gXCIuL2V2ZW50UGFyc2VyXCI7XHJcbmltcG9ydCB7IHVwIH0gZnJvbSBcIi4vdVwiO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlRXZlbnQoZXZlbnQ6IEV2ZW50KTogdm9pZCB7XHJcbiAgICBpZiAoIWV2ZW50LmlzVHJ1c3RlZCkgcmV0dXJuO1xyXG4gICAgcGFyc2VFdmVudChldmVudCkudGhlbigoZSkgPT4ge1xyXG4gICAgICAgIGlmICh3aW5kb3dbXCJfX19tY3JfX19zZW5kXCJdKVxyXG4gICAgICAgICAgICB3aW5kb3dbXCJfX19tY3JfX19zZW5kXCJdKFxyXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiY29tbWFuZHNcIixcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBKU09OLnN0cmluZ2lmeShlLm1hcCgoeCkgPT4geC5jb21tYW5kKSksXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICApO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZERPTUxpc3RlbmVycygpOiB2b2lkIHtcclxuICAgIGlmICh3aW5kb3dbXCJfX19tY3JfX19pc0xpc3RlbmluZ1wiXSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJbbWNyXSBhZGRET01MaXN0ZW5lcnM6IGFscmVhZHkgbGlzdGVuaW5nXCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHdpbmRvd1tcIl9fX21jcl9fX2lzTGlzdGVuaW5nXCJdID0gdHJ1ZTtcclxuICAgIE9iamVjdC52YWx1ZXMoRXZlbnRUeXBlKS5mb3JFYWNoKChldmVudCkgPT4ge1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZUV2ZW50LCB7XHJcbiAgICAgICAgICAgIGNhcHR1cmU6IHRydWUsXHJcbiAgICAgICAgICAgIHBhc3NpdmU6IHRydWUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIGNvbnNvbGUubG9nKFwiW21jcl0gYWRkRE9NTGlzdGVuZXJzOiBkb25lXCIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVET01MaXN0ZW5lcnMoKTogdm9pZCB7XHJcbiAgICBpZiAoIXdpbmRvd1tcIl9fX21jcl9fX2lzTGlzdGVuaW5nXCJdKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJbbWNyXSByZW1vdmVET01MaXN0ZW5lcnM6IGFscmVhZHkgbm90IGxpc3RlbmluZ1wiKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBkZWxldGUgd2luZG93W1wiX19fbWNyX19faXNMaXN0ZW5pbmdcIl07XHJcbiAgICBPYmplY3QudmFsdWVzKEV2ZW50VHlwZSkuZm9yRWFjaCgoZXZlbnQpID0+IHtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVFdmVudCwgeyBjYXB0dXJlOiB0cnVlIH0pO1xyXG4gICAgfSk7XHJcbiAgICBjb25zb2xlLmxvZyhcIlttY3JdIHJlbW92ZURPTUxpc3RlbmVyczogZG9uZVwiKTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gcGljayh1aWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3QgcGlja2VyID0gbmV3IEVsZW1lbnRQaWNrZXIoKTtcclxuICAgIHBpY2tlci5zdGFydCh7XHJcbiAgICAgICAgZWxlbWVudEZpbHRlcjogKGVsKSA9PiB7IHJldHVybiB1cChcIltjbXBpZF1cIikoZWwpIHx8IHVwKFwiW2RhdGEtdGVzdF1cIikoZWwpIHx8IHVwKFwiW2RhdGEtY3ldXCIpKGVsKSB9LFxyXG4gICAgICAgIG9uSG92ZXI6IChlbCkgPT4gY29uc29sZS5sb2coZWwpLC8vIGNvbnNvbGUubG9nKGBIb3ZlcjogJHtlbH1gKSxcclxuICAgICAgICBvbkNsaWNrOiBhc3luYyAoZWwpID0+IHtcclxuICAgICAgICAgICAgcGlja2VyLnN0b3AoKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYFBpY2tlZDogJHtlbH1gKTtcclxuICAgICAgICAgICAgY29uc3QgY3RybCA9IHVwKFwiW2NtcGlkXVwiKShlbCkgfHwgdXAoXCJbZGF0YS10ZXN0XVwiKShlbCkgfHwgdXAoXCJbZGF0YS1jeV1cIikoZWwpO1xyXG4gICAgICAgICAgICBpZiAoIWN0cmwpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCA9IHtcclxuICAgICAgICAgICAgICAgIGFjdGlvbjogJ3BpY2snLFxyXG4gICAgICAgICAgICAgICAgdGFnOiAoZWwgYXMgRWxlbWVudCkudGFnTmFtZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiAoZWwgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUsXHJcbiAgICAgICAgICAgICAgICBwYWdlSW5kZXg6IHdpbmRvd1snX19fbWNyX19fcGFnZUluZGV4J11cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHZhciByZXM6IEFycmF5PENvbW1hbmQ+ID0gYXdhaXQgY2FwdHVyZUV2ZW50QXR0cmlidXRlcyhlbCwgdG9jbWQoJ3BpY2snLCBwYXJzZWRFdmVudCksIHBhcnNlZEV2ZW50LCBbXSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHJlcyA9IHJlcy5maWx0ZXIoeCA9PiAhIXgpOyAvL3RvbGdvIGkgbnVsbGlcclxuICAgICAgICAgICAgcmVzLm1hcCh4ID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh4Lk9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHguU2VsZWN0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWwubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHh4ID0gZWxbaV0uY2xvc2VzdChcIi50YWJiZXItY29udGVudD5rZW5kby10YWJzdHJpcD5bcm9sZT0ndGFicGFuZWwnXVthcmlhLWhpZGRlbj0nZmFsc2UnXVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF4eCkgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHguT3B0aW9ucy5zY29wZSA9ICdEb2N1bWVudCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgheC5PcHRpb25zLnNjb3BlKSB4Lk9wdGlvbnMuc2NvcGUgPSAnQWxsJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9ICcnO1xyXG4gICAgICAgICAgICBpZiAocmVzLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocmVzWzBdLlNlbGVjdG9yKTtcclxuICAgICAgICAgICAgICAgIGlmIChzZWwgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gc2VsLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgZWxzZSB2YWx1ZSA9IChzZWwucXVlcnlTZWxlY3RvcignaW5wdXQsdGV4dGFyZWEnKSBhcyBIVE1MSW5wdXRFbGVtZW50KT8udmFsdWU7XHJcbiAgICAgICAgICAgICAgICByZXNbMF0uT3B0aW9ucy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFbGVtZW50IHBpY2tlcicsIHJlcywgdmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHdpbmRvd1tcIl9fX21jcl9fX3NlbmRcIl0pXHJcbiAgICAgICAgICAgICAgICB3aW5kb3dbXCJfX19tY3JfX19zZW5kXCJdKEpTT04uc3RyaW5naWZ5KHsgdHlwZTogXCJwaWNrXCIsIGNvbnRlbnQ6IEpTT04uc3RyaW5naWZ5KHJlcyksIHVpZCwgdmFsdWUgfSkpO1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gc2V0UGFnZUluZGV4KGluZGV4OiBudW1iZXIpIHtcclxuICAgIHdpbmRvd1tcIl9fX21jcl9fX3BhZ2VJbmRleFwiXSA9IGluZGV4O1xyXG59XHJcblxyXG5mdW5jdGlvbiBpbml0aWFsaXplKCk6IHZvaWQge1xyXG4gICAgd2luZG93W1wiX19fbWNyX19faW5qZWN0ZWRcIl0gPSB0cnVlO1xyXG4gICAgd2luZG93W1wiX19fbWNyX19fc3RhcnRMaXN0ZW5pbmdcIl0gPSBhZGRET01MaXN0ZW5lcnM7XHJcbiAgICB3aW5kb3dbXCJfX19tY3JfX19zdG9wTGlzdGVuaW5nXCJdID0gcmVtb3ZlRE9NTGlzdGVuZXJzO1xyXG4gICAgd2luZG93W1wiX19fbWNyX19fcGFnZVwiXSA9IHNldFBhZ2VJbmRleDtcclxuICAgIHdpbmRvd1tcIl9fX21jcl9fX3BpY2tcIl0gPSBwaWNrO1xyXG59XHJcblxyXG5pbml0aWFsaXplKCk7XHJcbiIsImV4cG9ydCBlbnVtIEV2ZW50VHlwZSB7XHJcbiAgQ0xJQ0sgPSAnY2xpY2snLFxyXG4gIENIQU5HRSA9ICdjaGFuZ2UnLFxyXG4gIERCTENMSUNLID0gJ2RibGNsaWNrJyxcclxuICBLRVlET1dOID0gJ2tleWRvd24nLFxyXG4gIFNVQk1JVCA9ICdzdWJtaXQnLFxyXG4gIENPTlRFWFRNRU5VID0gJ2NvbnRleHRtZW51JyxcclxuICBEUkFHU1RBUlQgPSAnZHJhZ3N0YXJ0JyxcclxuICBEUk9QID0gJ2Ryb3AnXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEtleWRvd25UeXBlIHsgRVNDQVBFID0gJ0VzY2FwZScsIEYxID0gJ0YxJywgRjIgPSAnRjInLCBGMyA9ICdGMycsIEY3ID0gJ0Y3JywgRjEwID0gJ0YxMCcsIFRBQiA9ICdUYWInIH1cclxuXHJcbmV4cG9ydCBlbnVtIENvbnRyb2xBY3Rpb24ge1xyXG4gIFNUQVJULFxyXG4gIFNUT1AsXHJcbiAgUkVTRVQsXHJcbiAgREVMRVRFLFxyXG4gIE1PVkUsXHJcbiAgUFVTSCxcclxuICBFRElULFxyXG4gIExPQUQsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIFJlY1N0YXRlIHtcclxuICBPTixcclxuICBPRkYsXHJcbiAgUEFVU0VELFxyXG59XHJcblxyXG5leHBvcnQgdHlwZSBUYWdzID1cclxuICB8ICdEb2NrUGFuZSdcclxuICB8ICdEaWFsb2cnXHJcbiAgfCAnRGlhbG9nQWN0aW9ucydcclxuICB8ICdEaWFsb2dBY3Rpb25zU2NoZWR1bGVyJ1xyXG4gIHwgJ0RpYWxvZ0Nsb3NlJ1xyXG4gIHwgJ1dpbmRvdydcclxuICB8ICdXaW5kb3dBY3Rpb25zJ1xyXG4gIHwgJ1dpbmRvd0Nsb3NlJ1xyXG4gIHwgJ1RiUmFkYXJXZWJTdHlsZSdcclxuICB8ICdUYlJhZGFyVGFibGVTdHlsZSdcclxuICB8ICdLZW5kb0dyaWQnXHJcbiAgfCAnQm9keUVkaXQnXHJcbiAgfCAnQm9keUVkaXRSb3cnXHJcbiAgfCAnQm9keUVkaXRDaGVja2JveCdcclxuICB8ICdCb2R5RWRpdER1bW15Um93J1xyXG4gIHwgJ0l0ZW1Tb3VyY2UnXHJcbiAgfCAnRW51bUNvbWJvJ1xyXG4gIHwgJ1RiUGFuZWwnXHJcbiAgfCAnS2VuZG9VcGxvYWQnXHJcbiAgfCAnS2VuZG9Ecm9wZG93bmxpc3QnXHJcbiAgfCAnS2VuZG9UcmVlbGlzdCdcclxuICB8ICdLZW5kb1RyZWVsaXN0Um93SW5kZXgnXHJcbiAgfCAnS2VuZG9UcmVlbGlzdE5hdGl2ZUNlbGwnXHJcbiAgfCAnS2VuZG9UcmVlbGlzdEV4cGFuZCdcclxuICB8ICdLZW5kb1RyZWVsaXN0Q29sbGFwc2UnXHJcbiAgfCAnRHluYW1pY0NoZWNrYm94J1xyXG4gIHwgJ0RyYWdEcm9wJ1xyXG4gIHwgJ0tlbmRvR3JpZFJvd0luZGV4J1xyXG4gIHwgJ0JFZGl0Vmlldyc7XHJcblxyXG5leHBvcnQgdHlwZSBPcHRpb25zID0ge1xyXG4gIG1haW5Db21wb25lbnQ/OiBzdHJpbmc7Ly90Yi1iZVtkYXRhLXRlc3Q9Li4uXVxyXG4gIGRpc3BsYXk/OiBzdHJpbmc7XHJcbiAgdGFnPzogVGFncztcclxuICBmcm9tU2VsZWN0b3I/OnN0cmluZztcclxuICAvL2NoYW5jZT86IHN0cmluZztcclxuICBpZHg/OiBzdHJpbmc7XHJcbiAgb3RoZXI/OiBzdHJpbmc7XHJcbiAgc2NvcGU/OiBzdHJpbmc7XHJcbiAgZm9yY2U/OiBib29sZWFuO1xyXG4gIG50aD86IG51bWJlcjtcclxuICAvL29wdGlvbmFsPzogdHJ1ZTtcclxuICBwYXJlbnQ/OiBzdHJpbmc7Ly90Yi1pZGQtLi4uXHJcbiAgemluZGV4PzogbnVtYmVyO1xyXG4gIGV2ZW50S2V5Pzogc3RyaW5nO1xyXG4gIGV2ZW50VmFsdWU/OiBzdHJpbmc7XHJcbiAgdmFsdWU/OiBzdHJpbmc7XHJcbiAga2V5Ym9hcmRNb2RpZmllcj86IEFycmF5PHN0cmluZz47XHJcbiAgcGFnZUluZGV4PzogbnVtYmVyO1xyXG4gIHJldHJ5PzogYm9vbGVhbjtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIENvbW1hbmRUeXBlID0gJ2NsaWNrJyB8ICdkYmxjbGljaycgfCAnd3JpdGUnIHwgJ3NlbGVjdCcgfCAnZ290bycgfCAna2V5ZG93bicgfCAncGljaycgfCAnd2FpdCcgfCAnZHJhZ2Ryb3AnO1xyXG5cclxuZXhwb3J0IHR5cGUgQ29tbWFuZCA9IHtcclxuICBUeXBlOiBDb21tYW5kVHlwZTtcclxuICBTZWxlY3Rvcjogc3RyaW5nO1xyXG4gIE9wdGlvbnM/OiBPcHRpb25zO1xyXG59O1xyXG5cclxuZXhwb3J0IHR5cGUgUGFyc2VkRXZlbnQgPSB7XHJcbiAgc2VsZWN0b3I/OiBzdHJpbmc7XHJcbiAgYWN0aW9uOiBzdHJpbmc7XHJcbiAgdGFnOiBzdHJpbmc7XHJcbiAgdmFsdWU6IHN0cmluZztcclxuICBpZD86IHN0cmluZztcclxuICBrZXk/OiBzdHJpbmc7XHJcbiAgaHJlZj86IHN0cmluZztcclxuICBpbnB1dFR5cGU/OiBzdHJpbmc7XHJcbiAgY29tbWFuZD86IENvbW1hbmQ7XHJcbiAgbW9kaWZpZXJzPzogQXJyYXk8c3RyaW5nPjtcclxuICBwYWdlSW5kZXg/OiBudW1iZXI7XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBTZXNzaW9uID0ge1xyXG4gIGlzUGVuZGluZzogYm9vbGVhbjtcclxuICBsYXN0VVJMOiBzdHJpbmc7XHJcbiAgb3JpZ2luYWxIb3N0OiBzdHJpbmc7XHJcbiAgYWN0aXZlUG9ydDogY2hyb21lLnJ1bnRpbWUuUG9ydCB8IG51bGw7XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBBY3Rpb25XaXRoUGF5bG9hZCA9IHtcclxuICB0eXBlOiBDb250cm9sQWN0aW9uO1xyXG4gIHBheWxvYWQ/OiBhbnk7XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBCbG9jayA9IHtcclxuICBjb21tYW5kOiBDb21tYW5kO1xyXG4gIGlkOiBzdHJpbmc7XHJcbn07XHJcbiIsImltcG9ydCBFbGVtZW50UGlja2VyIGZyb20gXCIuL2VsZW1lbnQtcGlja2VyXCI7XG5leHBvcnQgeyBFbGVtZW50UGlja2VyIH07XG4iLCJpbXBvcnQgRWxlbWVudE92ZXJsYXkgZnJvbSBcIi4vZWxlbWVudC1vdmVybGF5XCI7XG5pbXBvcnQgeyBnZXRFbGVtZW50Qm91bmRzIH0gZnJvbSBcIi4vdXRpbHNcIjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVsZW1lbnRQaWNrZXIge1xuICAgIGNvbnN0cnVjdG9yKG92ZXJsYXlPcHRpb25zKSB7XG4gICAgICAgIHRoaXMuaGFuZGxlTW91c2VNb3ZlID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLm1vdXNlWCA9IGV2ZW50LmNsaWVudFg7XG4gICAgICAgICAgICB0aGlzLm1vdXNlWSA9IGV2ZW50LmNsaWVudFk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaGFuZGxlQ2xpY2sgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRhcmdldCAmJiAoKF9hID0gdGhpcy5vcHRpb25zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Eub25DbGljaykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25DbGljayh0aGlzLnRhcmdldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnRpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVRhcmdldCgpO1xuICAgICAgICAgICAgdGhpcy50aWNrUmVxID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnRpY2spO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLm92ZXJsYXkgPSBuZXcgRWxlbWVudE92ZXJsYXkob3ZlcmxheU9wdGlvbnMgIT09IG51bGwgJiYgb3ZlcmxheU9wdGlvbnMgIT09IHZvaWQgMCA/IG92ZXJsYXlPcHRpb25zIDoge30pO1xuICAgIH1cbiAgICBzdGFydChvcHRpb25zKSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCB0aGlzLmhhbmRsZU1vdXNlTW92ZSwgdHJ1ZSk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmhhbmRsZUNsaWNrLCB0cnVlKTtcbiAgICAgICAgdGhpcy5vdmVybGF5LmFkZFRvRE9NKChfYSA9IG9wdGlvbnMucGFyZW50RWxlbWVudCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogZG9jdW1lbnQuYm9keSwgKF9iID0gb3B0aW9ucy51c2VTaGFkb3dET00pICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IHRydWUpO1xuICAgICAgICB0aGlzLnRpY2soKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IHVuZGVmaW5lZDtcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCB0aGlzLmhhbmRsZU1vdXNlTW92ZSwgdHJ1ZSk7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmhhbmRsZUNsaWNrLCB0cnVlKTtcbiAgICAgICAgdGhpcy5vdmVybGF5LnJlbW92ZUZyb21ET00oKTtcbiAgICAgICAgdGhpcy50YXJnZXQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMubW91c2VYID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLm1vdXNlWSA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKHRoaXMudGlja1JlcSkge1xuICAgICAgICAgICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMudGlja1JlcSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdXBkYXRlVGFyZ2V0KCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICBpZiAodGhpcy5tb3VzZVggPT09IHVuZGVmaW5lZCB8fCB0aGlzLm1vdXNlWSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gUGVlayB0aHJvdWdoIHRoZSBvdmVybGF5IHRvIGZpbmQgdGhlIG5ldyB0YXJnZXRcbiAgICAgICAgdGhpcy5vdmVybGF5Lmlnbm9yZUN1cnNvcigpO1xuICAgICAgICBjb25zdCBlbEF0Q3Vyc29yID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludCh0aGlzLm1vdXNlWCwgdGhpcy5tb3VzZVkpO1xuICAgICAgICBjb25zdCBuZXdUYXJnZXQgPSBlbEF0Q3Vyc29yO1xuICAgICAgICB0aGlzLm92ZXJsYXkuY2FwdHVyZUN1cnNvcigpO1xuICAgICAgICAvLyBJZiB0aGUgdGFyZ2V0IGhhc24ndCBjaGFuZ2VkLCB0aGVyZSdzIG5vdGhpbmcgdG8gZG9cbiAgICAgICAgaWYgKCFuZXdUYXJnZXQgfHwgbmV3VGFyZ2V0ID09PSB0aGlzLnRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIElmIHdlIGhhdmUgYW4gZWxlbWVudCBmaWx0ZXIgYW5kIHRoZSBuZXcgdGFyZ2V0IGRvZXNuJ3QgbWF0Y2gsXG4gICAgICAgIC8vIGNsZWFyIG91dCB0aGUgdGFyZ2V0XG4gICAgICAgIGlmICgoX2EgPSB0aGlzLm9wdGlvbnMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5lbGVtZW50RmlsdGVyKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5lbGVtZW50RmlsdGVyKG5ld1RhcmdldCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRhcmdldCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB0aGlzLm92ZXJsYXkuc2V0Qm91bmRzKHsgeDogMCwgeTogMCwgd2lkdGg6IDAsIGhlaWdodDogMCB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy50YXJnZXQgPSBuZXdUYXJnZXQ7XG4gICAgICAgIGNvbnN0IGJvdW5kcyA9IGdldEVsZW1lbnRCb3VuZHMobmV3VGFyZ2V0KTtcbiAgICAgICAgdGhpcy5vdmVybGF5LnNldEJvdW5kcyhib3VuZHMpO1xuICAgICAgICBpZiAoKF9iID0gdGhpcy5vcHRpb25zKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Iub25Ib3Zlcikge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zLm9uSG92ZXIobmV3VGFyZ2V0KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEVsZW1lbnRPdmVybGF5IHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgICAgIHZhciBfYSwgX2IsIF9jLCBfZCwgX2UsIF9mLCBfZywgX2gsIF9qO1xuICAgICAgICB0aGlzLm92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLm92ZXJsYXkuY2xhc3NOYW1lID0gb3B0aW9ucy5jbGFzc05hbWUgfHwgXCJfZXh0LWVsZW1lbnQtb3ZlcmxheVwiO1xuICAgICAgICB0aGlzLm92ZXJsYXkuc3R5bGUuYmFja2dyb3VuZCA9ICgoX2EgPSBvcHRpb25zLnN0eWxlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYmFja2dyb3VuZCkgfHwgXCJyZ2JhKDI1MCwgMjQwLCAyMDIsIDAuMilcIjtcbiAgICAgICAgdGhpcy5vdmVybGF5LnN0eWxlLmJvcmRlckNvbG9yID0gKChfYiA9IG9wdGlvbnMuc3R5bGUpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5ib3JkZXJDb2xvcikgfHwgXCIjRjk1NzM4XCI7XG4gICAgICAgIHRoaXMub3ZlcmxheS5zdHlsZS5ib3JkZXJTdHlsZSA9ICgoX2MgPSBvcHRpb25zLnN0eWxlKSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuYm9yZGVyU3R5bGUpIHx8IFwic29saWRcIjtcbiAgICAgICAgdGhpcy5vdmVybGF5LnN0eWxlLmJvcmRlclJhZGl1cyA9ICgoX2QgPSBvcHRpb25zLnN0eWxlKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QuYm9yZGVyUmFkaXVzKSB8fCBcIjFweFwiO1xuICAgICAgICB0aGlzLm92ZXJsYXkuc3R5bGUuYm9yZGVyV2lkdGggPSAoKF9lID0gb3B0aW9ucy5zdHlsZSkgPT09IG51bGwgfHwgX2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lLmJvcmRlcldpZHRoKSB8fCBcIjFweFwiO1xuICAgICAgICB0aGlzLm92ZXJsYXkuc3R5bGUuYm94U2l6aW5nID0gKChfZiA9IG9wdGlvbnMuc3R5bGUpID09PSBudWxsIHx8IF9mID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZi5ib3hTaXppbmcpIHx8IFwiYm9yZGVyLWJveFwiO1xuICAgICAgICB0aGlzLm92ZXJsYXkuc3R5bGUuY3Vyc29yID0gKChfZyA9IG9wdGlvbnMuc3R5bGUpID09PSBudWxsIHx8IF9nID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZy5jdXJzb3IpIHx8IFwiY3Jvc3NoYWlyXCI7XG4gICAgICAgIHRoaXMub3ZlcmxheS5zdHlsZS5wb3NpdGlvbiA9ICgoX2ggPSBvcHRpb25zLnN0eWxlKSA9PT0gbnVsbCB8fCBfaCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2gucG9zaXRpb24pIHx8IFwiYWJzb2x1dGVcIjtcbiAgICAgICAgdGhpcy5vdmVybGF5LnN0eWxlLnpJbmRleCA9ICgoX2ogPSBvcHRpb25zLnN0eWxlKSA9PT0gbnVsbCB8fCBfaiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2ouekluZGV4KSB8fCBcIjIxNDc0ODM2NDdcIjtcbiAgICAgICAgdGhpcy5zaGFkb3dDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICB0aGlzLnNoYWRvd0NvbnRhaW5lci5jbGFzc05hbWUgPSBcIl9leHQtZWxlbWVudC1vdmVybGF5LWNvbnRhaW5lclwiO1xuICAgICAgICB0aGlzLnNoYWRvd0NvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcbiAgICAgICAgdGhpcy5zaGFkb3dDb250YWluZXIuc3R5bGUudG9wID0gXCIwcHhcIjtcbiAgICAgICAgdGhpcy5zaGFkb3dDb250YWluZXIuc3R5bGUubGVmdCA9IFwiMHB4XCI7XG4gICAgICAgIHRoaXMuc2hhZG93Um9vdCA9IHRoaXMuc2hhZG93Q29udGFpbmVyLmF0dGFjaFNoYWRvdyh7IG1vZGU6IFwib3BlblwiIH0pO1xuICAgIH1cbiAgICBhZGRUb0RPTShwYXJlbnQsIHVzZVNoYWRvd0RPTSkge1xuICAgICAgICB0aGlzLnVzaW5nU2hhZG93RE9NID0gdXNlU2hhZG93RE9NO1xuICAgICAgICBpZiAodXNlU2hhZG93RE9NKSB7XG4gICAgICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKHRoaXMuc2hhZG93Q29udGFpbmVyLCBwYXJlbnQuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICB0aGlzLnNoYWRvd1Jvb3QuYXBwZW5kQ2hpbGQodGhpcy5vdmVybGF5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZCh0aGlzLm92ZXJsYXkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlbW92ZUZyb21ET00oKSB7XG4gICAgICAgIHRoaXMuc2V0Qm91bmRzKHsgeDogMCwgeTogMCwgd2lkdGg6IDAsIGhlaWdodDogMCB9KTtcbiAgICAgICAgdGhpcy5vdmVybGF5LnJlbW92ZSgpO1xuICAgICAgICBpZiAodGhpcy51c2luZ1NoYWRvd0RPTSkge1xuICAgICAgICAgICAgdGhpcy5zaGFkb3dDb250YWluZXIucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2FwdHVyZUN1cnNvcigpIHtcbiAgICAgICAgdGhpcy5vdmVybGF5LnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcImF1dG9cIjtcbiAgICB9XG4gICAgaWdub3JlQ3Vyc29yKCkge1xuICAgICAgICB0aGlzLm92ZXJsYXkuc3R5bGUucG9pbnRlckV2ZW50cyA9IFwibm9uZVwiO1xuICAgIH1cbiAgICBzZXRCb3VuZHMoeyB4LCB5LCB3aWR0aCwgaGVpZ2h0IH0pIHtcbiAgICAgICAgdGhpcy5vdmVybGF5LnN0eWxlLmxlZnQgPSB4ICsgXCJweFwiO1xuICAgICAgICB0aGlzLm92ZXJsYXkuc3R5bGUudG9wID0geSArIFwicHhcIjtcbiAgICAgICAgdGhpcy5vdmVybGF5LnN0eWxlLndpZHRoID0gd2lkdGggKyBcInB4XCI7XG4gICAgICAgIHRoaXMub3ZlcmxheS5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyBcInB4XCI7XG4gICAgfVxufVxuIiwiO1xuZXhwb3J0IGNvbnN0IGdldEVsZW1lbnRCb3VuZHMgPSAoZWwpID0+IHtcbiAgICBjb25zdCByZWN0ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgeDogd2luZG93LnBhZ2VYT2Zmc2V0ICsgcmVjdC5sZWZ0LFxuICAgICAgICB5OiB3aW5kb3cucGFnZVlPZmZzZXQgKyByZWN0LnRvcCxcbiAgICAgICAgd2lkdGg6IGVsLm9mZnNldFdpZHRoLFxuICAgICAgICBoZWlnaHQ6IGVsLm9mZnNldEhlaWdodCxcbiAgICB9O1xufTtcbiIsImltcG9ydCB7XHJcbiAgICBPcHRpb25zLFxyXG4gICAgUGFyc2VkRXZlbnQsXHJcbiAgICBFdmVudFR5cGUsXHJcbiAgICBUYWdzLFxyXG4gICAgQ29tbWFuZCxcclxuICAgIENvbW1hbmRUeXBlLFxyXG4gICAgS2V5ZG93blR5cGUsXHJcbn0gZnJvbSBcIi4vdHlwZXNcIjtcclxuaW1wb3J0IHtcclxuICAgIGdldElkLFxyXG4gICAgY3NzZXNjLFxyXG4gICAgaXNJbkFjdGl2ZURvYyxcclxuICAgIHVwVG9JZCxcclxuICAgIHVwVG9DdHJsV2l0aElkLFxyXG4gICAgZGVsYXksXHJcbiAgICBhY3RpdmVEb2MsXHJcbiAgICBpc1RhZyxcclxuICAgIHVwLFxyXG59IGZyb20gXCIuL3VcIjtcclxuaW1wb3J0IHsgbWF0Y2ggfSBmcm9tIFwiLi9tYXRjaGVyXCI7XHJcbmltcG9ydCB7XHJcbiAgICBCb2R5RWRpdENvbXBvbmVudCxcclxuICAgIERpYWxvZ0NvbXBvbmVudCxcclxuICAgIERvY2tlckNvbXBvbmVudCxcclxuICAgIER5bmFtaWNDaGVja2JveENvbXBvbmVudCxcclxuICAgIEdlbmVyaWNDb21tYW5kQ29tcG9uZW50LFxyXG4gICAgSXRlbVNvdXJjZUNvbXBvbmVudCxcclxuICAgIEtlbmRvR3JpZENvbXBvbmVudCxcclxuICAgIEtlbmRvVHJlZUxpc3RDb21wb25lbnQsXHJcbiAgICBLZW5kb1VwbG9hZENvbXBvbmVudCxcclxuICAgIFBhbmVsQ29tcG9uZW50LFxyXG4gICAgUmFkYXJDb21wb25lbnQsXHJcbiAgICBXaW5kb3dDb21wb25lbnQsXHJcbn0gZnJvbSBcIi4vY2FwdG9yc1wiO1xyXG5cclxuY29uc3QgY2FwdHVyaW5nQ29udHJvbHMgPSBbXHJcbiAgICBcInRiLWRhdGUtZWRpdFwiLFxyXG4gICAgXCJ0Yi1hcHBsaWNhdGlvbi1kYXRlXCIsXHJcbiAgICBcInRiLWVudW0tY29tYm9cIixcclxuICAgIFwia2VuZG8tZHJvcGRvd25saXN0XCIsXHJcbiAgICBcImtlbmRvLWNvbWJvYm94XCIsXHJcbiAgICBcImtlbmRvLW11bHRpY29sdW1uY29tYm9ib3hcIixcclxuICAgIFwia2VuZG8tbXVsdGlzZWxlY3RcIlxyXG5dIGFzIGNvbnN0OyAvLyBUUyAzLjRcclxudHlwZSBDYXB0dXJpbmdDb250cm9scyA9IHR5cGVvZiBjYXB0dXJpbmdDb250cm9sc1tudW1iZXJdO1xyXG5cclxuY29uc3QgY3RybCA9IHtcclxuICAgIG5lZWRzQ2FwdHVyZTogKGVsOiBFbGVtZW50KSA9PiBpc1RhZyhlbCwgLi4uY2FwdHVyaW5nQ29udHJvbHMpLFxyXG5cclxuICAgIGNhcHR1cmVkVmFsdWU6IChjYXB0dXJlZEJ5KSA9PlxyXG4gICAgICAgIG1hdGNoPENhcHR1cmluZ0NvbnRyb2xzLCAoKSA9PiBzdHJpbmc+KHtcclxuICAgICAgICAgICAgXCJ0Yi1lbnVtLWNvbWJvXCI6ICgpID0+IEdlbmVyaWNDb21tYW5kQ29tcG9uZW50LmdldFZhbHVlKGNhcHR1cmVkQnksICdbc2VsZWN0ZWQtY29kZV0nLCAnc2VsZWN0ZWQtY29kZScpLFxyXG4gICAgICAgICAgICBcImtlbmRvLWRyb3Bkb3dubGlzdFwiOiAoKSA9PiBHZW5lcmljQ29tbWFuZENvbXBvbmVudC5nZXRWYWx1ZShjYXB0dXJlZEJ5LCB1bmRlZmluZWQsICdzZWxlY3RlZC1jb2RlJyksXHJcbiAgICAgICAgICAgIFwia2VuZG8tbXVsdGlzZWxlY3RcIjogKCkgPT4gR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuZ2V0VmFsdWUoY2FwdHVyZWRCeSwgdW5kZWZpbmVkLCAnc2VsZWN0ZWQtY29kZScpLFxyXG4gICAgICAgICAgICBcImtlbmRvLWNvbWJvYm94XCI6ICgpID0+IEdlbmVyaWNDb21tYW5kQ29tcG9uZW50LmdldFZhbHVlKGNhcHR1cmVkQnksIHVuZGVmaW5lZCwgJ3NlbGVjdGVkLWNvZGUnKSxcclxuICAgICAgICAgICAgXCJrZW5kby1tdWx0aWNvbHVtbmNvbWJvYm94XCI6ICgpID0+IEdlbmVyaWNDb21tYW5kQ29tcG9uZW50LmdldFZhbHVlKGNhcHR1cmVkQnksIHVuZGVmaW5lZCwgJ3NlbGVjdGVkLWNvZGUnKSxcclxuICAgICAgICAgICAgXCJ0Yi1kYXRlLWVkaXRcIjogKCkgPT4gR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuZ2V0VmFsdWUoY2FwdHVyZWRCeSwgJ3RleHRhcmVhLCBpbnB1dCcsICdzZWxlY3RlZC1kYXRlJyksXHJcbiAgICAgICAgICAgIFwidGItYXBwbGljYXRpb24tZGF0ZVwiOiAoKSA9PiBHZW5lcmljQ29tbWFuZENvbXBvbmVudC5nZXRWYWx1ZShjYXB0dXJlZEJ5LCAndGV4dGFyZWEsIGlucHV0JywgJ3NlbGVjdGVkLWRhdGUnKSxcclxuICAgICAgICAgICAgXzogKCkgPT4gKGNhcHR1cmVkQnkucXVlcnlTZWxlY3RvcihcInRleHRhcmVhLCBpbnB1dFwiKSBhcyBhbnkpPy52YWx1ZSxcclxuICAgICAgICB9KShjYXB0dXJlZEJ5LnRhZ05hbWUudG9Mb3dlckNhc2UoKSkoKSxcclxuXHJcbn07XHJcblxyXG5jb25zdCBoYW5kbGVDYXB0dXJpbmdDb250cm9scyA9ICgoKSA9PiB7IC8vY2FwdHVyaW5nIG9uVmFsdWVDaGFuZ2VcclxuICAgIGxldCBjYXB0dXJlZEJ5OiBFbGVtZW50ID0gbnVsbDtcclxuICAgIGxldCBvbGRWYWx1ZSA9IFwiXCI7XHJcblxyXG4gICAgcmV0dXJuIGFzeW5jIChcclxuICAgICAgICB0YXJnZXQ6IEVsZW1lbnQsXHJcbiAgICAgICAgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50XHJcbiAgICApOiBQcm9taXNlPFtyZXM6IENvbW1hbmRbXSwgY2FwdHVyZWRCeTogRWxlbWVudF0+ID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnaGFuZGxlQ2FwdHVyaW5nQ29udHJvbHMgY2FwdHVyZWRCeScsIGNhcHR1cmVkQnk/LnRhZ05hbWUpO1xyXG4gICAgICAgIGxldCB2diA9IGN0cmw7XHJcbiAgICAgICAgY29uc3QgY2FwdHVyZSA9ICgpID0+IHtcclxuICAgICAgICAgICAgb2xkVmFsdWUgPSBcIlwiO1xyXG4gICAgICAgICAgICBjYXB0dXJlZEJ5ID0gY3RybC5uZWVkc0NhcHR1cmUodG1wKSA/IHRtcCA6IG51bGw7XHJcbiAgICAgICAgICAgIG9sZFZhbHVlID0gY2FwdHVyZWRCeSA/IGN0cmwuY2FwdHVyZWRWYWx1ZShjYXB0dXJlZEJ5KSA6IFwiXCI7XHJcbiAgICAgICAgICAgIHJldHVybiBjYXB0dXJlZEJ5O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgdG1wID0gdXBUb0N0cmxXaXRoSWQodGFyZ2V0KTtcclxuXHJcbiAgICAgICAgaWYgKGNhcHR1cmVkQnkgPT09IG51bGwpIHJldHVybiBbW10sIGNhcHR1cmUoKV07XHJcbiAgICAgICAgaWYgKGNhcHR1cmVkQnkgJiYgdXAoXCJjZGstdmlydHVhbC1zY3JvbGwtdmlld3BvcnQsIGtlbmRvLWNhbGVuZGFyLCBrZW5kby1saXN0XCIpKHRhcmdldCkpIC8vY2xpY2sgZGVudHJvIGlsIHBvcHVwIGRpIGhlbHBlclxyXG4gICAgICAgICAgICByZXR1cm4gW1tdLCBjYXB0dXJlZEJ5XTtcclxuXHJcbiAgICAgICAgY29uc3Qgb3V0c2lkZU9mQWN0aXZlQ3RybCA9IHRtcCA9PT0gbnVsbCAmJiBjYXB0dXJlZEJ5ICE9PSBudWxsICYmICFjYXB0dXJlZEJ5LmNvbnRhaW5zKHRhcmdldCk7XHJcbiAgICAgICAgY29uc3QgYWN0aXZlQ3RybENoYW5nZWQgPSBvdXRzaWRlT2ZBY3RpdmVDdHJsIHx8IHRtcCAhPT0gY2FwdHVyZWRCeSB8fCAocGFyc2VkRXZlbnQuYWN0aW9uID09PSBFdmVudFR5cGUuS0VZRE9XTiAmJiBwYXJzZWRFdmVudC5rZXkgPT09IFwiVGFiXCIpO1xyXG4gICAgICAgIGlmICghYWN0aXZlQ3RybENoYW5nZWQpIHJldHVybiBbW10sIGNhcHR1cmVkQnldO1xyXG5cclxuICAgICAgICAvL2F3YWl0IGRlbGF5KDEwMCk7XHJcbiAgICAgICAgY29uc3QgdmFsdWUgPSBjdHJsLmNhcHR1cmVkVmFsdWUoY2FwdHVyZWRCeSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ2hhbmRsZUNhcHR1cmluZ0NvbnRyb2xzIGNvbnRyb2wgdmFsdWUnLCB2YWx1ZSwgb2xkVmFsdWUsIGNhcHR1cmVkQnk/LnRhZ05hbWUpO1xyXG5cclxuICAgICAgICBpZiAodmFsdWUgPT09IG9sZFZhbHVlKSByZXR1cm4gW1tdLCBjYXB0dXJlKCldO1xyXG5cclxuICAgICAgICBpZiAoR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuaXNDb21wb25lbnQoY2FwdHVyZWRCeSwgXCJ0Yi1lbnVtLWNvbWJvXCIpKVxyXG4gICAgICAgICAgICByZXR1cm4gW1tHZW5lcmljQ29tbWFuZENvbXBvbmVudC5jYXB0dXJlKGNhcHR1cmVkQnksIHBhcnNlZEV2ZW50LCAnRW51bUNvbWJvJywgJ3NlbGVjdCcsICdbc2VsZWN0ZWQtY29kZV0nLCAnc2VsZWN0ZWQtY29kZScpXSwgY2FwdHVyZSgpXVxyXG5cclxuICAgICAgICBpZiAoR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuaXNDb21wb25lbnQoY2FwdHVyZWRCeSwgXCJrZW5kby1kcm9wZG93bmxpc3RcIikpXHJcbiAgICAgICAgICAgIHJldHVybiBbW0dlbmVyaWNDb21tYW5kQ29tcG9uZW50LmNhcHR1cmUoY2FwdHVyZWRCeSwgcGFyc2VkRXZlbnQsICdLZW5kb0Ryb3Bkb3dubGlzdCcsICdzZWxlY3QnLCB1bmRlZmluZWQsICdzZWxlY3RlZC1jb2RlJyldLCBjYXB0dXJlKCldXHJcbiAgICAgICAgaWYgKEdlbmVyaWNDb21tYW5kQ29tcG9uZW50LmlzQ29tcG9uZW50KGNhcHR1cmVkQnksIFwia2VuZG8tbXVsdGlzZWxlY3RcIikpXHJcbiAgICAgICAgICAgIHJldHVybiBbW0dlbmVyaWNDb21tYW5kQ29tcG9uZW50LmNhcHR1cmUoY2FwdHVyZWRCeSwgcGFyc2VkRXZlbnQsICdLZW5kb0Ryb3Bkb3dubGlzdCcsICdzZWxlY3QnLCB1bmRlZmluZWQsICdzZWxlY3RlZC1jb2RlJyldLCBjYXB0dXJlKCldXHJcbiAgICAgICAgaWYgKEdlbmVyaWNDb21tYW5kQ29tcG9uZW50LmlzQ29tcG9uZW50KGNhcHR1cmVkQnksIFwia2VuZG8tY29tYm9ib3hcIikpXHJcbiAgICAgICAgICAgIHJldHVybiBbW0dlbmVyaWNDb21tYW5kQ29tcG9uZW50LmNhcHR1cmUoY2FwdHVyZWRCeSwgcGFyc2VkRXZlbnQsICdLZW5kb0Ryb3Bkb3dubGlzdCcsICdzZWxlY3QnLCB1bmRlZmluZWQsICdzZWxlY3RlZC1jb2RlJyldLCBjYXB0dXJlKCldXHJcbiAgICAgICAgaWYgKEdlbmVyaWNDb21tYW5kQ29tcG9uZW50LmlzQ29tcG9uZW50KGNhcHR1cmVkQnksIFwia2VuZG8tbXVsdGljb2x1bW5jb21ib2JveFwiKSlcclxuICAgICAgICAgICAgcmV0dXJuIFtbR2VuZXJpY0NvbW1hbmRDb21wb25lbnQuY2FwdHVyZShjYXB0dXJlZEJ5LCBwYXJzZWRFdmVudCwgJ0tlbmRvRHJvcGRvd25saXN0JywgJ3NlbGVjdCcsIHVuZGVmaW5lZCwgJ3NlbGVjdGVkLWNvZGUnKV0sIGNhcHR1cmUoKV1cclxuXHJcbiAgICAgICAgaWYgKEdlbmVyaWNDb21tYW5kQ29tcG9uZW50LmlzQ29tcG9uZW50KGNhcHR1cmVkQnksIFwidGItZGF0ZS1lZGl0XCIpKVxyXG4gICAgICAgICAgICByZXR1cm4gW1tHZW5lcmljQ29tbWFuZENvbXBvbmVudC5jYXB0dXJlKGNhcHR1cmVkQnksIHBhcnNlZEV2ZW50LCB1bmRlZmluZWQsICd3cml0ZScsICd0ZXh0YXJlYSwgaW5wdXQnLCAnc2VsZWN0ZWQtZGF0ZScpXSwgY2FwdHVyZSgpXVxyXG4gICAgICAgIGlmIChHZW5lcmljQ29tbWFuZENvbXBvbmVudC5pc0NvbXBvbmVudChjYXB0dXJlZEJ5LCBcInRiLWFwcGxpY2F0aW9uLWRhdGVcIikpXHJcbiAgICAgICAgICAgIHJldHVybiBbW0dlbmVyaWNDb21tYW5kQ29tcG9uZW50LmNhcHR1cmUoY2FwdHVyZWRCeSwgcGFyc2VkRXZlbnQsIHVuZGVmaW5lZCwgJ3dyaXRlJywgJ3RleHRhcmVhLCBpbnB1dCcsICdzZWxlY3RlZC1kYXRlJyldLCBjYXB0dXJlKCldXHJcblxyXG4gICAgICAgIHJldHVybiBbW10sIGNhcHR1cmUoKV07XHJcbiAgICB9O1xyXG59KSgpO1xyXG5cclxuY29uc3QgdG9vcHQgPSAoc2VsZWN0b3I6IHN0cmluZywgZWw/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucywgcGFyc2VkRXZlbnQ/OiBQYXJzZWRFdmVudCk6IE9wdGlvbnMgPT4ge1xyXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgPz8ge307XHJcbiAgICBpZiAocGFyc2VkRXZlbnQ/LnZhbHVlICE9PSBudWxsICYmIHBhcnNlZEV2ZW50Py52YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHBhcnNlZEV2ZW50Py52YWx1ZS5sZW5ndGggPj0gMCAmJiAhb3B0aW9ucy5ldmVudFZhbHVlKSBvcHRpb25zLmV2ZW50VmFsdWUgPSBwYXJzZWRFdmVudD8udmFsdWUudG9TdHJpbmcoKS5yZXBsYWNlKC8nL2csIFwiXFxcXCdcIik7XHJcbiAgICBpZiAocGFyc2VkRXZlbnQ/LmtleSAmJiAhb3B0aW9ucy5ldmVudEtleSkgb3B0aW9ucy5ldmVudEtleSA9IHBhcnNlZEV2ZW50Py5rZXkudG9TdHJpbmcoKS5yZXBsYWNlKC8nL2csIFwiXFxcXCdcIik7XHJcbiAgICBpZiAocGFyc2VkRXZlbnQ/Lm1vZGlmaWVycz8ubGVuZ3RoID4gMCkgb3B0aW9ucy5rZXlib2FyZE1vZGlmaWVyID0gcGFyc2VkRXZlbnQubW9kaWZpZXJzO1xyXG4gICAgaWYgKHBhcnNlZEV2ZW50Py5wYWdlSW5kZXggIT09IHVuZGVmaW5lZCkgb3B0aW9ucy5wYWdlSW5kZXggPSBwYXJzZWRFdmVudC5wYWdlSW5kZXg7XHJcbiAgICBvcHRpb25zLmZvcmNlID0gISEoZWw/Lmhhc0F0dHJpYnV0ZShcImRpc2FibGVkXCIpIHx8IGVsPy5nZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKSk7XHJcbiAgICBvcHRpb25zLnJldHJ5ID0gZmFsc2U7XHJcbiAgICBpZiAoIW9wdGlvbnM/LnNjb3BlICYmICFpc0luQWN0aXZlRG9jKGVsKSkge1xyXG4gICAgICAgIHJldHVybiB7IC4uLm9wdGlvbnMsIHNjb3BlOiBcImFsbFwiIH07XHJcbiAgICB9XHJcbiAgICBpZiAob3B0aW9ucykgcmV0dXJuIG9wdGlvbnM7XHJcbiAgICByZXR1cm4ge307XHJcbn07XHJcblxyXG4vL2V4cG9ydCB0eXBlIENvbW1hbmRSZXN1bHQgPSAoc2VsZWN0b3I6IHN0cmluZywgdGFyZ2V0PzogRWxlbWVudCwgb3B0aW9ucz86IE9wdGlvbnMpID0+IENvbW1hbmQ7XHJcblxyXG5leHBvcnQgY29uc3QgdG9jbWQgPVxyXG4gICAgKGNtZDogQ29tbWFuZFR5cGUsIHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCkgPT5cclxuICAgICAgICAoc2VsZWN0b3I6IHN0cmluZywgdGFyZ2V0PzogRWxlbWVudCwgb3B0aW9ucz86IE9wdGlvbnMpOiBDb21tYW5kID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIFR5cGU6IGNtZCxcclxuICAgICAgICAgICAgICAgIFNlbGVjdG9yOiBjc3Nlc2Moc2VsZWN0b3IpICsgZ2V0VGFnTmFtZSh0YXJnZXQpLFxyXG4gICAgICAgICAgICAgICAgT3B0aW9uczogdG9vcHQoc2VsZWN0b3IsIHRhcmdldCwgb3B0aW9ucywgcGFyc2VkRXZlbnQpLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcblxyXG4vLyBleHBvcnQgY29uc3QgY21kID0ge1xyXG4vLyAgIHdyaXRlOiB0b2NtZChcIndyaXRlXCIpLFxyXG4vLyAgIHNlbGVjdDogdG9jbWQoXCJzZWxlY3RcIiksXHJcbi8vICAgY2xpY2s6IHRvY21kKFwiY2xpY2tcIiksXHJcbi8vICAga2V5ZG93bjogdG9jbWQoXCJrZXlkb3duXCIpLFxyXG4vLyAgIHBpY2s6IHRvY21kKFwicGlja1wiKSxcclxuLy8gfTtcclxuXHJcbmxldCBwZW5kaW5nRHJhZzogRHJhZ0V2ZW50ID0gdW5kZWZpbmVkO1xyXG5sZXQgc2tpcEZpbmQgPSBmYWxzZTtcclxuXHJcbmZ1bmN0aW9uIGdldFRhZ05hbWUodGFyZ2V0OiBhbnkpOiBzdHJpbmcge1xyXG4gICAgaWYgKHRhcmdldC5hdHRyaWJ1dGVzWydkYXRhLXRlc3QnXSB8fCB0YXJnZXQuYXR0cmlidXRlc1snZGF0YS1jeSddIHx8IHRhcmdldC5hdHRyaWJ1dGVzWydjbXBJZCddKVxyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIHZhciBlbGVtZW50ID0gdXBUb0N0cmxXaXRoSWQodGFyZ2V0KTtcclxuICAgIGlmICghZWxlbWVudCkgcmV0dXJuICcnO1xyXG4gICAgaWYgKGVsZW1lbnQudGFnTmFtZS5zdGFydHNXaXRoKCdUQi0nKSkge1xyXG4gICAgICAgIHZhciBlID0gdGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICBpZiAoWydpbnB1dCcsICdzZWxlY3QnLCAndGV4dGFyZWEnXS5pbmNsdWRlcyhlKSkgcmV0dXJuICcgJyArIGU7XHJcbiAgICAgICAgZWxzZSBpZiAoZ2V0SWQodGFyZ2V0LmNsb3Nlc3QoXCJidXR0b25cIikpID09IG51bGwgJiYgZWxlbWVudC5jb250YWlucyh0YXJnZXQuY2xvc2VzdChcImJ1dHRvblwiKSkpIHJldHVybiAnIGJ1dHRvbic7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJyc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGV2YWx1YXRlUG9zdFdhaXRDb21tYW5kKHRhcmdldDogYW55LCByZXM6IEFycmF5PGFueT4sIHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCk6IGFueSB7XHJcbiAgICBpZiAocGFyc2VkRXZlbnQ/Lm1vZGlmaWVycz8uaW5jbHVkZXMoXCJDb250cm9sXCIpKSAvL2F0dGVzYSBwZXIgYXBlcnR1cmEgaW4gbnVvdm8gdGFiXHJcbiAgICAgICAgcmV0dXJuIHRvY21kKFwid2FpdFwiLCBwYXJzZWRFdmVudCkoJycsIHRhcmdldCwgeyB2YWx1ZTogJzUwMDAnIH0pO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGV2YWx1YXRlUHJlV2FpdENvbW1hbmQodGFyZ2V0OiBhbnksIHJlczogQXJyYXk8YW55PiwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KTogYW55IHtcclxuICAgIHJldHVybiByZXM7Ly8gZGlzYWJpbGl0YXRvIHBlciBpbCBtb21lbnRvXHJcbiAgICB2YXIgc2VsZWN0b3JzID0gWyd0YWJiZXJDbG9zZUVsZW1lbnQnLCAnSURfRVhURE9DX0VYSVQnLCAndGFiYmVyRGlhbG9nQ2xvc2VFbGVtZW50J107XHJcbiAgICBsZXQgZWxlbWVudCA9IHRhcmdldDtcclxuICAgIHZhciBhdHRyID0gdGFyZ2V0LmF0dHJpYnV0ZXNbJ2RhdGEtdGVzdCddIHx8IHRhcmdldC5hdHRyaWJ1dGVzWydkYXRhLWN5J10gfHwgdGFyZ2V0LmF0dHJpYnV0ZXNbJ2NtcElkJ107XHJcbiAgICBpZiAoIWF0dHIpIHtcclxuICAgICAgICBlbGVtZW50ID0gdXBUb0lkKHRhcmdldCk7XHJcbiAgICAgICAgaWYgKCFlbGVtZW50KSByZXR1cm4gcmVzO1xyXG4gICAgICAgIGF0dHIgPSBlbGVtZW50LmF0dHJpYnV0ZXNbJ2RhdGEtdGVzdCddIHx8IGVsZW1lbnQuYXR0cmlidXRlc1snZGF0YS1jeSddIHx8IGVsZW1lbnQuYXR0cmlidXRlc1snY21wSWQnXTtcclxuICAgIH1cclxuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBzZWxlY3RvcnMubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgY29uc3QgZWwgPSBzZWxlY3RvcnNbaW5kZXhdO1xyXG4gICAgICAgIGlmICgoYXR0ci52YWx1ZSBhcyBzdHJpbmcpLmluZGV4T2YoZWwpID4gLTEpXHJcbiAgICAgICAgICAgIHJldHVybiBbLi4ucmVzLCB0b2NtZChcIndhaXRcIiwgcGFyc2VkRXZlbnQpKCcnLCB0YXJnZXQsIHsgdmFsdWU6ICc1MDAwJyB9KV07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2FwdHVyZUV2ZW50QXR0cmlidXRlcyhcclxuICAgIHRhcmdldDogYW55LFxyXG4gICAgY29tbWFuZDogKHNlbGVjdG9yOiBzdHJpbmcsIHRhcmdldD86IEVsZW1lbnQsIG9wdGlvbnM/OiBPcHRpb25zKSA9PiBDb21tYW5kLFxyXG4gICAgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50ID0gdW5kZWZpbmVkLFxyXG4gICAgcmVzOiBhbnkgPSBbXSxcclxuICAgIHBpY2tlciA9IGZhbHNlXHJcbik6IFByb21pc2U8Q29tbWFuZFtdPiB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHZhciBmaXJzdENsb3Nlc3RJZCA9IHVwVG9JZCh0YXJnZXQpO1xyXG4gICAgICAgIC8vaWYgKGZpcnN0Q2xvc2VzdElkPy5oYXNBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKSkgcmV0dXJuIHJlczsgLy9oeXBlcmxpbmsgb3JhIGxvIHJlZ2lzdHJvXHJcbiAgICAgICAgaWYgKHVwKFwidGItY2hlY2tib3hcIikodGFyZ2V0KSAmJiAhdGFyZ2V0Lm1hdGNoZXMoYGlucHV0W3R5cGU9J2NoZWNrYm94J11gKSkgcmV0dXJuIHJlcztcclxuXHJcbiAgICAgICAgcmVzID0gZXZhbHVhdGVQcmVXYWl0Q29tbWFuZCh0YXJnZXQsIHJlcywgcGFyc2VkRXZlbnQpO1xyXG5cclxuICAgICAgICBsZXQgY29tID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGxldCBkb2NrUGFuZWNDb20gPSB1bmRlZmluZWQ7XHJcblxyXG4gICAgICAgIGlmICghRG9ja2VyQ29tcG9uZW50LmlzRGVzaWduU3RhdGUodGFyZ2V0KSAmJiBEb2NrZXJDb21wb25lbnQuaXNDb21wb25lbnQodGFyZ2V0KSAmJiAhY29tICYmIHBpY2tlciA9PT0gZmFsc2UpXHJcbiAgICAgICAgICAgIGRvY2tQYW5lY0NvbSA9IERvY2tlckNvbXBvbmVudC5jYXB0dXJlKHRhcmdldCwgY29tbWFuZCwgcGFyc2VkRXZlbnQpO1xyXG5cclxuICAgICAgICBpZiAoSXRlbVNvdXJjZUNvbXBvbmVudC5pc0NvbXBvbmVudCh0YXJnZXQpKVxyXG4gICAgICAgICAgICBjb20gPSBhd2FpdCBJdGVtU291cmNlQ29tcG9uZW50LmNhcHR1cmUodGFyZ2V0LCBwYXJzZWRFdmVudCwgcGlja2VyKTtcclxuICAgICAgICBpZiAoS2VuZG9VcGxvYWRDb21wb25lbnQuaXNDb21wb25lbnQodGFyZ2V0KSAmJiAhY29tKVxyXG4gICAgICAgICAgICBjb20gPSBLZW5kb1VwbG9hZENvbXBvbmVudC5jYXB0dXJlKHRhcmdldCwgY29tbWFuZCwgcGFyc2VkRXZlbnQpO1xyXG4gICAgICAgIGlmIChSYWRhckNvbXBvbmVudC5pc0NvbXBvbmVudCh0YXJnZXQpICYmICFjb20pXHJcbiAgICAgICAgICAgIGNvbSA9IFJhZGFyQ29tcG9uZW50LmNhcHR1cmUodGFyZ2V0LCBjb21tYW5kLCBwYXJzZWRFdmVudCk7XHJcbiAgICAgICAgaWYgKChLZW5kb0dyaWRDb21wb25lbnQuaXNDb21wb25lbnQodGFyZ2V0KSB8fCBCb2R5RWRpdENvbXBvbmVudC5pc0NvbXBvbmVudCh0YXJnZXQpKSAmJiAhY29tKSB7XHJcbiAgICAgICAgICAgIGlmIChCb2R5RWRpdENvbXBvbmVudC5pc0NvbXBvbmVudCh0YXJnZXQpICYmICFjb20pXHJcbiAgICAgICAgICAgICAgICBjb20gPSBCb2R5RWRpdENvbXBvbmVudC5jYXB0dXJlKHRhcmdldCwgY29tbWFuZCwgcGFyc2VkRXZlbnQpOyAvL3RiLWJlXHJcbiAgICAgICAgICAgIGVsc2UgY29tID0gS2VuZG9HcmlkQ29tcG9uZW50LmNhcHR1cmUodGFyZ2V0LCBjb21tYW5kLCBwYXJzZWRFdmVudCk7IC8va2VuZG8tZ3JpZCBzZW1wbGljZVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoS2VuZG9UcmVlTGlzdENvbXBvbmVudC5pc0NvbXBvbmVudCh0YXJnZXQpICYmICFjb20pXHJcbiAgICAgICAgICAgIGNvbSA9IEtlbmRvVHJlZUxpc3RDb21wb25lbnQuY2FwdHVyZSh0YXJnZXQsIGNvbW1hbmQsIHBhcnNlZEV2ZW50KTtcclxuICAgICAgICBpZiAoRHluYW1pY0NoZWNrYm94Q29tcG9uZW50LmlzQ29tcG9uZW50KHRhcmdldCkgJiYgIWNvbSlcclxuICAgICAgICAgICAgY29tID0gRHluYW1pY0NoZWNrYm94Q29tcG9uZW50LmNhcHR1cmUodGFyZ2V0LCBjb21tYW5kLCBwYXJzZWRFdmVudCk7XHJcbiAgICAgICAgaWYgKFBhbmVsQ29tcG9uZW50LmlzQ29tcG9uZW50KHRhcmdldCkgJiYgIWNvbSlcclxuICAgICAgICAgICAgY29tID0gUGFuZWxDb21wb25lbnQuY2FwdHVyZSh0YXJnZXQsIGNvbW1hbmQsIHBhcnNlZEV2ZW50KTtcclxuICAgICAgICBpZiAoRGlhbG9nQ29tcG9uZW50LmlzQ29tcG9uZW50KHRhcmdldCkgJiYgIWNvbSlcclxuICAgICAgICAgICAgY29tID0gRGlhbG9nQ29tcG9uZW50LmNhcHR1cmUodGFyZ2V0LCBjb21tYW5kLCBwYXJzZWRFdmVudCk7XHJcbiAgICAgICAgaWYgKFdpbmRvd0NvbXBvbmVudC5pc0NvbXBvbmVudCh0YXJnZXQpICYmICFjb20pXHJcbiAgICAgICAgICAgIGNvbSA9IFdpbmRvd0NvbXBvbmVudC5jYXB0dXJlKHRhcmdldCwgY29tbWFuZCwgcGFyc2VkRXZlbnQpO1xyXG5cclxuICAgICAgICBpZiAoY29tKSByZXR1cm4gWy4uLnJlcywgZG9ja1BhbmVjQ29tLCBjb21dO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgICAgXCJnZW5lcmljIHNlbGVjdG9yIGZvciB0YXJnZXQ6IFwiLFxyXG4gICAgICAgICAgICB0YXJnZXQsXHJcbiAgICAgICAgICAgIGZpcnN0Q2xvc2VzdElkLFxyXG4gICAgICAgICAgICBnZXRJZChmaXJzdENsb3Nlc3RJZClcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAoIWZpcnN0Q2xvc2VzdElkICYmIHBhcnNlZEV2ZW50LmFjdGlvbiAhPT0gJ2tleWRvd24nKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZmlyc3RDbG9zZXN0SWQgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgLi4ucmVzLFxyXG4gICAgICAgICAgICBkb2NrUGFuZWNDb20sXHJcbiAgICAgICAgICAgIGNvbW1hbmQoZmlyc3RDbG9zZXN0SWQgPyBnZXRJZChmaXJzdENsb3Nlc3RJZCkgOiAnW2RhdGEtdGVzdC1hcHAtcm9vdF0nLCB0YXJnZXQsIHsgZm9yY2U6IGZhbHNlIH0pLFxyXG4gICAgICAgICAgICAvL2V2YWx1YXRlUG9zdFdhaXRDb21tYW5kKHRhcmdldCwgcmVzLCBwYXJzZWRFdmVudClcclxuICAgICAgICBdO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNhcHR1cmVEcmFnRHJvcEV2ZW50KGZyb21FbGVtZW50OiBEcmFnRXZlbnQsIHRvRWxlbWVudDogRHJhZ0V2ZW50LCBwYXJzZWRFdmVudDogUGFyc2VkRXZlbnQgPSB1bmRlZmluZWQpOiBQcm9taXNlPENvbW1hbmRbXT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB2YXIgYW5jID0gdXBUb0lkKGZyb21FbGVtZW50LnRhcmdldCBhcyBFbGVtZW50KTtcclxuICAgICAgICBjb25zdCBmcm9tSWQgPSBnZXRJZChhbmMpO1xyXG4gICAgICAgIGFuYyA9IHVwVG9JZCh0b0VsZW1lbnQudGFyZ2V0IGFzIEVsZW1lbnQpO1xyXG4gICAgICAgIGNvbnN0IHRvSWQgPSBnZXRJZChhbmMpO1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHRvY21kKFwiZHJhZ2Ryb3BcIiwgcGFyc2VkRXZlbnQpKHRvSWQsIHRvRWxlbWVudC50YXJnZXQgYXMgRWxlbWVudCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOiBcIkRyYWdEcm9wXCIsXHJcbiAgICAgICAgICAgICAgICBmcm9tU2VsZWN0b3I6IGZyb21JZFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIF07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFtdO1xyXG59XHJcblxyXG5cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIG1hZ29maW5kKFxyXG4gICAgZXZlbnQ6IEV2ZW50LFxyXG4gICAgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50XHJcbik6IFByb21pc2U8Q29tbWFuZFtdPiB7XHJcbiAgICBpZiAoc2tpcEZpbmQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIltNQ1JdIGZpbmQgc2tpcHBlZC5cIiwgZXZlbnQsIHBhcnNlZEV2ZW50KTtcclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgICBsZXQgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IGFzIEVsZW1lbnQ7XHJcblxyXG4gICAgaWYgKHNraXAoZXZlbnQsIHBhcnNlZEV2ZW50KSkgcmV0dXJuIFtdO1xyXG4gICAgc2tpcEZpbmQgPSB0cnVlO1xyXG4gICAgY29uc3QgW3JlcywgY2FwdHVyZWRCeV0gPSBhd2FpdCBoYW5kbGVDYXB0dXJpbmdDb250cm9scyh0YXJnZXQsIHBhcnNlZEV2ZW50KTtcclxuICAgIHNraXBGaW5kID0gZmFsc2U7XHJcbiAgICBpZiAoY2FwdHVyZWRCeSAhPT0gbnVsbCkgcmV0dXJuIHJlcztcclxuXHJcbiAgICBsZXQgY29tbWFuZCA9IHVuZGVmaW5lZDtcclxuICAgIHN3aXRjaCAocGFyc2VkRXZlbnQuYWN0aW9uKSB7XHJcbiAgICAgICAgY2FzZSBFdmVudFR5cGUuRFJBR1NUQVJUOiB7XHJcbiAgICAgICAgICAgIHBlbmRpbmdEcmFnID0gZXZlbnQgYXMgRHJhZ0V2ZW50O1xyXG4gICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhc2UgRXZlbnRUeXBlLkRST1A6IHtcclxuICAgICAgICAgICAgaWYgKCFwZW5kaW5nRHJhZykgcmV0dXJuIFtdO1xyXG4gICAgICAgICAgICByZXR1cm4gY2FwdHVyZURyYWdEcm9wRXZlbnQocGVuZGluZ0RyYWcsIGV2ZW50IGFzIERyYWdFdmVudCwgcGFyc2VkRXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlIEV2ZW50VHlwZS5DSEFOR0U6IHtcclxuICAgICAgICAgICAgY29tbWFuZCA9IHRvY21kKFwid3JpdGVcIiwgcGFyc2VkRXZlbnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gY2FwdHVyZUV2ZW50QXR0cmlidXRlcyh0YXJnZXQsIGNvbW1hbmQsIHBhcnNlZEV2ZW50LCByZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlIEV2ZW50VHlwZS5LRVlET1dOOiB7XHJcbiAgICAgICAgICAgIGNvbW1hbmQgPSB0b2NtZChcImtleWRvd25cIiwgcGFyc2VkRXZlbnQpO1xyXG4gICAgICAgICAgICBjb25zdCBrZXlUeXBlc0FjY2VwdGVkID0gW0tleWRvd25UeXBlLkVTQ0FQRSwgS2V5ZG93blR5cGUuRjEsIEtleWRvd25UeXBlLkYyLCBLZXlkb3duVHlwZS5GMywgS2V5ZG93blR5cGUuRjcsIEtleWRvd25UeXBlLkYxMCwgLypLZXlkb3duVHlwZS5UQUIqL107IC8vdGFiIGRhIGdlc3RpcmVcclxuICAgICAgICAgICAgaWYgKCFrZXlUeXBlc0FjY2VwdGVkLm1hcCh4ID0+IHgudG9TdHJpbmcoKSkuaW5jbHVkZXMocGFyc2VkRXZlbnQua2V5KSlcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXM7XHJcbiAgICAgICAgICAgIHJldHVybiBjYXB0dXJlRXZlbnRBdHRyaWJ1dGVzKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQsIGNvbW1hbmQsIHBhcnNlZEV2ZW50LCByZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlIEV2ZW50VHlwZS5EQkxDTElDSzpcclxuICAgICAgICAgICAgY29tbWFuZCA9IHRvY21kKFwiZGJsY2xpY2tcIiwgcGFyc2VkRXZlbnQpO1xyXG4gICAgICAgICAgICByZXR1cm4gY2FwdHVyZUV2ZW50QXR0cmlidXRlcyh0YXJnZXQsIGNvbW1hbmQsIHBhcnNlZEV2ZW50LCByZXMpO1xyXG4gICAgICAgIGNhc2UgRXZlbnRUeXBlLkNPTlRFWFRNRU5VOlxyXG4gICAgICAgIGNhc2UgRXZlbnRUeXBlLkNMSUNLOiB7XHJcbiAgICAgICAgICAgIGNvbW1hbmQgPSB0b2NtZChcImNsaWNrXCIsIHBhcnNlZEV2ZW50KTtcclxuICAgICAgICAgICAgcmV0dXJuIGNhcHR1cmVFdmVudEF0dHJpYnV0ZXModGFyZ2V0LCBjb21tYW5kLCBwYXJzZWRFdmVudCwgcmVzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlcztcclxufVxyXG5cclxuXHJcblxyXG5jb25zdCBza2lwID0gKF86IEV2ZW50LCBwYXJzZWRFdmVudDogUGFyc2VkRXZlbnQpID0+XHJcbiAgICAocGFyc2VkRXZlbnQuYWN0aW9uID09PSBFdmVudFR5cGUuQ0hBTkdFIHx8XHJcbiAgICAgICAgcGFyc2VkRXZlbnQuYWN0aW9uID09PSBFdmVudFR5cGUuS0VZRE9XTikgJiZcclxuICAgIChwYXJzZWRFdmVudC5pbnB1dFR5cGUgPT09IFwiY2hlY2tib3hcIiB8fCBwYXJzZWRFdmVudC5pbnB1dFR5cGUgPT09IFwicmFkaW9cIik7XHJcblxyXG4vKipcclxuICogUGFyc2VzIERPTSBldmVudHMgaW50byBhbiBvYmplY3Qgd2l0aCB0aGUgbmVjZXNzYXJ5IGRhdGEuXHJcbiAqIEBwYXJhbSBldmVudFxyXG4gKiBAcmV0dXJucyB7UGFyc2VkRXZlbnRbXX1cclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIHBhcnNlRXZlbnQoZXZlbnQ6IEV2ZW50KTogUHJvbWlzZTxQYXJzZWRFdmVudFtdPiB7XHJcbiAgICAvL2NvbnNvbGUubG9nKCdwYXJzZUV2ZW50JywgZXZlbnQpO1xyXG4gICAgY29uc3QgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50ID0ge1xyXG4gICAgICAgIGFjdGlvbjogZXZlbnQudHlwZSxcclxuICAgICAgICB0YWc6IChldmVudC50YXJnZXQgYXMgRWxlbWVudCkudGFnTmFtZSxcclxuICAgICAgICB2YWx1ZTogWydjaGVja2JveCcsICdyYWRpbyddLmluY2x1ZGVzKChldmVudC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudHlwZSkgPyAoZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLmNoZWNrZWQgKyAnJyA6IChldmVudC50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUsXHJcbiAgICAgICAgcGFnZUluZGV4OiB3aW5kb3dbJ19fX21jcl9fX3BhZ2VJbmRleCddICE9PSB1bmRlZmluZWQgPyB3aW5kb3dbJ19fX21jcl9fX3BhZ2VJbmRleCddIDogMFxyXG4gICAgfTtcclxuICAgIGlmICgoZXZlbnQudGFyZ2V0IGFzIEhUTUxBbmNob3JFbGVtZW50KS5oYXNBdHRyaWJ1dGUoXCJocmVmXCIpKVxyXG4gICAgICAgIHBhcnNlZEV2ZW50LmhyZWYgPSAoZXZlbnQudGFyZ2V0IGFzIEhUTUxBbmNob3JFbGVtZW50KS5ocmVmO1xyXG5cclxuICAgIGlmICgoZXZlbnQudGFyZ2V0IGFzIEVsZW1lbnQpLmhhc0F0dHJpYnV0ZShcImlkXCIpKVxyXG4gICAgICAgIHBhcnNlZEV2ZW50LmlkID0gKGV2ZW50LnRhcmdldCBhcyBFbGVtZW50KS5pZDtcclxuXHJcbiAgICBpZiAocGFyc2VkRXZlbnQudGFnID09PSBcIklOUFVUXCIpXHJcbiAgICAgICAgcGFyc2VkRXZlbnQuaW5wdXRUeXBlID0gKGV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50KS50eXBlO1xyXG5cclxuICAgIGlmIChldmVudC50eXBlID09PSBcImtleWRvd25cIilcclxuICAgICAgICBwYXJzZWRFdmVudC5rZXkgPSAoZXZlbnQgYXMgS2V5Ym9hcmRFdmVudCkua2V5O1xyXG5cclxuICAgIHZhciBtb2RpZmllcnMgPSBbXCJBbHRcIiwgXCJDb250cm9sXCIsIFwiTWV0YVwiLCBcIlNoaWZ0XCJdO1xyXG4gICAgcGFyc2VkRXZlbnQubW9kaWZpZXJzID0gW107XHJcbiAgICBtb2RpZmllcnMuZm9yRWFjaChtb2QgPT4ge1xyXG4gICAgICAgIGlmICgoZXZlbnQgaW5zdGFuY2VvZiBLZXlib2FyZEV2ZW50IHx8IGV2ZW50IGluc3RhbmNlb2YgUG9pbnRlckV2ZW50KSAmJiBldmVudC5nZXRNb2RpZmllclN0YXRlKG1vZCkpIHBhcnNlZEV2ZW50Lm1vZGlmaWVycy5wdXNoKG1vZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgcmVzID0gYXdhaXQgbWFnb2ZpbmQoZXZlbnQsIHBhcnNlZEV2ZW50KTtcclxuICAgIHJlcyA9IHJlcy5maWx0ZXIoeCA9PiAhIXgpOyAvL3RvbGdvIGkgbnVsbGlcclxuICAgIGNvbnNvbGUubG9nKFwicmVzOiBcIiwgcmVzKTtcclxuICAgIHJldHVybiByZXMubWFwKHggPT4gKHsgLi4ueCwgRXZlbnRUeXBlOiBwYXJzZWRFdmVudC5hY3Rpb24gfSkpLm1hcCgoY29tbWFuZCkgPT4gKHsgLi4ucGFyc2VkRXZlbnQsIC4uLnsgY29tbWFuZCB9IH0pKTtcclxufVxyXG5cclxuIiwiaW1wb3J0IHsgY3NzZXNjIH0gZnJvbSAnLi9jc3Nlc2MnO1xyXG5leHBvcnQgeyBjc3Nlc2MgfTtcclxuXHJcbmV4cG9ydCBjb25zdCBpc0luQWN0aXZlRG9jID0gKGVsOiBFbGVtZW50KSA9PiAhIWFjdGl2ZURvYyhlbCk7XHJcbmV4cG9ydCBjb25zdCBhY3RpdmVEb2MgPSAoZWw6IEVsZW1lbnQpID0+XHJcbiAgdXAoYC50YWJiZXItY29udGVudD5rZW5kby10YWJzdHJpcD5bcm9sZT0ndGFicGFuZWwnXVthcmlhLWhpZGRlbj0nZmFsc2UnXWApKGVsKTtcclxuZXhwb3J0IGNvbnN0IGRlbGF5ID0gbXMgPT4gbmV3IFByb21pc2UocmVzID0+IHNldFRpbWVvdXQoKCkgPT4gcmVzKDApLCBtcykpO1xyXG5leHBvcnQgY29uc3QgZ2V0SWQgPSAoZWw/OiBFbGVtZW50KSA9PiB7XHJcbiAgbGV0IGlkO1xyXG4gIGlmICgoaWQgPSBlbD8uZ2V0QXR0cmlidXRlKCdkYXRhLXRlc3QnKSkpIHJldHVybiBgW2RhdGEtdGVzdD0nJHtpZH0nXWA7XHJcbiAgaWYgKChpZCA9IGVsPy5nZXRBdHRyaWJ1dGUoJ3BhcmVudC1kYXRhLXRlc3QnKSkpIHJldHVybiBgW3BhcmVudC1kYXRhLXRlc3Q9JyR7aWR9J11gO1xyXG4gIGlmICgoaWQgPSBlbD8uZ2V0QXR0cmlidXRlKCdjbXBpZCcpKSkgcmV0dXJuIGBbY21waWQ9JyR7aWR9J11gO1xyXG4gIGlmICgoaWQgPSBlbD8uZ2V0QXR0cmlidXRlKCdkYXRhLWN5JykpKSByZXR1cm4gYFtkYXRhLWN5PScke2lkfSddYDtcclxuICByZXR1cm4gbnVsbDtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRTZXR0aW5ncyA9IChlbD86IEVsZW1lbnQpOiB7IHJvd0luZGV4PzogYm9vbGVhbiB9ID0+IHtcclxuICAgIGxldCBzZXR0aW5ncztcclxuICAgIGlmICgoc2V0dGluZ3MgPSBlbD8uZ2V0QXR0cmlidXRlKCdkYXRhLXNldHRpbmdzJykpKSByZXR1cm4gSlNPTi5wYXJzZShzZXR0aW5ncyk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIFNlbGVjdG9yID0gKChlbDogRWxlbWVudCkgPT4gYm9vbGVhbikgfCBzdHJpbmcgfCBFbGVtZW50O1xyXG5cclxuZXhwb3J0IGNvbnN0IHVwID0gKHRvOiBTZWxlY3RvcikgPT4gKGZyb206IEVsZW1lbnQsIHN0b3BPbj86IFNlbGVjdG9yLCBjb3VudD86IG51bWJlcikgPT4ge1xyXG4gIGNvbnN0IHVwU2VsZWN0b3JUb1ByZWQgPSBzID0+XHJcbiAgICBzID8gKHR5cGVvZiBzID09PSAnb2JqZWN0JyA/IGVsID0+IGVsID09PSBzIDogdHlwZW9mIHMgPT09ICdzdHJpbmcnID8gZWwgPT4gZWwubWF0Y2hlcyhzKSA6IHMpIDogXyA9PiBmYWxzZTtcclxuICBjb25zdCB0YXJnZXRQcmVkID0gdXBTZWxlY3RvclRvUHJlZCh0byk7XHJcbiAgY29uc3QgdW50aWxQcmVkID0gdXBTZWxlY3RvclRvUHJlZChzdG9wT24pO1xyXG4gIHdoaWxlIChmcm9tICYmICF1bnRpbFByZWQoZnJvbSkgJiYgKCFjb3VudCB8fCBjb3VudCA+IDApKSB7XHJcbiAgICBpZiAodGFyZ2V0UHJlZChmcm9tKSkgcmV0dXJuIGZyb207XHJcbiAgICBpZiAodHlwZW9mIHN0b3BPbiA9PT0gJ3N0cmluZycgJiYgZnJvbS5tYXRjaGVzKHN0b3BPbikpIHJldHVybiBudWxsO1xyXG4gICAgZnJvbSA9IGZyb20ucGFyZW50RWxlbWVudDtcclxuICAgIGlmIChjb3VudCkgY291bnQtLTtcclxuICB9XHJcbiAgcmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgaXNDdHJsID0gZWwgPT4gZWwudGFnTmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoJ3RiLScpIHx8IGVsLnRhZ05hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCdrZW5kby0nKTtcclxuZXhwb3J0IGNvbnN0IGhhc0lkID0gZWwgPT4gZ2V0SWQoZWwpICE9PSBudWxsO1xyXG5leHBvcnQgY29uc3QgdXBUb0N0cmwgPSB1cChpc0N0cmwpO1xyXG5leHBvcnQgY29uc3QgdXBUb0lkID0gdXAoaGFzSWQpO1xyXG5leHBvcnQgY29uc3QgdXBUb0N0cmxPcklkID0gdXAoZWwgPT4gaGFzSWQoZWwpIHx8IGlzQ3RybChlbCkpO1xyXG5leHBvcnQgY29uc3QgdXBUb0N0cmxXaXRoSWQgPSB1cChlbCA9PiBoYXNJZChlbCkgJiYgaXNDdHJsKGVsKSk7XHJcbmV4cG9ydCBjb25zdCBpc1RhZyA9IChlbD86IEVsZW1lbnQsIC4uLnRhZ3M6IHN0cmluZ1tdKSA9PiB0YWdzLnNvbWUodCA9PiBlbD8udGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSB0LnRvTG93ZXJDYXNlKCkpO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldENsYXNzZXMoaW5wdXQ6IEVsZW1lbnQsIHByZWQpOiBzdHJpbmdbXSB7XHJcbiAgY29uc3QgbmFtZXMgPSBBcnJheS5mcm9tKGlucHV0LmNsYXNzTGlzdCkuZmlsdGVyKHByZWQpO1xyXG4gIHJldHVybiBuYW1lcy5tYXAobmFtZSA9PiAnLicgKyBjc3Nlc2MobmFtZSwgeyBpc0lkZW50aWZpZXI6IHRydWUgfSkpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZXNjKGNzczogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gY3NzLnRyaW0oKTtcclxufVxyXG4iLCJjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcclxuICBlc2NhcGVFdmVyeXRoaW5nOiBmYWxzZSxcclxuICBpc0lkZW50aWZpZXI6IGZhbHNlLFxyXG4gIHF1b3RlczogJ2JhY2t0aWNrJyxcclxuICB3cmFwOiBmYWxzZSxcclxufTtcclxuY29uc3QgcmVnZXhBbnlTaW5nbGVFc2NhcGUgPSAvWyAtLFxcLlxcLzotQFxcWy1cXF5gXFx7LX5dLztcclxuY29uc3QgcmVnZXhTaW5nbGVFc2NhcGUgPSAvWyAtLFxcLlxcLzotQFxcW1xcXVxcXmBcXHstfl0vO1xyXG5jb25zdCByZWdleEV4Y2Vzc2l2ZVNwYWNlcyA9IC8oXnxcXFxcKyk/KFxcXFxbQS1GMC05XXsxLDZ9KVxceDIwKD8hW2EtZkEtRjAtOVxceDIwXSkvZztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjc3Nlc2Moc3RyaW5nOiBzdHJpbmcsIG9wdDogUGFydGlhbDx0eXBlb2YgZGVmYXVsdE9wdGlvbnM+ID0ge30pIHtcclxuICBjb25zdCBvcHRpb25zID0geyAuLi5kZWZhdWx0T3B0aW9ucywgLi4ub3B0IH07XHJcbiAgaWYgKG9wdGlvbnMucXVvdGVzICE9ICdzaW5nbGUnICYmIG9wdGlvbnMucXVvdGVzICE9ICdkb3VibGUnKSB7XHJcbiAgICBvcHRpb25zLnF1b3RlcyA9ICdiYWNrdGljayc7XHJcbiAgfVxyXG4gIGNvbnN0IHF1b3RlID0gb3B0aW9ucy5xdW90ZXMgPT0gJ2JhY2t0aWNrJyA/ICdgJyA6ICdkb3VibGUnID8gJ1wiJyA6IFwiJ1wiO1xyXG4gIGNvbnN0IGlzSWRlbnRpZmllciA9IG9wdGlvbnMuaXNJZGVudGlmaWVyO1xyXG5cclxuICBjb25zdCBmaXJzdENoYXIgPSBzdHJpbmcuY2hhckF0KDApO1xyXG4gIGxldCBvdXRwdXQgPSAnJztcclxuICBsZXQgY291bnRlciA9IDA7XHJcbiAgY29uc3QgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aDtcclxuICB3aGlsZSAoY291bnRlciA8IGxlbmd0aCkge1xyXG4gICAgY29uc3QgY2hhcmFjdGVyID0gc3RyaW5nLmNoYXJBdChjb3VudGVyKyspO1xyXG4gICAgbGV0IGNvZGVQb2ludCA9IGNoYXJhY3Rlci5jaGFyQ29kZUF0KDApO1xyXG4gICAgbGV0IHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB2b2lkIDA7XHJcbiAgICAvLyBJZiBpdOKAmXMgbm90IGEgcHJpbnRhYmxlIEFTQ0lJIGNoYXJhY3RlcuKAplxyXG4gICAgaWYgKGNvZGVQb2ludCA8IDB4MjAgfHwgY29kZVBvaW50ID4gMHg3ZSkge1xyXG4gICAgICBpZiAoY29kZVBvaW50ID49IDB4ZDgwMCAmJiBjb2RlUG9pbnQgPD0gMHhkYmZmICYmIGNvdW50ZXIgPCBsZW5ndGgpIHtcclxuICAgICAgICAvLyBJdOKAmXMgYSBoaWdoIHN1cnJvZ2F0ZSwgYW5kIHRoZXJlIGlzIGEgbmV4dCBjaGFyYWN0ZXIuXHJcbiAgICAgICAgY29uc3QgZXh0cmEgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspO1xyXG4gICAgICAgIGlmICgoZXh0cmEgJiAweGZjMDApID09IDB4ZGMwMCkge1xyXG4gICAgICAgICAgLy8gbmV4dCBjaGFyYWN0ZXIgaXMgbG93IHN1cnJvZ2F0ZVxyXG4gICAgICAgICAgY29kZVBvaW50ID0gKChjb2RlUG9pbnQgJiAweDNmZikgPDwgMTApICsgKGV4dHJhICYgMHgzZmYpICsgMHgxMDAwMDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gSXTigJlzIGFuIHVubWF0Y2hlZCBzdXJyb2dhdGU7IG9ubHkgYXBwZW5kIHRoaXMgY29kZSB1bml0LCBpbiBjYXNlXHJcbiAgICAgICAgICAvLyB0aGUgbmV4dCBjb2RlIHVuaXQgaXMgdGhlIGhpZ2ggc3Vycm9nYXRlIG9mIGEgc3Vycm9nYXRlIHBhaXIuXHJcbiAgICAgICAgICBjb3VudGVyLS07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHZhbHVlID0gJ1xcXFwnICsgY29kZVBvaW50LnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpICsgJyAnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKG9wdGlvbnMuZXNjYXBlRXZlcnl0aGluZykge1xyXG4gICAgICAgIGlmIChyZWdleEFueVNpbmdsZUVzY2FwZS50ZXN0KGNoYXJhY3RlcikpIHtcclxuICAgICAgICAgIHZhbHVlID0gJ1xcXFwnICsgY2hhcmFjdGVyO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB2YWx1ZSA9ICdcXFxcJyArIGNvZGVQb2ludC50b1N0cmluZygxNikudG9VcHBlckNhc2UoKSArICcgJztcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSBpZiAoL1tcXHRcXG5cXGZcXHJcXHgwQl0vLnRlc3QoY2hhcmFjdGVyKSkge1xyXG4gICAgICAgIHZhbHVlID0gJ1xcXFwnICsgY29kZVBvaW50LnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpICsgJyAnO1xyXG4gICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgIGNoYXJhY3RlciA9PSAnXFxcXCcgfHxcclxuICAgICAgICAoIWlzSWRlbnRpZmllciAmJiAoKGNoYXJhY3RlciA9PSAnXCInICYmIHF1b3RlID09IGNoYXJhY3RlcikgfHwgKGNoYXJhY3RlciA9PSBcIidcIiAmJiBxdW90ZSA9PSBjaGFyYWN0ZXIpKSkgfHxcclxuICAgICAgICAoaXNJZGVudGlmaWVyICYmIHJlZ2V4U2luZ2xlRXNjYXBlLnRlc3QoY2hhcmFjdGVyKSlcclxuICAgICAgKSB7XHJcbiAgICAgICAgdmFsdWUgPSAnXFxcXCcgKyBjaGFyYWN0ZXI7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdmFsdWUgPSBjaGFyYWN0ZXI7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIG91dHB1dCArPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIGlmIChpc0lkZW50aWZpZXIpIHtcclxuICAgIGlmICgvXi1bLVxcZF0vLnRlc3Qob3V0cHV0KSkge1xyXG4gICAgICBvdXRwdXQgPSAnXFxcXC0nICsgb3V0cHV0LnNsaWNlKDEpO1xyXG4gICAgfSBlbHNlIGlmICgvXFxkLy50ZXN0KGZpcnN0Q2hhcikpIHtcclxuICAgICAgb3V0cHV0ID0gJ1xcXFwzJyArIGZpcnN0Q2hhciArICcgJyArIG91dHB1dC5zbGljZSgxKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIFJlbW92ZSBzcGFjZXMgYWZ0ZXIgYFxcSEVYYCBlc2NhcGVzIHRoYXQgYXJlIG5vdCBmb2xsb3dlZCBieSBhIGhleCBkaWdpdCxcclxuICAvLyBzaW5jZSB0aGV54oCZcmUgcmVkdW5kYW50LiBOb3RlIHRoYXQgdGhpcyBpcyBvbmx5IHBvc3NpYmxlIGlmIHRoZSBlc2NhcGVcclxuICAvLyBzZXF1ZW5jZSBpc27igJl0IHByZWNlZGVkIGJ5IGFuIG9kZCBudW1iZXIgb2YgYmFja3NsYXNoZXMuXHJcbiAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UocmVnZXhFeGNlc3NpdmVTcGFjZXMsIGZ1bmN0aW9uICgkMCwgJDEsICQyKSB7XHJcbiAgICBpZiAoJDEgJiYgJDEubGVuZ3RoICUgMikge1xyXG4gICAgICAvLyBJdOKAmXMgbm90IHNhZmUgdG8gcmVtb3ZlIHRoZSBzcGFjZSwgc28gZG9u4oCZdC5cclxuICAgICAgcmV0dXJuICQwO1xyXG4gICAgfVxyXG4gICAgLy8gU3RyaXAgdGhlIHNwYWNlLlxyXG4gICAgcmV0dXJuICgkMSB8fCAnJykgKyAkMjtcclxuICB9KTtcclxuXHJcbiAgaWYgKCFpc0lkZW50aWZpZXIgJiYgb3B0aW9ucy53cmFwKSB7XHJcbiAgICByZXR1cm4gcXVvdGUgKyBvdXRwdXQgKyBxdW90ZTtcclxuICB9XHJcbiAgcmV0dXJuIG91dHB1dDtcclxufVxyXG4iLCJleHBvcnQgdHlwZSBFeGF1c3RpdmU8VCBleHRlbmRzIHN0cmluZyB8IG51bWJlciwgUj4gPSB7XHJcbiAgW2tleSBpbiBUXTogUjtcclxufTtcclxuZXhwb3J0IHR5cGUgTm90RXhhdXN0aXZlPFQgZXh0ZW5kcyBzdHJpbmcgfCBudW1iZXIsIFI+ID0ge1xyXG4gIFtrZXkgaW4gVF0/OiBSO1xyXG59ICYgeyBfOiBSIH07XHJcblxyXG5leHBvcnQgY29uc3QgbWF0Y2ggPVxyXG4gIDxUIGV4dGVuZHMgc3RyaW5nIHwgbnVtYmVyLCBSID0gYW55PihtYXA6IEV4YXVzdGl2ZTxULCBSPiB8IE5vdEV4YXVzdGl2ZTxULCBSPikgPT5cclxuICAoc2VsZWN0b3I6IFQpOiBSID0+XHJcbiAgICBzZWxlY3RvciBpbiBtYXAgPyBtYXBbc2VsZWN0b3JdIDogJ18nIGluIG1hcCA/IG1hcFsnXyddIDogbnVsbDtcclxuXHJcbi8vIEV4YW1wbGVzXHJcbmV4cG9ydCB0eXBlIEFuaW1hbHMgPSAnZG9nJyB8ICdjYXQnIHwgJ2JpcmQnIHwgJ2JlYXInIHwgJ2hvcnNlJztcclxuXHJcbm1hdGNoPEFuaW1hbHM+KHtcclxuICBiZWFyOiAncm9hcicsXHJcbiAgYmlyZDogJ2NpcCcsXHJcbiAgY2F0OiAnbWlhbycsXHJcbiAgZG9nOiAnYmF1JyxcclxuICBob3JzZTogJ2JvaCcsXHJcbn0pKCdkb2cnKTtcclxuXHJcbm1hdGNoPEFuaW1hbHM+KHtcclxuICBiZWFyOiAncm9hcicsXHJcbiAgYmlyZDogJ2NpcCcsXHJcbiAgY2F0OiAnbWlhbycsXHJcbiAgXzogJ2JvaCcsXHJcbn0pKCdkb2cnKTtcclxuIiwiXHJcbmltcG9ydCB7IHRvY21kIH0gZnJvbSBcIi4vZXZlbnRQYXJzZXJcIjtcclxuaW1wb3J0IHsgQ29tbWFuZCwgQ29tbWFuZFR5cGUsIE9wdGlvbnMsIFBhcnNlZEV2ZW50LCBUYWdzIH0gZnJvbSBcIi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgZGVsYXksIGdldElkLCBnZXRTZXR0aW5ncywgaXNUYWcsIHVwLCB1cFRvQ3RybFdpdGhJZCwgdXBUb0lkIH0gZnJvbSBcIi4vdVwiO1xyXG5cclxuY29uc3Qga2VuZG9HcmlkUm93SW5kZXhBdHRyID0gXCJkYXRhLWtlbmRvLWdyaWQtaXRlbS1pbmRleFwiO1xyXG5jb25zdCBrZW5kb0dyaWRDb2xJbmRleEF0dHIgPSBcImRhdGEta2VuZG8tZ3JpZC1jb2x1bW4taW5kZXhcIjtcclxuY29uc3Qga2VuZG9UcmVlbGlzdFJvd0luZGV4QXR0ciA9IFwiZGF0YS10cmVlbGlzdC12aWV3LWluZGV4XCI7XHJcbmNvbnN0IGtlbmRvVHJlZWxpc3RDb2xJbmRleEF0dHIgPSBcImFyaWEtY29saW5kZXhcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBHZW5lcmljQ29tbWFuZENvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgaXNDb21wb25lbnQodGFyZ2V0OiBFbGVtZW50LCB0YWdOYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICB2YXIgYW5jID0gdXBUb0lkKHRhcmdldCk7XHJcbiAgICAgICAgcmV0dXJuIGlzVGFnKGFuYywgdGFnTmFtZSk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCwgdGFnOiBUYWdzLCBjb21tYW5kOiBDb21tYW5kVHlwZSwgc2VsZWN0b3I6IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkdlbmVyaWNDb21tYW5kQ29tcG9uZW50IGNhcHR1cmVcIik7XHJcbiAgICAgICAgdmFyIGFuYyA9IHVwVG9JZCh0YXJnZXQpO1xyXG4gICAgICAgIGNvbnN0IGlkID0gZ2V0SWQoYW5jKTtcclxuICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZ2V0VmFsdWUodGFyZ2V0LCBzZWxlY3RvciwgYXR0cmlidXRlKTtcclxuICAgICAgICByZXR1cm4gdG9jbWQoY29tbWFuZCwgcGFyc2VkRXZlbnQpKGlkLCB0YXJnZXQsIHsgdGFnLCBldmVudFZhbHVlOiB2YWx1ZSB9KTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBnZXRWYWx1ZSh0YXJnZXQ6IEVsZW1lbnQsIHNlbGVjdG9yOiBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICBpZiAoc2VsZWN0b3IpXHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik/LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xyXG4gICAgICAgIGVsc2UgcmV0dXJuIHRhcmdldC5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKTtcclxuICAgIH1cclxufVxyXG5leHBvcnQgY2xhc3MgSXRlbVNvdXJjZUNvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgaXNDb21wb25lbnQodGFyZ2V0OiBFbGVtZW50KTogRWxlbWVudCB7XHJcbiAgICAgICAgcmV0dXJuIHVwKFwidGItaXRlbS1zb3VyY2VcIikodGFyZ2V0KSB8fCB1cChcIi50Yi1wb3B1cC1pdGVtLXNvdXJjZS1jb250ZW50XCIpKHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgYXN5bmMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCwgaXNQaWNrZXI6IGJvb2xlYW4pIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkl0ZW1Tb3VyY2VDb21wb25lbnQgY2FwdHVyZVwiKTtcclxuICAgICAgICB2YXIgYW5jUGFyZW50ID0gdXBUb0lkKHRhcmdldCk7XHJcbiAgICAgICAgaWYgKGFuY1BhcmVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGVzdCcpPy5zdGFydHNXaXRoKCdpdGVtU291cmNlRHJvcERvd25CdXR0b24nKSkgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKTtcclxuICAgICAgICBpZiAoYW5jUGFyZW50LmdldEF0dHJpYnV0ZSgnZGF0YS10ZXN0Jyk/LnN0YXJ0c1dpdGgoJ2l0ZW1Tb3VyY2VBZGRPbkZseScpKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xyXG4gICAgICAgIGNvbnN0IGlkID0gZ2V0SWQoYW5jUGFyZW50KTtcclxuICAgICAgICBjb25zdCB2YWx1ZURhdGFUZXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihpZCkuZ2V0QXR0cmlidXRlKFwicGFyZW50LWRhdGEtdGVzdFwiKTtcclxuICAgICAgICBpZiAodmFsdWVEYXRhVGVzdCkgeyAvL3Nvbm8gbmVsbGEgdGVuZGluYSBwZXJjaO+/vSBobyBwYXJlbnQtZGF0YS10ZXN0XHJcbiAgICAgICAgICAgIGF3YWl0IGRlbGF5KDEwMCk7XHJcbiAgICAgICAgICAgIHZhciBpdGVtU291cmNlID0gdXAoXCJ0Yi1pdGVtLXNvdXJjZVwiKShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS10ZXN0PScke3ZhbHVlRGF0YVRlc3R9J11gKSlcclxuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmdldFZhbHVlRnJvbVNlbGVjdG9yKHZhbHVlRGF0YVRlc3QpO1xyXG4gICAgICAgICAgICByZXR1cm4gdG9jbWQoJ3NlbGVjdCcsIHBhcnNlZEV2ZW50KShnZXRJZChpdGVtU291cmNlKSwgdGFyZ2V0LCB7IHRhZzogXCJJdGVtU291cmNlXCIsIGV2ZW50VmFsdWU6IHZhbHVlIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNQaWNrZXIpIHtcclxuICAgICAgICAgICAgdmFyIGl0ZW1Tb3VyY2VJbnB1dCA9IHRhcmdldC5xdWVyeVNlbGVjdG9yKFwiW3NlbGVjdGVkLWlkXVwiKSB8fCB0YXJnZXQ7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuZ2V0VmFsdWUoaXRlbVNvdXJjZUlucHV0KTtcclxuICAgICAgICAgICAgdmFyIGl0ZW1Tb3VyY2UgPSB1cChcInRiLWl0ZW0tc291cmNlXCIpKGl0ZW1Tb3VyY2VJbnB1dCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0b2NtZCgnc2VsZWN0JywgcGFyc2VkRXZlbnQpKGAke2dldElkKGl0ZW1Tb3VyY2UpfSAke2dldElkKGl0ZW1Tb3VyY2VJbnB1dCl9YCwgaXRlbVNvdXJjZUlucHV0LCB7IHRhZzogXCJJdGVtU291cmNlXCIsIGV2ZW50VmFsdWU6IHZhbHVlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHN0YXRpYyBnZXRWYWx1ZUZyb21TZWxlY3Rvcih2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICB2YXIgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtdGVzdD0nJHt2YWx1ZX0nXWApO1xyXG4gICAgICAgIHJldHVybiB0YXJnZXQ/LmdldEF0dHJpYnV0ZShcInNlbGVjdGVkLWlkXCIpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGdldFZhbHVlKHRhcmdldCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRhcmdldD8uZ2V0QXR0cmlidXRlKFwic2VsZWN0ZWQtaWRcIik7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBQYW5lbENvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgaXNDb21wb25lbnQodGFyZ2V0OiBFbGVtZW50KTogYm9vbGVhbiB7XHJcbiAgICAgICAgdmFyIGFuYyA9IHVwVG9JZCh0YXJnZXQpO1xyXG4gICAgICAgIHJldHVybiBpc1RhZyhhbmMsIFwidGItcGFuZWxcIik7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIGNvbW1hbmQ6IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZCwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJQYW5lbENvbXBvbmVudCBjYXB0dXJlXCIpO1xyXG4gICAgICAgIHZhciBhbmMgPSB1cFRvSWQodGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBpZCA9IGdldElkKGFuYyk7XHJcbiAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQsIHRhcmdldCwge1xyXG4gICAgICAgICAgICB0YWc6IFwiVGJQYW5lbFwiLFxyXG4gICAgICAgICAgICBkaXNwbGF5OiBcImV4cGFuZC9jb2xsYXBzZVwiLFxyXG4gICAgICAgICAgICBvdGhlcjogYW5jLmNsYXNzTGlzdC5jb250YWlucyhcImNvbGxhcHNlZFwiKSA/ICdleHBhbmQnIDogJ2NvbGxhcHNlJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRHluYW1pY0NoZWNrYm94Q29tcG9uZW50IHtcclxuICAgIHN0YXRpYyBpc0NvbXBvbmVudCh0YXJnZXQ6IEVsZW1lbnQpOiBFbGVtZW50IHtcclxuICAgICAgICByZXR1cm4gdXAoXCJ0Yi1keW5hbWljLWNoZWNrYm94LWxpc3RcIikodGFyZ2V0KTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBjYXB0dXJlKHRhcmdldDogRWxlbWVudCwgY29tbWFuZDogKHNlbGVjdG9yOiBzdHJpbmcsIHRhcmdldD86IEVsZW1lbnQsIG9wdGlvbnM/OiBPcHRpb25zKSA9PiBDb21tYW5kLCBwYXJzZWRFdmVudDogUGFyc2VkRXZlbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkR5bmFtaWNDaGVja2JveENvbXBvbmVudCBjYXB0dXJlXCIpO1xyXG4gICAgICAgIHZhciBhbmMgPSB1cFRvSWQodGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBpZCA9IGdldElkKGFuYyk7XHJcbiAgICAgICAgaWYgKHRhcmdldC50YWdOYW1lID09IFwiTEFCRUxcIiB8fCB0YXJnZXQudGFnTmFtZSA9PSBcIlNQQU5cIikgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQsIHRhcmdldCwge1xyXG4gICAgICAgICAgICB0YWc6IFwiRHluYW1pY0NoZWNrYm94XCIsXHJcbiAgICAgICAgICAgIGV2ZW50VmFsdWU6IHRhcmdldC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCJsYWJlbFwiKS5pbm5lclRleHQsXHJcbiAgICAgICAgICAgIGV2ZW50S2V5OiBwYXJzZWRFdmVudD8ua2V5LFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgS2VuZG9UcmVlTGlzdENvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgaXNDb21wb25lbnQodGFyZ2V0OiBFbGVtZW50KTogRWxlbWVudCB7XHJcbiAgICAgICAgcmV0dXJuIHVwKFwia2VuZG8tdHJlZWxpc3RcIikodGFyZ2V0KTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBjYXB0dXJlKHRhcmdldDogRWxlbWVudCwgY29tbWFuZDogKHNlbGVjdG9yOiBzdHJpbmcsIHRhcmdldD86IEVsZW1lbnQsIG9wdGlvbnM/OiBPcHRpb25zKSA9PiBDb21tYW5kLCBwYXJzZWRFdmVudDogUGFyc2VkRXZlbnQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIktlbmRvVHJlZUxpc3RDb21wb25lbnQgY2FwdHVyZVwiKTtcclxuICAgICAgICB2YXIgYW5jID0gdXBUb0lkKHRhcmdldCk7XHJcbiAgICAgICAgbGV0IGlkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGlmICh0YXJnZXQudGFnTmFtZSA9PSAnVEQnKVxyXG4gICAgICAgICAgICBpZCA9IGdldElkKHRhcmdldC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10ZXN0XScpKTtcclxuICAgICAgICBlbHNlIGlkID0gZ2V0SWQoYW5jKTtcclxuICAgICAgICBpZiAodXAoXCJrZW5kby10cmVlbGlzdC10b29sYmFyXCIpKHRhcmdldCkgJiYgYW5jLmF0dHJpYnV0ZXNbXCJkYXRhLXRlc3RcIl0pXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKGlkLCBhbmMpO1xyXG4gICAgICAgIC8vaWYgKHRhcmdldC5hdHRyaWJ1dGVzW1wiZGF0YS10ZXN0XCJdKSByZXR1cm4gY21kLmNsaWNrKGlkLCB0YXJnZXQpO1xyXG4gICAgICAgIGNvbnN0IHJvdyA9IHVwKFwidHJbXCIgKyBrZW5kb1RyZWVsaXN0Um93SW5kZXhBdHRyICsgJ10nKSh0YXJnZXQpO1xyXG4gICAgICAgIGlmIChyb3cgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIltNQ1JdIG5vIHJvdyBpbmRleCBmb3VuZC5cIiwgdGFyZ2V0KTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGlkeCA9IHJvdy5nZXRBdHRyaWJ1dGUoa2VuZG9UcmVlbGlzdFJvd0luZGV4QXR0cik7IC8vbmctcmVmbGVjdC1kYXRhLXJvdy1pbmRleCAoaW5kaWNlIHRvdGFsZSkgLSBkYXRhLXRyZWVsaXN0LXZpZXctaW5kZXggKGluZGljZSBwYWdpbmF0bykgLSBuZy1yZWZsZWN0LWxvZ2ljYWwtcm93LWluZGV4IChpbmRpY2UgbG9naWNvIHRvdGFsZSlcclxuICAgICAgICBjb25zdCB0ZCA9IHVwKFwidGRcIikodGFyZ2V0KTsgLy9rZW5kb3RyZWVsaXN0bG9naWNhbGNlbGxcclxuICAgICAgICBpZiAoKHRhcmdldC50YWdOYW1lID09PSBcIlNQQU5cIiB8fCB0YXJnZXQudGFnTmFtZSA9PT0gXCJESVZcIikgJiYgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImstaWNvblwiKSlcclxuICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQsIHRhcmdldCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOlxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJrLWktY2FyZXQtYWx0LXJpZ2h0XCIpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJrLWktZXhwYW5kXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gXCJLZW5kb1RyZWVsaXN0RXhwYW5kXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBcIktlbmRvVHJlZWxpc3RDb2xsYXBzZVwiLFxyXG4gICAgICAgICAgICAgICAgaWR4LFxyXG4gICAgICAgICAgICAgICAgbnRoOiArdGQuZ2V0QXR0cmlidXRlKGtlbmRvVHJlZWxpc3RDb2xJbmRleEF0dHIpLFxyXG4gICAgICAgICAgICAgICAgZXZlbnRWYWx1ZTogdGQucXVlcnlTZWxlY3RvcihcInNwYW5bZGF0YS10ZXN0XSxkaXZbZGF0YS10ZXN0XVwiKVxyXG4gICAgICAgICAgICAgICAgICAgID8gKHRkLnF1ZXJ5U2VsZWN0b3IoXCJzcGFuW2RhdGEtdGVzdF0sZGl2W2RhdGEtdGVzdF1cIikgYXMgSFRNTEVsZW1lbnQpPy5nZXRBdHRyaWJ1dGUoXCJkYXRhLXRlc3RcIilcclxuICAgICAgICAgICAgICAgICAgICA6IFwiXCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRkLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS10ZXN0XVwiKS5sZW5ndGggPT09IDApXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKGlkLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogXCJLZW5kb1RyZWVsaXN0TmF0aXZlQ2VsbFwiLFxyXG4gICAgICAgICAgICAgICAgbWFpbkNvbXBvbmVudDogZ2V0SWQodGhpcy5pc0NvbXBvbmVudCh0YXJnZXQpKSxcclxuICAgICAgICAgICAgICAgIGlkeCxcclxuICAgICAgICAgICAgICAgIG50aDogK3RkLmdldEF0dHJpYnV0ZShrZW5kb1RyZWVsaXN0Q29sSW5kZXhBdHRyKSxcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciBzZXR0aW5ncyA9IGdldFNldHRpbmdzKHRoaXMuaXNDb21wb25lbnQodGFyZ2V0KSk7XHJcbiAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQsIHRhcmdldCwge1xyXG4gICAgICAgICAgICB0YWc6IHNldHRpbmdzPy5yb3dJbmRleCA/IFwiS2VuZG9UcmVlbGlzdFJvd0luZGV4XCIgOiBcIktlbmRvVHJlZWxpc3RcIixcclxuICAgICAgICAgICAgaWR4LFxyXG4gICAgICAgICAgICBudGg6ICt0ZC5nZXRBdHRyaWJ1dGUoa2VuZG9HcmlkQ29sSW5kZXhBdHRyKSxcclxuICAgICAgICAgICAgbWFpbkNvbXBvbmVudDogZ2V0SWQodGhpcy5pc0NvbXBvbmVudCh0YXJnZXQpKSxcclxuICAgICAgICAgICAgZXZlbnRWYWx1ZTogdGQucXVlcnlTZWxlY3RvcihcInNwYW5bZGF0YS10ZXN0XVwiKVxyXG4gICAgICAgICAgICAgICAgPyAodGQucXVlcnlTZWxlY3RvcihcInNwYW5bZGF0YS10ZXN0XVwiKSBhcyBIVE1MRWxlbWVudCk/LmdldEF0dHJpYnV0ZShcImRhdGEtdGVzdFwiKVxyXG4gICAgICAgICAgICAgICAgOiBcIlwiLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgS2VuZG9HcmlkQ29tcG9uZW50IHtcclxuICAgIHN0YXRpYyBpc0NvbXBvbmVudCh0YXJnZXQ6IEVsZW1lbnQpOiBFbGVtZW50IHtcclxuICAgICAgICByZXR1cm4gdXAoXCJrZW5kby1ncmlkXCIpKHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIGNvbW1hbmQ6IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZCwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KSB7XHJcbiAgICAgICAgbGV0IHZ2ID0gdXA7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJLZW5kb0dyaWRDb21wb25lbnQgY2FwdHVyZVwiKTtcclxuICAgICAgICBpZiAodXAoXCJrZW5kby1ncmlkLXRvb2xiYXJcIikodGFyZ2V0KSkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgdmFyIGFuYyA9IHVwVG9JZCh0YXJnZXQpO1xyXG4gICAgICAgIGNvbnN0IGlkID0gZ2V0SWQoYW5jKTtcclxuICAgICAgICBpZiAoaWQgPT09IGdldElkKHRoaXMuaXNDb21wb25lbnQodGFyZ2V0KSkpIHJldHVybiBudWxsO1xyXG4gICAgICAgIGxldCBpZHggPSB1cCgnWycgKyBrZW5kb0dyaWRSb3dJbmRleEF0dHIgKyAnXScpKHRhcmdldCk/LmdldEF0dHJpYnV0ZShrZW5kb0dyaWRSb3dJbmRleEF0dHIpO1xyXG4gICAgICAgIGxldCBudGggPSArdXAoJ1snICsga2VuZG9HcmlkQ29sSW5kZXhBdHRyICsgJ10nKSh0YXJnZXQpPy5nZXRBdHRyaWJ1dGUoa2VuZG9HcmlkQ29sSW5kZXhBdHRyKTtcclxuXHJcbiAgICAgICAgaWYgKCFpZHgpIC8vIHJpZ2EgdmlydHVhbGUgKHVuYSBzb2xhIHZpc2liaWxlKVxyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChpZCwgdGFyZ2V0LCB7XHJcbiAgICAgICAgICAgICAgICB0YWc6IGBLZW5kb0dyaWRgLFxyXG4gICAgICAgICAgICAgICAgaWR4LC8vcm93IGluZGV4XHJcbiAgICAgICAgICAgICAgICBudGgsLy9jb2wgaW5kZXhcclxuICAgICAgICAgICAgICAgIG1haW5Db21wb25lbnQ6IGdldElkKHRoaXMuaXNDb21wb25lbnQodGFyZ2V0KSksXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImNsaWNrIGtlbmRvIGdyaWRcIixcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICh1cChcImtlbmRvLWdyaWRcIikodGFyZ2V0KSkgLy9ncmlkXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKGlkLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogYEtlbmRvR3JpZFJvd0luZGV4YCxcclxuICAgICAgICAgICAgICAgIGlkeCwvL3JvdyBpbmRleFxyXG4gICAgICAgICAgICAgICAgbnRoLC8vY29sIGluZGV4XHJcbiAgICAgICAgICAgICAgICBtYWluQ29tcG9uZW50OiBnZXRJZCh0aGlzLmlzQ29tcG9uZW50KHRhcmdldCkpLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheTogXCJjbGljayBncmlkIGluZGV4XCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQm9keUVkaXRDb21wb25lbnQge1xyXG4gICAgc3RhdGljIGlzQ29tcG9uZW50KHRhcmdldDogRWxlbWVudCk6IEVsZW1lbnQge1xyXG4gICAgICAgIHJldHVybiB1cChcInRiLWJlXCIpKHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIGNvbW1hbmQ6IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZCwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KSB7XHJcbiAgICAgICAgbGV0IHZ2ID0gdXA7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJCb2R5RWRpdENvbXBvbmVudCBjYXB0dXJlXCIpO1xyXG4gICAgICAgIHZhciBhbmMgPSB1cFRvSWQodGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBpZCA9IGdldElkKGFuYyk7XHJcbiAgICAgICAgbGV0IGlkeCA9IHVwKCdbJyArIGtlbmRvR3JpZFJvd0luZGV4QXR0ciArICddJykodGFyZ2V0KT8uZ2V0QXR0cmlidXRlKGtlbmRvR3JpZFJvd0luZGV4QXR0cik7XHJcbiAgICAgICAgbGV0IG50aCA9ICt1cCgnWycgKyBrZW5kb0dyaWRDb2xJbmRleEF0dHIgKyAnXScpKHRhcmdldCk/LmdldEF0dHJpYnV0ZShrZW5kb0dyaWRDb2xJbmRleEF0dHIpO1xyXG5cclxuICAgICAgICBpZiAoaWQgPT0gZ2V0SWQodGhpcy5pc0NvbXBvbmVudCh0YXJnZXQpKSAmJiAoIWlkeCB8fCB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiay1ncmlkLWNvbnRlbnRcIikpKVxyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChcIltkYXRhLXRlc3Q9J2JvZHlFZGl0UGFnZXJOdW1iZXJEaXNtaXNzRm9jdXMnXVwiLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogXCJCb2R5RWRpdFwiLFxyXG4gICAgICAgICAgICAgICAgbWFpbkNvbXBvbmVudDogZ2V0SWQodGhpcy5pc0NvbXBvbmVudCh0YXJnZXQpKVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKGlkICYmICFpZHggJiYgdGFyZ2V0LmNsb3Nlc3QoXCJrZW5kby1ncmlkIHRoZWFkIHRyID4gdGhcIikpXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKGlkLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogYEJvZHlFZGl0YCxcclxuICAgICAgICAgICAgICAgIG1haW5Db21wb25lbnQ6IGdldElkKHRoaXMuaXNDb21wb25lbnQodGFyZ2V0KSksXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImNsaWNrIGJvZHkgZWRpdCBoZWFkZXJcIixcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChpZCAmJiAhaWR4ICYmIHRhcmdldC5jbG9zZXN0KFwidGItZXZcIikpXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKGlkLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogYEJFZGl0Vmlld2AsXHJcbiAgICAgICAgICAgICAgICBtYWluQ29tcG9uZW50OiBnZXRJZCh0aGlzLmlzQ29tcG9uZW50KHRhcmdldCkpLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheTogXCJib2R5IGVkaXQgdmlld1wiLFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJkdW1teVJvd1wiKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChpZCwgdGFyZ2V0LCB7XHJcbiAgICAgICAgICAgICAgICB0YWc6IGBCb2R5RWRpdER1bW15Um93YCxcclxuICAgICAgICAgICAgICAgIG1haW5Db21wb25lbnQ6IGdldElkKHRoaXMuaXNDb21wb25lbnQodGFyZ2V0KSksXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImFkZCByb3dcIixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodXAoXCJrZW5kby1ncmlkXCIpKHRhcmdldCkpIC8vZ3JpZFxyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChpZCwgdGFyZ2V0LCB7XHJcbiAgICAgICAgICAgICAgICB0YWc6IGBCb2R5RWRpdFJvd2AsXHJcbiAgICAgICAgICAgICAgICBpZHgsLy9yb3cgaW5kZXhcclxuICAgICAgICAgICAgICAgIG50aCwvL2NvbCBpbmRleFxyXG4gICAgICAgICAgICAgICAgbWFpbkNvbXBvbmVudDogZ2V0SWQodGhpcy5pc0NvbXBvbmVudCh0YXJnZXQpKSxcclxuICAgICAgICAgICAgICAgIGRpc3BsYXk6IFwiY2xpY2sgYm9keSBncmlkXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIGVsc2UgLy90b29sYmFyXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKGlkLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogYEJvZHlFZGl0YCxcclxuICAgICAgICAgICAgICAgIG1haW5Db21wb25lbnQ6IGdldElkKHRoaXMuaXNDb21wb25lbnQodGFyZ2V0KSksXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImNsaWNrIGJvZHkgZWRpdFwiLFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBXaW5kb3dDb21wb25lbnQge1xyXG4gICAgc3RhdGljIGlzQ29tcG9uZW50KHRhcmdldDogRWxlbWVudCk6IEVsZW1lbnQge1xyXG4gICAgICAgIHJldHVybiB1cChcImtlbmRvLXdpbmRvd1wiKSh0YXJnZXQpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGNhcHR1cmUodGFyZ2V0OiBFbGVtZW50LCBjb21tYW5kOiAoc2VsZWN0b3I6IHN0cmluZywgdGFyZ2V0PzogRWxlbWVudCwgb3B0aW9ucz86IE9wdGlvbnMpID0+IENvbW1hbmQsIHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiV2luZG93Q29tcG9uZW50IGNhcHR1cmVcIik7XHJcbiAgICAgICAgY29uc3QgZWwgPSB1cFRvSWQodGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBpZCA9IGdldElkKGVsKTtcclxuXHJcbiAgICAgICAgaWYgKHRhcmdldC50YWdOYW1lID09IFwiU1BBTlwiICYmIHRhcmdldC5wYXJlbnRFbGVtZW50Py5oYXNBdHRyaWJ1dGUoXCJrZW5kb3dpbmRvd2Nsb3NlYWN0aW9uXCIpIHx8XHJcbiAgICAgICAgICAgIHRhcmdldC50YWdOYW1lID09IFwiQlVUVE9OXCIgJiYgdGFyZ2V0Lmhhc0F0dHJpYnV0ZShcImtlbmRvd2luZG93Y2xvc2VhY3Rpb25cIikpXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKFwiS2VuZG8tV2luZG93XCIsIHRhcmdldCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOiBcIldpbmRvd0Nsb3NlXCIsXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImNsb3NlIHdpbmRvd1wiLFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQsIHRhcmdldCwgeyB0YWc6IFwiV2luZG93XCIvKiwgc2NvcGU6ICdBbGwnKi8gfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBEaWFsb2dDb21wb25lbnQge1xyXG4gICAgc3RhdGljIGlzQ29tcG9uZW50KHRhcmdldDogRWxlbWVudCk6IEVsZW1lbnQge1xyXG4gICAgICAgIHJldHVybiB1cChcImtlbmRvLWRpYWxvZ1wiKSh0YXJnZXQpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGNhcHR1cmUodGFyZ2V0OiBFbGVtZW50LCBjb21tYW5kOiAoc2VsZWN0b3I6IHN0cmluZywgdGFyZ2V0PzogRWxlbWVudCwgb3B0aW9ucz86IE9wdGlvbnMpID0+IENvbW1hbmQsIHBhcnNlZEV2ZW50OiBQYXJzZWRFdmVudCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRGlhbG9nQ29tcG9uZW50IGNhcHR1cmVcIik7XHJcbiAgICAgICAgY29uc3QgZWwgPSB1cFRvSWQodGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBpZCA9IGdldElkKGVsKTtcclxuXHJcbiAgICAgICAgaWYgKHVwKCdrZW5kby1kaWFsb2ctYWN0aW9ucycpKHRhcmdldCkpIHtcclxuICAgICAgICAgICAgaWYgKHRhcmdldC5jbG9zZXN0KCdtYy1zY2hlZHVsZXItYXBwJykpLy9wZXIgbGEgZGlhbG9nIG5hdGl2YSBkZWxsbyBzY2hlZHVsZXIgY2hlIG5vbiBzZW1icmEgcGVyc29uYWxpenphYmlsZVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmQoJ3RleHQ9JyArICh0YXJnZXQuY2xvc2VzdCgnYnV0dG9uJykucXVlcnlTZWxlY3RvcignLmstYnV0dG9uLXRleHQnKSBhcyBIVE1MRWxlbWVudCkuaW5uZXJUZXh0LCB0YXJnZXQuY2xvc2VzdCgnYnV0dG9uJyksIHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwiRGlhbG9nQWN0aW9uc1NjaGVkdWxlclwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IFwiZGlhbG9nIGFjdGlvbnNcIixcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQgPyBpZCA6IFwia2VuZG8tZGlhbG9nXCIsIHRhcmdldCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOiBcIkRpYWxvZ0FjdGlvbnNcIixcclxuICAgICAgICAgICAgICAgIGRpc3BsYXk6IFwiZGlhbG9nIGFjdGlvbnNcIixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZWwgJiYgdXAoJ2tlbmRvLWRpYWxvZy10aXRsZWJhcicpKHRhcmdldCkgJiZcclxuICAgICAgICAgICAgKHRhcmdldC50YWdOYW1lID09IFwiU1BBTlwiICYmIHRhcmdldC5wYXJlbnRFbGVtZW50Py5oYXNBdHRyaWJ1dGUoXCJ0aXRsZVwiKSAmJiB0YXJnZXQucGFyZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIpID09IFwiQ2xvc2VcIikgfHxcclxuICAgICAgICAgICAgKHRhcmdldC50YWdOYW1lID09IFwiQlVUVE9OXCIgJiYgdGFyZ2V0Lmhhc0F0dHJpYnV0ZShcInRpdGxlXCIpICYmIHRhcmdldC5nZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIpID09IFwiQ2xvc2VcIikpXHJcbiAgICAgICAgICAgIHJldHVybiBjb21tYW5kKFwiS2VuZG8tRGlhbG9nXCIsIHRhcmdldCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOiBcIkRpYWxvZ0Nsb3NlXCIsXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcImNsb3NlIGRpYWxvZ1wiLFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCFpZCkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgcmV0dXJuIGNvbW1hbmQoaWQsIHRhcmdldCwgeyB0YWc6IFwiRGlhbG9nXCIvKiwgc2NvcGU6ICdBbGwnKi8gfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBEb2NrZXJDb21wb25lbnQge1xyXG4gICAgc3RhdGljIGlzQ29tcG9uZW50KHRhcmdldDogRWxlbWVudCk6IEVsZW1lbnQge1xyXG4gICAgICAgIHJldHVybiB1cChcInRiLWRvY2twYW5lLWNvbnRhaW5lclwiKSh0YXJnZXQpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGlzRGVzaWduU3RhdGUodGFyZ2V0OiBFbGVtZW50KTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuICEhdXAoXCJ0Yi1kb2NrcGFuZS1jb250YWluZXIudGItZGVzaWduLXN0YXRlXCIpKHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIGNvbW1hbmQ6IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZCwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJEb2NrZXJDb21wb25lbnQgY2FwdHVyZVwiKTtcclxuICAgICAgICAvL2NvbnN0IHdyYXAgPSB7IHVwLCB1cFRvSWQsIHVwVG9DdHJsV2l0aElkLCBnZXRJZCB9O1xyXG4gICAgICAgIHZhciB0YWJiZXJTZWxlY3RvclRhcmdldCA9IHVwKFwiLmRvY2twYW5lLXRhYmJlci1zZWxlY3RvclwiKSh0YXJnZXQpO1xyXG4gICAgICAgIGlmICh0YWJiZXJTZWxlY3RvclRhcmdldCA9PSBudWxsKSB7IC8vY2xpY2sgbmVsIGNvbnRlbnV0byBkZWwgZG9ja3BhbmVcclxuICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9IHVwKFwidGItZG9ja3BhbmUtY29udGFpbmVyXCIpKHRhcmdldCk7XHJcbiAgICAgICAgICAgIHZhciB0YWJiZXJTZWxlY3RvciA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmRvY2twYW5lLXRhYmJlci1zZWxlY3RvciB1bCBsaS5hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkID0gZ2V0SWQodGFiYmVyU2VsZWN0b3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChpZCwgdGFiYmVyU2VsZWN0b3IsIHsgdGFnOiBcIkRvY2tQYW5lXCIsIC8qZGlzcGxheTogaWNvbiovIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBLZW5kb1VwbG9hZENvbXBvbmVudCB7XHJcbiAgICBzdGF0aWMgaXNDb21wb25lbnQodGFyZ2V0OiBFbGVtZW50KTogRWxlbWVudCB7XHJcbiAgICAgICAgcmV0dXJuIHVwKFwia2VuZG8tdXBsb2FkXCIpKHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIGNvbW1hbmQ6IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZCwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJLZW5kb1VwbG9hZENvbXBvbmVudCBjYXB0dXJlXCIpO1xyXG4gICAgICAgIGlmICh0YXJnZXQudGFnTmFtZSA9PSBcIklOUFVUXCIgJiYgdGFyZ2V0LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiay11cGxvYWQtYnV0dG9uXCIpKVxyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChcImtlbmRvLXVwbG9hZCBkaXYuay11cGxvYWQtYnV0dG9uIGlucHV0XCIsIHRhcmdldCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOiBcIktlbmRvVXBsb2FkXCIsXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcInNlbGVjdCBmaWxlXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0YXJnZXQudGFnTmFtZSA9PSBcIkJVVFRPTlwiICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJrLXVwbG9hZC1zZWxlY3RlZFwiKSlcclxuICAgICAgICAgICAgcmV0dXJuIGNvbW1hbmQoXCJrZW5kby11cGxvYWQtYWN0aW9uLWJ1dHRvbnMgYnV0dG9uLmstdXBsb2FkLXNlbGVjdGVkXCIsIHRhcmdldCwge1xyXG4gICAgICAgICAgICAgICAgdGFnOiBcIktlbmRvVXBsb2FkXCIsXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBcInVwbG9hZCBmaWxlXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0YXJnZXQudGFnTmFtZSA9PSBcIkJVVFRPTlwiICYmIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJrLWNsZWFyLXNlbGVjdGVkXCIpKVxyXG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZChcImtlbmRvLXVwbG9hZC1hY3Rpb24tYnV0dG9ucyBidXR0b24uay1jbGVhci1zZWxlY3RlZFwiLCB0YXJnZXQsIHtcclxuICAgICAgICAgICAgICAgIHRhZzogXCJLZW5kb1VwbG9hZFwiLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheTogXCJjbGVhciBmaWxlIHNlbGVjdGVkXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgUmFkYXJDb21wb25lbnQge1xyXG4gICAgc3RhdGljIGlzQ29tcG9uZW50KHRhcmdldDogRWxlbWVudCk6IEVsZW1lbnQge1xyXG4gICAgICAgIHJldHVybiB1cChcInRiLXJhZGFyLWN1c3RvbWlzYWJsZS1ncmlkXCIpKHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgY2FwdHVyZSh0YXJnZXQ6IEVsZW1lbnQsIGNvbW1hbmQ6IChzZWxlY3Rvcjogc3RyaW5nLCB0YXJnZXQ/OiBFbGVtZW50LCBvcHRpb25zPzogT3B0aW9ucykgPT4gQ29tbWFuZCwgcGFyc2VkRXZlbnQ6IFBhcnNlZEV2ZW50KTogYW55IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlJhZGFyQ29tcG9uZW50IGNhcHR1cmVcIik7XHJcbiAgICAgICAgbGV0IHZ2ID0gdXA7XHJcbiAgICAgICAgY29uc3Qgb3duZXJEb2MgPSB1cCgoZWwpID0+IGVsLnRhZ05hbWUuc3RhcnRzV2l0aChcIlRCLUlERFwiKSkodGFyZ2V0KTtcclxuICAgICAgICBjb25zdCByb3cgPSB1cChcInRyW1wiICsga2VuZG9HcmlkUm93SW5kZXhBdHRyICsgXCJdXCIpKHRhcmdldCk7XHJcbiAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiW01DUl0gbm8gcm93IGluZGV4IGZvdW5kLlwiLCB0YXJnZXQpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgaWR4ID0gcm93LmdldEF0dHJpYnV0ZShrZW5kb0dyaWRSb3dJbmRleEF0dHIpO1xyXG4gICAgICAgIGNvbnN0IGVsID0gdXBUb0lkKHRhcmdldCk7XHJcbiAgICAgICAgY29uc3QgaWQgPSBnZXRJZChlbCk7XHJcbiAgICAgICAgY29uc3QgaXNXZWJTdHlsZSA9IHVwKCdrZW5kby1ncmlkJykodGFyZ2V0KT8uY2xhc3NMaXN0Py5jb250YWlucygnbW9kZTEnKTtcclxuICAgICAgICByZXR1cm4gY29tbWFuZChpZCwgdGFyZ2V0LCB7XHJcbiAgICAgICAgICAgIHRhZzogaXNXZWJTdHlsZSA/IFwiVGJSYWRhcldlYlN0eWxlXCIgOiBcIlRiUmFkYXJUYWJsZVN0eWxlXCIsXHJcbiAgICAgICAgICAgIHBhcmVudDogb3duZXJEb2M/LnRhZ05hbWUsXHJcbiAgICAgICAgICAgIGlkeCxcclxuICAgICAgICAgICAgZGlzcGxheTogXCJyYWRhcjogY2xpY2sgcm93IFwiICsgaWR4XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbXSwidmVyc2lvbiI6MywiZmlsZSI6ImludGVyY2VwdG9yLmpzLm1hcCJ9
